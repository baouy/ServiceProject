<script>
    var assinstant_list_stateid = [19,21,22,23,24];
    $('#assistant_distribution_table').datagrid({
        local: 'remote',
        dataUrl: '/v1/user/sale_distribution?statelist='+assinstant_list_stateid ,
        dataType: 'json',
        sortAll: false,
        loadType: 'get',
        filterAll: true,
        height:'95%',
        columns:
            [
                {name: 'flower_name', width: '150', label: '员工姓名'},
                {name: 'maxnum', width: '100', label: '当前客户数'},
                {name: 'depname', width: '100', label: '部门'},
            ],
        paging: {pageSize: 50, selectPageSize: '50,100,200', pageCurrent: 1},
        hiddenFields: ['id','depid','depcode'],
        columnMenu: true,
        columnShowhide: true,
        columnFilter: true,
        columnLock: false,
        dblOnClick: 'assistant_distribution_table_onclick',
    });


    function assistant_distribution_table_onclick() {
        var selected = $("#assistant_distribution_table").data('selectedDatas');
        if (null == selected || selected.length == 0) {
            $(this).alertmsg('warn', '请在列表中选择要操作的对象。');
        } else {

            $.ajax({
                url: '/v1/newcustomer/distribution',
                dataType: 'json',
                type: 'POST',
                data:{
                    gid:ass_c_ids,
                    custsalesid:selected[0].id,
                    custsales:selected[0].flower_name,
                    custsalesdepname:selected[0].depname,
                    custsalescode:selected[0].depcode,
                    stateid:21,
                    state:'已分配'
                },
                xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
                success: function (d) {
                    if (d.state == 200) {
                        $(this).alertmsg('ok', '操作成功');
                        BJUI.dialog('closeCurrent', this);
                        assistant_tab_refresh();
                        //assistant_follows_refresh();
                    }else{
                        $(this).alertmsg('warn', '操作失败');
                    }
                }
            });
        }
    }

</script>
<div class="bjui-pageContent">
	<button type="button" class="btn btn-blue" data-icon="plus" onclick="assistant_distribution_table_onclick()"><i
			class="fa fa-plus"></i>选择
	</button>
	<button type="button" class="btn-close btn" data-icon="close"><i class="fa fa-close"></i> 关闭</button>
	<table id="assistant_distribution_table" class="table table-hover" data-width="100%"></table>
</div>