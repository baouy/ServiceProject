	<script type="text/javascript">

		$('#customer_netsale_list_tabel').datagrid({
			local: 'remote',
			dataUrl: '/v1/customer/customer_netsales',
			dataType: 'json',
			sortAll: false,
			loadType: 'get',
			filterAll: true,
			height:'95%',
			columns: [{name: 'custname', width: '80', label: '姓名'},
				{name: 'phone', width: '90', label: '电话'},
				{name: 'createtime', width: '150', label: '创建时间'},
				{name: 'semsources', width: '100', label: 'SEM来源'},
				{name: 'semkeys', width: '100', label: 'SEM关键词'},
				{name: 'source', width: '90', label: '来源'},
				{name: 'type', width: '90', label: '活动类型'},
				{name: 'activname', width: '100', label: '编号'},
				{name: 'activnewname', width: '60', label: '活动名称'},
				{name: 'area', width: '60', label: '面积'},
				{name: 'cityname', width: '60', label: '城市'},
				{name: 'village', width: '80', label: '小区名称'},
				{name: 'state', width: '80', label: '状态'},
				{name: 'mobilesales', width: '80', label: '美客员'},
				{name: 'orgname', width: '80', label: '组织'},
				{name: 'status', type: 'select', items: [{'1': '网站'}, {'2': '活动'}], width: '80', label: '筛选'},
			],
			paging: {pageSize: 50, selectPageSize: '50,100,200', pageCurrent: 1},
			columnMenu: true,
			columnShowhide: true,
			columnFilter: true,
			columnLock: false,
			fullGrid: false
		});

		function show_download_alert() {
			$(this).alertmsg('confirm', '确定导出吗?', {okCall: 'sales_download'});
		}

		function sales_download(){
			var custname = $("input[name='custname']").val();
			var phone = $("input[name='phone']").val();
			var createtime = $("input[name='createtime']").val();
			var activname = $("input[name='activname']").val();
			var type = $("input[name='type']").val();
			var village = $("input[name='village']").val();
			var cityname = $("input[name='cityname']").val();
			var area = $("input[name='area']").val();

			var semsources = $("input[name='semsources']").val();
			var semkeys = $("input[name='semkeys']").val();
			var source = $("input[name='source']").val();
			var state = $("input[name='state']").val();
			var mobilesales = $("input[name='mobilesales']").val();
			var orgname = $("input[name='orgname']").val();

			console.log(custname);
			var url="/v1/customer/customer_netsales_excel?pageCurrent=1&pageSize=3000";

			if(custname.length > 0){
				url+="&custname="+custname;
			}
			if(phone.length > 0){
				url+="&phone="+phone;
			}
			if(createtime.length > 0){
				url+="&createtime="+createtime;
			}
			if(activname.length > 0){
				url+="&activname="+activname;
			}
			if(type.length > 0){
				url+="&type="+type;
			}
			if(village.length > 0){
				url+="&village="+village;
			}
			if(cityname.length > 0){
				url+="&cityname="+cityname;
			}
			if(area.length > 0){
				url+="&area="+area;
			}
			if(semsources.length > 0){
				url+="&semsources="+semsources;
			}
			if(semkeys.length > 0){
				url+="&semkeys="+semkeys;
			}
			if(source.length > 0){
				url+="&source="+source;
			}
			if(state.length > 0){
				url+="&state="+state;
			}
			if(mobilesales.length > 0){
				url+="&mobilesales="+mobilesales;
			}
			if(orgname.length > 0){
				url+="&orgname="+orgname;
			}

			window.open(url);
		}


		function import_netsale_Excel(){
			if (!netsale_checkData()){
				$("#up_netsale_file").val("");
				return;
			}
			$.ajax({
				url: '/v1/customer/customer_netsales_post_excel',
				type: 'POST',
				cache: false,
				data: new FormData($('#netsale_form1')[0]),
				processData: false,
				contentType: false
			}).done(function(res) {
				if (res.state == 200){
					$(this).alertmsg('ok', '导入成功');
					$('#customer_netsale_list_tabel').datagrid('refresh');
				}else{
					var content = '';
					for (var i = 0; i < res.data.length ; i++){
						content +=res.data[i]+"<br>";
					}

					$(this).alertmsg('info',content,{autoClose:false,title:'数据有未填值'});
				}
				$("#up_netsale_file").val("");
			}).fail(function(res) {
				$("#up_netsale_file").val("");
				$(this).alertmsg('error', '导入失败,请重新导入');
			});
		}

		function netsale_checkData(){
			var fileDir = $("#up_netsale_file").val();
			if(fileDir.length == 0){
				return false;
			}
			var suffix = fileDir.substr(fileDir.lastIndexOf("."));
			if("" == fileDir){
				$(this).alertmsg('info', '选择EXCEL格式的文件导入');
				return false;
			}
			if(".xls" != suffix && ".xlsx" != suffix ){
//				alert("选择Excel格式的文件导入！");
				$(this).alertmsg('info', '选择EXCEL格式的文件导入');
				return false;
			}
			return true;
		}

	</script>
<div class="bjui-pageContent" id="customer_netsale_all">
	<div style="margin:0px 0px 10px 0px;">
		<button type="button" class="btn btn-green" data-icon="sign-out" onclick="show_download_alert()"><i class="fa fa-sign-out"></i> 导出</button>
		<form id="netsale_form1" action="/v1/customer/customer_netsales_post_excel" method="post"  enctype="multipart/form-data" class="fa">
			<input type="file" name="file" id="up_netsale_file" style="visibility: hidden; position: absolute;" onchange="import_netsale_Excel()">
			<button type="button" class="btn btn-blue" data-icon="sign-in" onclick="up_netsale_file.click()"><i class="fa fa-sign-in"></i> 导入</button>
		</form>
	</div>
	<table id="customer_netsale_list_tabel" class="table table-hover" data-width="100%"></table>
</div>