<html>
<head>
    <script type="text/javascript">
        $('#design').datagrid({
            local: 'remote',
            dataUrl: '/v1/user/saleslist?type=2',
            dataType: 'json',
            sortAll: false,
            loadType: 'get',
            filterAll: true,
			height:'95%',
            columns: [
                {name: 'userlevel', width: '150', label: '等级'},
                {name: 'login_name', width: '150', label: '编码'},
                {name: 'flower_name', width: '150', label: '花名'},
                {name: 'username', width: '150', label: '姓名'},
                {name: 'follownum', width: '150', label: '在跟进数'},
                {name: 'orgname', width: '150', label: '部门'},
                {name: 'depname', width: '150', label: '组织'},
                {name: 'depcode', width: '150', label: '组织id',hide: true},
                {name: 'id', width: '80', label: '主键', hide: true}],
            paging: {pageSize: 50, selectPageSize: '50,100,200', pageCurrent: 1},
//            ,
            columnMenu: true,
            columnShowhide: true,
            columnFilter: true,
            columnLock: false,
            fullGrid: false,

        });
        //转销售
        function intelephonesales(){
            var id = $("#customer_datagrid1 .datagrid-selected-tr>td:last-child").text(); //客户id
            var selected_customer_id = $("#design .datagrid-selected-tr>td:last-child").text(); //转电销列表中选中记录的id
            var flower_name =  $("#design .datagrid-selected-tr>td:eq(3)").text();//花名
            var depcode = $("#design .datagrid-selected-tr>td").last().prev().text();//部门id

            $.ajax({
                url: '/v1/customer/customer_indesign',
                dataType: 'json',
                type: 'POST',
                data:{
                    id:selected_customer_id,
                    flower_name:flower_name,
                    ids:id,
                    depcode:depcode
                },
                xhrFields: {
                    withCredentials: true
                },
                crossDomain: true,
                success: function (d) {
                    BJUI.dialog('closeCurrent',this);
                    $("#customer_state").val("已转设计");
                    $("#customer_mobilesales").val(flower_name);
                    $('#design').datagrid('refresh');
                    $('#customer_datagrid1').datagrid('refresh');
                }
            });
        }
    </script>
</head>
<body>
<div class="bjui-pageContent">
    <form>
        <button type="button" class="btn btn-blue" data-icon="plus" onclick="intelephonesales()"><i class="fa fa-plus"></i>选择</button>
        <button type="button" class="btn-close btn" data-icon="close"><i class="fa fa-close"></i> 关闭</button>
        <table id="design" class="table table-hover" data-width="100%" data-selected-multi="true">

        </table>
    </form>
</div>
</body>
</html>