<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <script type="text/javascript">
        var groupid, starttime,id,tcid,thisstate;

        //待审图列表
        $('#picture_reviewed_list').datagrid({

            height: '95%',
            dataUrl: '/v1/reviewdpicture/list?state=0',
            dataType: 'json',
            loadType: 'get',
            sortAll: false,
            filterAll: true,
            height: '95%',
            columns: [
                {name: 'cusname', width: '90', label: '姓名'},
                {name: 'realstatedate', width: '120', label: '开工时间'},
                {name: 'createtime', width: '80', label: '上传时间'},
                {name: 'jobcontent', width: '80', label: '施工阶段'},
                {
                    name: 'state',
                    width: '80',
                    items: [{'0': '待审核'}, {'1': '审核通过'}, {'2': '审核未通过'},{'3': '已发布'},{'4': '已下架'}],
                    label: '当前状态'
                },
                {name: 'signtype', width: '80', label: '备注'},
                {name: 'groupid', width: '80', label: '群id', hide: true},
                {name: 'tcid', width: '80', label: '合同id', hide: true},

                {name: 'id', width: '80', label: '主键', hide: true}],
            paging: {
                pageSize: 20,
                selectPageSize: '50,80',
                pageCurrent: 1
            },
            columnMenu: true,
            columnShowhide: true,
            columnFilter: true,
            columnLock: false,
            fullGrid: false,
            dblOnClick: 'edit',
        });

        //已审核全部列表
        $('#picture_reviewed_list2').datagrid({

            height: '95%',
            dataUrl: '/v1/reviewdpicture/list',
            dataType: 'json',
            loadType: 'get',
            sortAll: false,
            filterAll: true,
            height: '95%',
            columns: [
                {name: 'cusname', width: '90', label: '姓名'},
                {name: 'realstatedate', width: '120', label: '开工时间'},
                {name: 'createtime', width: '80', label: '上传时间'},
                {name: 'jobcontent', width: '80', label: '施工阶段'},
//                {
//                    name: 'state',
//                    width: '80',
//                    items: [{'0': '待审核'}, {'1': '审核通过'}, {'2': '审核未通过'},{'3': '已发布'},{'4': '已下架'}],
//                    label: '当前状态'
//                },
                {
                    name: 'state',
                    type: 'select',
                    items: [{'1': '审核通过'}, {'3': '已发布'}, {'4': '已下架'}],
                    width: '80',
                    label: '当前状态'
                },
                {name: 'signtype', width: '80', label: '备注'},
                {name: 'groupid', width: '80', label: '群id', hide: true},
                {name: 'tcid', width: '80', label: '合同id', hide: true},
                {name: 'id', width: '80', label: '主键', hide: true}],
            paging: {
                pageSize: 20,
                selectPageSize: '50,80',
                pageCurrent: 1
            },
            columnMenu: true,
            columnShowhide: true,
            columnFilter: true,
            columnLock: false,
            fullGrid: false,
            dblOnClick: 'edit2',
        });

        function edit() {
            var selected = $("#picture_reviewed_list").data('selectedDatas');
            if (selected.length == 0) {
                $(this).alertmsg('error', '请在列表中选择要操作的对象。');
            } else {
                groupid = selected[0].groupid;
                starttime = selected[0].createtime;
                id = selected[0].id;
                tcid=selected[0].tcid;
                $(this).dialog({
                    id: "purchase_request_save",
                    title: "审核编辑",
                    url: "SystemManagement/engineering_checkdraw_table.html",
                    width: 1200,
                    height: 600,
                    mask: true
                });
            }
        }

        function edit2() {
//            var selected = $("#purchase_request_list").find('tr.datagrid-selected-tr');
            var selected = $("#picture_reviewed_list2").data('selectedDatas');
            $("#picture_reviewed_list").find('tr.datagrid-selected-tr').next()

            if (selected.length == 0) {
                $(this).alertmsg('error', '请在列表中选择要操作的对象。');
            } else {
                groupid = selected[0].groupid;
                starttime = selected[0].createtime;
                id = selected[0].id;
                tcid=selected[0].tcid;
                thisstate =selected[0].state
//               var id = selected[0].id;
//                console.log(selected[0])
                $(this).dialog({
                    id: "purchase_request_save",
                    title: "审核编辑",
                    url: "SystemManagement/engineering_checkdraw_table2.html",
                    width: 1200,
                    height: 600,
                    mask: true
                });
            }
        }
        function changeValue(num) {

            setTimeout(function () {
                if (num == 0) {
                    $('#picture_reviewed_list').datagrid('refresh');
                } else if (num == 1) {
                    $('#picture_reviewed_list2').datagrid('refresh');
                }
            }, 300);
        }


    </script>
<body>
<div class="bjui-pageContent">
    <ul class="nav nav-tabs" role="tablist" id="picture_reviewed">
        <li class="active">
            <a style="font-size: 13px" href="#picture_reviewed_wait" role="tab" data-toggle="tab"
               onclick="changeValue(0)">待审核</a>
        </li>
        <li>
            <a style="font-size: 13px" href="#picture_reviewed_all" role="tab" data-toggle="tab"
               onclick="changeValue(1)">全部</a>
        </li>

    </ul>

    <div class="tab-content" style="height: 95%">
        <div class="tab-pane fade active in" id="picture_reviewed_wait" style="height: 100%;">
            <div style="margin-bottom:10px;">
                <!--<button type="button" class="btn btn-blue" data-icon="plus" data-url="CustomerManagement/customer_new.html" data-width="1800" data-height="900" data-toggle="dialog" data-id="customer_sale_add" data-mask="true"><i class="fa fa-plus"></i>新增</button>-->

                <!--<button type="button" class="btn btn-green" data-icon="edit" onclick="customer_sales_edit('customer_sales_edit','customer_sales')"><i class="fa fa-edit"></i>跟进</button>-->

                <!--<button type="button" class="btn btn-green" data-icon="user" onclick="change_three_type_value('change_customer_sales','customer_sales','customer_to_electric.html','转美聊')">转美销</button>-->

                <!--<button type="button" class="btn btn-green" data-icon="user" onclick="change_three_type_value('change_picture_reviewed_list2','customer_sales','customer_to_sale.html','转销售')">转销售</button>-->

                <!--<button type="button" class="btn btn-green" data-icon="user" onclick="change_three_type_value('change_customer_sales_2','customer_sales','customer_to_design.html','转设计')">转设计</button>-->

            </div>
            <table id="picture_reviewed_list" class="table table-hover" style="height: 100%;"></table>
        </div>

        <div class="tab-pane fade" id="picture_reviewed_all" style="height: 100%;">
            <table id="picture_reviewed_list2" class="table table-hover" style="height: 100%;"></table>
        </div>


    </div>
</div>
</body>
</html>