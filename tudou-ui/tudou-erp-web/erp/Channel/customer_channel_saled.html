<script type="text/javascript">
	$('#customer_channel_sales').datagrid({
		local: 'remote',
		dataUrl: '/v1/customer/customer_channel_list?saletype=1&followstatus=1',
		dataType: 'json',
		sortAll: false,
		loadType: 'get',
		filterAll: true,
		height: '95%',
		columns: [

			{name: 'cusname', width: '70', label: '姓名'},
			{name: 'mobile', width: '70', label: '电话'},
			{name: 'wechatnum', width: '70', label: '微信号'},
			{name: 'districtname', width: '70', label: '城区'},
			{name: 'community', width: '70', label: '小区'},
			{name: 'area', width: '70', label: '面积'},
			{
				name: 'roomstatus',
				width: '70',
				label: '交房状态',
				type: 'select',
				items: [{'现房': '现房'}, {'期房': '期房'}, {'待购': '待购'}, {'': ''}]
			},
			{
				name: 'decorationdate',
				width: '70',
				label: '计划装修时间',
				type: 'date',
				pattern: 'yyyy-MM-dd',
				attrs: {'readonly': "true"}
			},
			{
				name: 'marketactive',
				width: '70',
				label: '营销活动',
				type: 'select',
				items: intentiontype
			},
			{name: 'concerns', width: '70', label: '关注点'},
			{
				name: 'intentiontype', width: '70', label: '意向类型', type: 'select',
				items: type_28

			},
			{name: 'age', width: '70', label: '年龄'},
			{
				name: 'followstate', width: '70', label: '跟进状态', type: 'select',
				items: followstate
			},
			{
				name: 'followtype', width: '70', label: '跟进类型', type: 'select',
				items: followstate
			},
			{name: 'followstateid', width: '70', label: '跟进状态ID', hide: true},
			{
				name: 'followdate',
				width: '70',
				label: '跟进日期',
				type: 'date',
				pattern: 'yyyy-MM-dd',
				attrs: {'readonly': "true"}
			},

			{name: 'followdetails', width: '70', label: '跟进内容'},
			{
				name: 'appdate',
				width: '70',
				label: '预约日期',
				type: 'date',
				pattern: 'yyyy-MM-dd',
				attrs: {'readonly': "true"}
			},
			{name: 'apptime', width: '70', label: '预约时间段'},
			{
				name: 'todate', width: '70', label: '实际到场日期', type: 'date',
				pattern: 'yyyy-MM-dd',
				attrs: {'readonly': "true"}
			},
			{name: 'adults', width: '70', label: '成年人数'},
			{name: 'oldman', width: '70', label: '父母'},
			{name: 'child', width: '70', label: '小孩'},
			{name: 'createuser', width: '70', label: '跟进人', attrs: {'readonly': "true"}},
			{name: 'createtime', width: '70', label: '报名日期', attrs: {'readonly': "true"}},
			{name: 'type', width: '70', label: '来源', type: 'select', items: type_10},
			{name: 'activnewname', width: '70', label: '二级来源'},
			{name: 'activname', width: '70', label: '三级来源'},
			{name: 'mobilesales', width: '70', label: '邀约人', attrs: {'readonly': "true"}},
			{name: 'orgName', width: '70', label: '销售部门', attrs: {'readonly': "true"}},
			{name: 'custsales', width: '70', label: '客户经理', attrs: {'readonly': "true"}},
			{name: 'readiness', width: '70', label: '预沟通情况'},
			{name: 'sffd', width: '70', label: '是否付定', attrs: {'readonly': "true"}},
			{name: 'fdrq', width: '70', label: '付定日期', attrs: {'readonly': "true"}},
			{name: 'htzt', width: '70', label: '合同状态', attrs: {'readonly': "true"}},
			{name: 'htje', width: '70', label: '合同金额', attrs: {'readonly': "true"}},
			{name: 'htrq', width: '70', label: '合同日期', attrs: {'readonly': "true"}},
			{name: 'id', width: '70', label: '客户id', hide: true},
			{name: 'saletype', width: '70', label: '单据类型', hide: true}
			//{name: 'username', width: '95', label: '花名', type:'lookup',attrs: {'data-url':'CustomerManagement/customer_assign_personnel.html','data-width':1000,'data-title':"人员选择"}},
		],
		paging: {pageSize: 50, selectPageSize: '50,100,200', pageCurrent: 1},
		hiddenFields: ['userid', 'id', 'depcode'],
		columnMenu: true,
		columnShowhide: true,
		columnFilter: true,
		columnLock: false,
		inlineEditMult: false,
		fullGrid: false,
		showToolbar: true,
		toolbarItem: 'save,cancel,export',
		saveAll: true,
		editUrl: '/v1/customer/customer_channel_reset',
		editdblOnclick: true,
		exportOption: 'show_channel2_download_alert',
	});

	function show_channel2_download_alert() {
		$(this).alertmsg('confirm', '确定导出吗?', {okCall: 'channel2_download'});
	}

	function channel2_download() {
		var cusname = $("input[name='cusname']").val();
		var mobile = $("input[name='mobile']").val();
		var wechatnum = $("input[name='wechatnum']").val();
		var districtname = $("input[name='districtname']").val();
		var community = $("input[name='community']").val();
		var area = $("input[name='area']").val();
		var roomstatus = $("select[name='roomstatus']").val();
		var decorationdate = $("input[name='decorationdate']").val();
		var marketactive = $("select[name='marketactive']").val();
		var concerns = $("input[name='concerns']").val();
		var intentiontype = $("select[name='intentiontype']").val();
		var age = $("input[name='age']").val();
		var followstate = $("select[name='followstate']").val();
		var followdate = $("input[name='followdate']").val();
		var followtype = $("select[name='followtype']").val();
		var followdetails = $("input[name='followdetails']").val();
		var appdate = $("input[name='appdate']").val();
		var apptime = $("input[name='apptime']").val();
		var todate = $("input[name='todate']").val();
		var adults = $("input[name='adults']").val();
		var oldman = $("input[name='oldman']").val();
		var child = $("input[name='child']").val();
		var createuser = $("input[name='createuser']").val();
		var createtime = $("input[name='createtime']").val();
		var type = $("select[name='type']").val();
		var activnewname = $("input[name='activnewname']").val();
		var activname = $("input[name='activname']").val();
		var mobilesales = $("input[name='mobilesales']").val();
		var orgName = $("input[name='orgName']").val();
		var custsales = $("input[name='custsales']").val();
		var readiness = $("input[name='readiness']").val();
		var sffd = $("input[name='sffd']").val();
		var fdrq = $("input[name='fdrq']").val();
		var htzt = $("input[name='htzt']").val();
		var htje = $("input[name='htje']").val();
		var htrq = $("input[name='htrq']").val();
		var saletype = $("input[name='saletype']").val();
		var url = "/v1/customer/customer_channel_excel?pageCurrent=1&pageSize=10000";
		if (cusname.length > 0) {
			url += "&cusname=" + cusname;
		}
		if (mobile.length > 0) {
			url += "&mobile=" + mobile;
		}
		if (wechatnum.length > 0) {
			url += "&wechatnum=" + wechatnum;
		}
		if (districtname.length > 0) {
			url += "&districtname=" + districtname;
		}
		if (community.length > 0) {
			url += "&community=" + community;
		}
		if (area.length > 0) {
			url += "&area=" + area;
		}
		if (roomstatus.length > 0) {
			url += "&roomstatus=" + roomstatus;
		}
		if (decorationdate.length > 0) {
			url += "&decorationdate=" + decorationdate;
		}
		if (marketactive.length > 0) {
			url += "&marketactive=" + marketactive;
		}
		if (concerns.length > 0) {
			url += "&concerns=" + concerns;
		}
		if (intentiontype.length > 0) {
			url += "&intentiontype=" + intentiontype;
		}
		if (age.length > 0) {
			url += "&age=" + age;
		}
		if (followstate.length > 0) {
			url += "&followstate=" + followstate;
		}
		if (followdate.length > 0) {
			url += "&followdate=" + followdate;
		}
		if (followtype.length > 0) {
			url += "&followtype=" + followtype;
		}
		if (followdetails.length > 0) {
			url += "&followdetails=" + followdetails;
		}
		if (appdate.length > 0) {
			url += "&appdate=" + appdate;
		}
		if (apptime.length > 0) {
			url += "&apptime=" + apptime;
		}
		if (todate.length > 0) {
			url += "&todate=" + todate;
		}
		if (adults.length > 0) {
			url += "&adults=" + adults;
		}
		if (oldman.length > 0) {
			url += "&oldman=" + oldman;
		}
		if (child.length > 0) {
			url += "&child=" + child;
		}
		if (createuser.length > 0) {
			url += "&createuser=" + createuser;
		}
		if (createtime.length > 0) {
			url += "&createtime=" + createtime;
		}
		if (type.length > 0) {
			url += "&type=" + type;
		}
		if (activnewname.length > 0) {
			url += "&activnewname=" + activnewname;
		}
		if (activname.length > 0) {
			url += "&activname=" + activname;
		}
		if (mobilesales.length > 0) {
			url += "&mobilesales=" + mobilesales;
		}
		if (orgName.length > 0) {
			url += "&orgName=" + orgName;
		}
		if (custsales.length > 0) {
			url += "&custsales=" + custsales;
		}
		if (readiness.length > 0) {
			url += "&readiness=" + readiness;
		}
		if (sffd.length > 0) {
			url += "&sffd=" + sffd;
		}
		if (fdrq.length > 0) {
			url += "&fdrq=" + fdrq;
		}
		if (htzt.length > 0) {
			url += "&htzt=" + htzt;
		}
		if (htje.length > 0) {
			url += "&htje=" + htje;
		}
		if (htrq.length > 0) {
			url += "&htrq=" + htrq;
		}
		url += "&saletype=" + "1";

		window.open(url);
	}
</script>

<div style="height: 100%;">
	<table id="customer_channel_sales" class="table table-hover" data-width="100%"></table>

</div>