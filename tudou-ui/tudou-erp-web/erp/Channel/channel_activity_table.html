<script type="text/javascript">

    $('#activity_list_datagrid').datagrid({

        local: 'remote',
        dataUrl: '/v1/activity/activitylist',
        dataType: 'json',
        sortAll: false,
        loadType: 'get',
        filterAll: true,
        height: '100%',
        columns: [{name: 'activename', width: '150', label: '活动名称', rule: 'required'},
            {name: 'activitydescribe', width: '150', label: '活动描述', rule: 'required'},
            {name: 'createuser', width: '150', label: '创建人',attrs:{'readonly':"true"}},
            {name: 'createdepartment', width: '150', label: '创建人部门',attrs:{'readonly':"true"}},
            {name: 'activetime', width: '150', label: '活动时间', type:'date',pattern:'yyyy-MM-dd HH:mm:ss',rule: 'required'},
        ],
        paging: {pageSize: 20, selectPageSize: '50,100,200', pageCurrent: 1},
        hiddenFields: ['id'],
        columnMenu: true,
        columnShowhide: true,
        columnFilter: true,
        columnLock: false,
        inlineEditMult: false,
        fullGrid: false,
        showToolbar: true,
        toolbarItem: 'add,save,cancel',
        saveAll: true,
        editUrl: '/v1/activity/activity_add_reset',
        editdblOnclick: true,
        clickRow: 'clickRow',
        editCallback:'back_edit_test',
    });

    var aid;
    function clickRow() {
        var selected = $("#activity_list_datagrid").data('selectedDatas');
        if (selected[0].id != aid) {
            aid = selected[0].id;
            $(this).bjuiajax('doLoad', {
                url: 'Channel/activity_follow_table.html',
                target: '#activity_follow_table',
                loadingmask: true
            });
        }
    }

    function back_edit_test(json){
        if (json.state == 200){
            $('#activity_list_datagrid').datagrid('refresh');
        }else{
            $(this).alertmsg('warn', json.content);
        }
    }

</script>
<div style="border: 0px solid green;width: 100% !important;position: relative;height: 50%;">
    <table id="activity_list_datagrid" class="table table-hover" data-width="100%"></table>
</div>
</div>


<div id="activity_follow_table" style="border: 0px solid green;width: 100% !important;position: relative;height: 50%;">

</div>