<script>

	$('#channel_summary_h_b_d').val(h_b_d_data);
	$('#channel_summary_e_b_d').val(e_b_d_data);
	$('#channel_summary_h_f_d').val(h_f_d_data);
	$('#channel_summary_e_f_d').val(e_f_d_data);

	$('#channel_summary_table_detail').datagrid({
		local: 'remote',
		dataUrl: '/v1/summary/channel_detail?happlytime=' + h_b_d_data + '&eapplytime=' + e_b_d_data + '&hcreatetime=' + h_f_d_data + '&ecreatetime=' + e_f_d_data+'&source='+summary_table_source,
		dataType: 'json',
		loadType: 'get',
		height: '95%',
		filterThead: false,
		columns: [{name: 'source', width: '80', label: '渠道来源'},
			{name: 'secondsource', width: '80', label: '活动名称'},
			{name: 'thirdsource', width: '80', label: '活动页'},
			{name: 'foursource', width: '80', label: '活动编号'},
			{name: 'bm', width: '80', label: '报名', calc: 'sum', calcTit: '合计'},
			{name: 'hf', width: '80', label: '回访', calc: 'sum', calcTit: '合计'},
			{name: 'yx', width: '80', label: '意向', calc: 'sum', calcTit: '合计'},
			{name: 'yy', width: '80', label: '邀约', calc: 'sum', calcTit: '合计'},
			{name: 'dczs', width: '80', label: '到场总数', calc: 'sum', calcTit: '合计'},
			{name: 'ljcj', width: '80', label: '累计成交(不含退订)', calc: 'sum', calcTit: '合计'},
			{name: 'td', width: '80', label: '退订', calc: 'sum', calcTit: '合计'},
			{name: 'cjzj', width: '80', label: '成交总计(含退订)', calc: 'sum', calcTit: '合计'},
			{
				name: 'yxdcl', width: '80', label: '意向到场率', calc: 'avg', calcTit: '平均', render: function (value) {
				if (value > 0) {
					value += '%'
				} else {
					value = '0%'
				}
				return value;
			}
			},
			{
				name: 'skl', width: '80', label: '锁客率', calc: 'avg', calcTit: '平均', render: function (value) {
				if (value > 0) {
					value += '%'
				} else {
					value = '0%'
				}
				return value;
			}
			},
			{
				name: 'bmdcl', width: '80', label: '报名到场率', calc: 'avg', calcTit: '平均', render: function (value) {
				if (value > 0) {
					value += '%'
				} else {
					value = '0%'
				}
				return value;
			}
			},
			{
				name: 'bmcjl', width: '80', label: '报名成交率', calc: 'avg', calcTit: '平均', render: function (value) {
				if (value > 0) {
					value += '%'
				} else {
					value = '0%'
				}
				return value;
			}
			},
			{
				name: 'xh', width: '80', label: '消耗(不含返点)', calc: 'sum', calcTit: '合计'
			},
			{
				name: 'fd', width: '80', label: '返点', calc: 'avg', calcTit: '平均', render: function (value) {
				if (value > 0) {
					value += '%'
				} else {
					value = '0%'
				}
				return value;
			}
			},
			{name: 'sjxh', width: '80', label: '实际消耗(含返点)', calc: 'sum', calcTit: '合计'},
			{name: 'bmcb', width: '80', label: '报名成本', calc: 'sum', calcTit: '合计'},
			{name: 'yxcb', width: '80', label: '意向成本', calc: 'sum', calcTit: '合计'},
			{name: 'dccb', width: '80', label: '到场成本', calc: 'sum', calcTit: '合计'},
			{name: 'cjcb', width: '80', label: '成交成本', calc: 'sum', calcTit: '合计'}
		],
		columnMenu: true,
		columnShowhide: true,
		columnFilter: true,
		columnLock: false,
		fullGrid: false,
		showTfoot: true,
		paging: false,
//		showLinenumber: false,
	});

	function select_summary_detail_data() {
		h_b_d_data = $('#channel_summary_h_b_d').val()
		e_b_d_data = $('#channel_summary_e_b_d').val()
		h_f_d_data = $('#channel_summary_h_f_d').val()
		e_f_d_data = $('#channel_summary_e_f_d').val()
		$(this).bjuiajax('doLoad', {
			url: 'Channel/channel_summary_detail_table_2.html',
			target: '#channel_summary_detail_layout',
			loadingmask: true
		});

	}

	function clear_summary_detail_data() {
		h_b_d_data = ''
		e_b_d_data = ''
		h_f_d_data = ''
		e_f_d_data = ''
		$('#channel_summary_h_b_d').val('');
		$('#channel_summary_e_b_d').val('');
		$('#channel_summary_h_f_d').val('');
		$('#channel_summary_e_f_d').val('');
		$(this).bjuiajax('doLoad', {
			url: 'Channel/channel_summary_detail_table_2.html',
			target: '#channel_summary_detail_layout',
			loadingmask: true
		});
	}


</script>

<div class="bjui-pageContent">
	<div style="margin:0px 0px 10px 0px;">

		<label class="control-label">按报名日期查询：</label>
		<input type="text" id="channel_summary_h_b_d" data-toggle="datepicker" size="15" class="form-control"
			   aria-required="true" style="width: 80px;">
		<label class="control-label">—</label>
		<input type="text" id="channel_summary_e_b_d" data-toggle="datepicker" size="15" class="form-control"
			   aria-required="true" style="width: 80px;">

		<label class="control-label">按日期分类查询：</label>
		<input type="text" id="channel_summary_h_f_d" data-toggle="datepicker" size="15" class="form-control"
			   aria-required="true" style="width: 80px;">
		<label class="control-label">—</label>
		<input type="text" id="channel_summary_e_f_d" data-toggle="datepicker" size="15" class="form-control"
			   aria-required="true" style="width: 80px;">

		<button type="button" class="btn btn-green" onclick="select_summary_detail_data()"><i class="fa fa-edit"></i>查询
		</button>

		<button type="button" class="btn btn-green" onclick="clear_summary_detail_data()"><i class="fa fa-edit"></i>刷新
		</button>
	</div>


	<table id="channel_summary_table_detail" class="table table-hover" data-width="80%"></table>
</div>