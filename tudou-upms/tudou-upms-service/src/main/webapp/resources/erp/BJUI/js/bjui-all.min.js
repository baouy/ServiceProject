+function(a){"use strict";function c(){this.datas=new Array}var b={JSPATH:"BJUI/",PLUGINPATH:"BJUI/plugins/",IS_DEBUG:!1,KeyPressed:{ctrl:!1,shift:!1},keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,CTRL:17,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},eventType:{initUI:"bjui.initUI",beforeInitUI:"bjui.beforeInitUI",afterInitUI:"bjui.afterInitUI",ajaxStatus:"bjui.ajaxStatus",resizeGrid:"bjui.resizeGrid",beforeAjaxLoad:"bjui.beforeAjaxLoad",beforeLoadNavtab:"bjui.beforeLoadNavtab",beforeLoadDialog:"bjui.beforeLoadDialog",afterLoadNavtab:"bjui.afterLoadNavtab",afterLoadDialog:"bjui.afterLoadDialog",beforeCloseNavtab:"bjui.beforeCloseNavtab",beforeCloseDialog:"bjui.beforeCloseDialog",afterCloseNavtab:"bjui.afterCloseNavtab",afterCloseDialog:"bjui.afterCloseDialog"},pageInfo:{pageCurrent:"pageCurrent",pageSize:"pageSize",orderField:"orderField",orderDirection:"orderDirection"},alertMsg:{displayPosition:"topcenter",alertTimeout:6e3},ajaxTimeout:3e4,statusCode:{ok:200,error:300,timeout:301},keys:{statusCode:"statusCode",message:"message"},ui:{windowWidth:0,showSlidebar:!0,clientPaging:!0,overwriteHomeTab:!1},debug:function(a){this.IS_DEBUG&&("undefined"!=typeof console?console.log(a):alert(a))},loginInfo:{url:"login.html",title:"Login",width:420,height:260,mask:!0},loadLogin:function(){var a=this.loginInfo;b.dialog({id:"bjui-login",url:a.url,title:a.title,width:a.width,height:a.height,mask:a.mask})},init:function(c){var d=a.extend({},c);a.extend(b.statusCode,d.statusCode),a.extend(b.pageInfo,d.pageInfo),a.extend(b.alertMsg,d.alertMsg),a.extend(b.loginInfo,d.loginInfo),a.extend(b.ui,d.ui),d.JSPATH&&(this.JSPATH=d.JSPATH),d.PLUGINPATH&&(this.PLUGINPATH=d.PLUGINPATH),d.ajaxTimeout&&(this.ajaxTimeout=d.ajaxTimeout),this.IS_DEBUG=d.debug||!1,this.initEnv(),a.cookie&&a.cookie("bjui_theme")||!d.theme||a(this).theme("setTheme",d.theme)},initEnv:function(){a(window).resize(function(){var c=a(this).width();b.ui.windowWidth&&b.ui.windowWidth>600&&b.ui.windowWidth<c&&(c=b.ui.windowWidth),b.initLayout(c),setTimeout(function(){a(this).trigger(b.eventType.resizeGrid)},30)}),setTimeout(function(){var c=a(window).width();b.ui.windowWidth&&b.ui.windowWidth>600&&b.ui.windowWidth<c&&(c=b.ui.windowWidth),b.initLayout(c),a(document).initui()},10)},initLayout:function(c){var g,h,i,j,k,l,m,n,o,p,q,r,d=c-(b.ui.showSlidebar?a("#bjui-sidebar").width()+6:6),e=a(window).height()-a("#bjui-header").height()-a("#bjui-footer").outerHeight(),f=a("#bjui-navtab").find(".tabsPageHeader").height();b.ui.windowWidth&&a("#bjui-window").width(c),b.windowWidth=c,a("#bjui-container").height(e),a("#bjui-navtab").width(d),a("#bjui-leftside, #bjui-sidebar, #bjui-sidebar-s, #bjui-splitBar, #bjui-splitBarProxy").css({height:"100%"}),a("#bjui-navtab .tabsPageContent").height(e-f),setTimeout(function(){a("#bjui-navtab > .tabsPageContent > .navtabPage").resizePageH(),a("#bjui-navtab > .tabsPageContent > .navtabPage").find(".bjui-layout").resizePageH()},10),g=a("body").data("bjui.navbar.width"),h=a("#bjui-header"),i=h.find(".bjui-navbar-toggle"),j=h.find(".bjui-navbar-logo"),k=a("#bjui-navbar-collapse"),l=k.find(".bjui-navbar-right"),g||(g={logoW:j.outerWidth(),navW:l.outerWidth()},a("body").data("bjui.navbar.width",g)),g&&(c-g.logoW<g.navW?(i.show(),k.addClass("collapse menu")):(i.hide(),k.removeClass("collapse menu in"))),m=a("#bjui-hnav-navbar-box"),n=m.find("> #bjui-hnav-navbar"),o=m.prev(),p=m.next(),q=m.width(),r=0,n.find("> li").each(function(){var c=a(this);r+=c.outerWidth(),r>q?(p.show(),m.data("hnav.move",!0).data("hnav.liw",r)):(o.hide(),p.hide(),m.removeData("hnav.move"))})},regional:{},setRegional:function(a,c){b.regional[a]=c},getRegional:function(a){var c,d,e;if(String(a).indexOf(".")>=0){for(d=String(a).split("."),e=0;e<d.length;e++)c=c?c[d[e]]:b.regional[d[e]];return c}return b.regional[a]},doRegional:function(b,c){return a.each(c,function(a,c){b=b.replaceAll("#"+a+"#",c)}),b},isIE:function(a){var b=document.createElement("b");return b.innerHTML="<!--[if IE "+a+"]><i></i><![endif]-->",1===b.getElementsByTagName("i").length},StrBuilder:function(){return new c}};c.prototype.add=function(a){return"undefined"!=typeof a&&this.datas.push(a),this},c.prototype.toString=function(a){var b=this.datas.join(a||"");return this.clear(),b},c.prototype.isEmpty=function(){return 0==this.datas.length},c.prototype.clear=function(){this.datas=[],this.datas.length=0},window.BJUI=b}(jQuery),+function(a){"use strict";a(function(){BJUI.setRegional("alertmsg",{title:{error:"错误提示",info:"信息提示",warn:"警告信息",correct:"成功信息",confirm:"确认信息"},btnMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}}),BJUI.setRegional("dialog",{close:"关闭",maximize:"最大化",restore:"还原",minimize:"最小化",title:"弹出窗口"}),BJUI.setRegional("orderby",{asc:"升序",desc:"降序"}),BJUI.setRegional("pagination",{total:"总记录数/总页数",first:"首页",last:"末页",prev:"上一页",next:"下一页",jumpto:"输入跳转页码，回车确认",jump:"跳转",page:"页",refresh:"刷新"}),BJUI.setRegional("datagrid",{asc:"升序",desc:"降序",showhide:"显示/隐藏 列",filter:"过滤",clear:"清除",lock:"锁定列",unlock:"解除锁定",add:"添加",edit:"编辑",save:"保存",update:"更新",cancel:"取消",del:"删除",prev:"上一条",next:"下一条",refresh:"刷新",query:"查询","import":"导入","export":"导出",all:"全部","true":"是","false":"否",noData:"没有数据！",expandMsg:"点我展开行！",shrinkMsg:"点我收缩行！",selectMsg:"未选中任何行！",editMsg:"请先保存编辑行！",saveMsg:"没有需要保存的行！",delMsg:"确定要删除该行吗？",delMsgM:"确定要删除选中行？"}),BJUI.setRegional("findgrid",{choose:"选择选中项",append:"追加选择",empty:"清空现有值"}),BJUI.setRegional("progressmsg","正在努力加载数据，请稍等..."),BJUI.setRegional("datepicker",{close:"关闭",prev:"上月",next:"下月",clear:"清空",ok:"确定",dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}),BJUI.setRegional("navtabCM",{refresh:"刷新本标签",close:"关闭本标签",closeother:"关闭其他标签",closeall:"关闭所有标签"}),BJUI.setRegional("dialogCM",{refresh:"刷新本窗口",close:"关闭本窗口",closeother:"关闭其他窗口",closeall:"关闭所有窗口"}),BJUI.setRegional("upload",{upConfirm:"开始上传",upPause:"暂停上传",upCancel:"取消上传"}),BJUI.setRegional("statusCode_503","服务器当前负载过大或者正在维护！"),BJUI.setRegional("ajaxnosend","与服务器的通信中断，请检查URL链接或服务器状态！"),BJUI.setRegional("sessiontimeout","会话超时，请重新登陆！"),BJUI.setRegional("plhmsg","占位符对应的选择器无有效值！"),BJUI.setRegional("nocheckgroup",'未定义选中项的组名[复选框的"data-group"]！'),BJUI.setRegional("notchecked","未选中任何一项！"),BJUI.setRegional("selectmsg","请选择一个选项！"),BJUI.setRegional("validatemsg","提交的表单中 [{0}] 个字段有错误，请更正后再提交！"),BJUI.setRegional("idChecked","不规范，ID需以字母开头，组成部分包括（0-9，字母，中横线，下划线）"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","我的主页"),a.validator&&a.validator.config({defaultMsg:"{0}格式不正确",loadingMsg:"正在验证...",rules:{digits:[/^\d+$/,"请输入整数"],number:[/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,"请输入有效的数字"],letters:[/^[a-z]+$/i,"{0}只能输入字母"],tel:[/^(?:(?:0\d{2,3}[\- ]?[1-9]\d{6,7})|(?:[48]00[\- ]?[1-9]\d{6}))$/,"电话格式不正确"],mobile:[/^1[3-9]\d{9}$/,"手机号格式不正确"],email:[/^[\w\+\-]+(\.[\w\+\-]+)*@[a-z\d\-]+(\.[a-z\d\-]+)*\.([a-z]{2,4})$/i,"邮箱格式不正确"],qq:[/^[1-9]\d{4,}$/,"QQ号格式不正确"],date:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/,"请输入正确的日期，例：yyyy-MM-dd"],time:[/^(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的时间，例：HH:mm:ss"],datetime:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的日期时间，例：yyyy-MM-dd HH:mm:ss"],ID_card:[/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[A-Z])$/,"请输入正确的身份证号码"],url:[/^(https?|ftp):\/\/[^\s]+$/i,"网址格式不正确"],postcode:[/^[1-9]\d{5}$/,"邮政编码格式不正确"],chinese:[/^[\u0391-\uFFE5]+$/,"请输入中文"],username:[/^\w{3,12}$/,"请输入3-12位数字、字母、下划线"],password:[/^[0-9a-zA-Z]{6,16}$/,"密码由6-16位数字、字母组成"],pattern:function(a,b){if(!b)return!0;var c=a.value.parseDate(b);return c?!0:this.renderMsg("错误的日期时间格式！",b)},accept:function(a,b){if(!b)return!0;var c=b[0];return"*"===c||new RegExp(".(?:"+(c||"png|jpg|jpeg|gif")+")$","i").test(a.value)||this.renderMsg("只接受{1}后缀",c.replace("|",","))}}}),a.validator&&a.validator.config({messages:{required:"{0}不能为空",remote:"{0}已被使用",integer:{"*":"请输入整数","+":"请输入正整数","+0":"请输入正整数或0","-":"请输入负整数","-0":"请输入负整数或0"},match:{eq:"{0}与{1}不一致",neq:"{0}与{1}不能相同",lt:"{0}必须小于{1}",gt:"{0}必须大于{1}",lte:"{0}必须小于或等于{1}",gte:"{0}必须大于或等于{1}"},range:{rg:"请输入{1}到{2}的数",gte:"请输入大于或等于{1}的数",lte:"请输入小于或等于{1}的数"},checked:{eq:"请选择{1}项",rg:"请选择{1}到{2}项",gte:"请至少选择{1}项",lte:"请最多选择{1}项"},length:{eq:"请输入{1}个字符",rg:"请输入{1}到{2}个字符",gte:"请至少输入{1}个字符",lte:"请最多输入{1}个字符",eq_2:"",rg_2:"",gte_2:"",lte_2:""}}})})}(jQuery),+function(){"use strict";BJUI.setRegional("alertmsg",{title:{error:"Error",info:"Info",warn:"Warning",correct:"Correct",confirm:"Confirm"},btnMsg:{ok:"OK",yes:"YES",no:"NO",cancel:"Cancel"}}),BJUI.setRegional("dialog",{close:"Close",maximize:"Maximize",restore:"Restore",minimize:"Minimize",title:"Popup window"}),BJUI.setRegional("orderby",{asc:"Asc",desc:"Desc"}),BJUI.setRegional("pagination",{first:"First page",last:"Last page",prev:"Prev page",next:"Next page",jumpto:"Jump page number",jump:"Jump"}),BJUI.setRegional("datagrid",{asc:"ASC",desc:"DESC",showhide:"Show/Hide columns",filter:"Filter",clear:"Clear",lock:"Lock",unlock:"Unlock",add:"Add",edit:"Edit",save:"Save",update:"Update",cancel:"Cancel",del:"Delete",prev:"Prev",next:"Next",refresh:"Refresh",query:"Query","import":"Import","export":"Export",all:"All","true":"True","false":"False",noData:"No data!",expandMsg:"Click here to expand the tr!",shrinkMsg:"Click here to shrink the tr!",selectMsg:"Not selected any rows!",saveMsg:"No rows need to save!",editMsg:"Please save the edited row!",delMsg:"Sure you want to delete this row?",delMsgM:"Sure you want to delete selected rows?"}),BJUI.setRegional("findgrid",{choose:"Choose the selected item",append:"Append choose the selected item",empty:"Empty existing values"}),BJUI.setRegional("progressmsg","Data loading, please waiting..."),BJUI.setRegional("datepicker",{close:"Close",prev:"Prev month",next:"Next month",clear:"Clear",ok:"OK",dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),BJUI.setRegional("navtabCM",{refresh:"Refresh navtab",close:"Close navtab",closeother:"Close other navtab",closeall:"Close all navtab"}),BJUI.setRegional("dialogCM",{refresh:"Refresh dialog",close:"Close dialog",closeother:"Close other dialog",closeall:"Close all dialog"}),BJUI.setRegional("upload",{upConfirm:"Start upload",upPause:"Pause upload",upCancel:"Cancel upload"}),BJUI.setRegional("statusCode_503","HTTP status 503, the current server load is too large or is down for maintenance!"),BJUI.setRegional("ajaxnosend","Communication with the server is interrupted, please check the URL link or server status!"),BJUI.setRegional("sessiontimout","Session timeout, please login!"),BJUI.setRegional("plhmsg","Placeholder corresponding selector None Valid!"),BJUI.setRegional("nocheckgroup",'Undefined group name selected item [check box "data-group"]!'),BJUI.setRegional("notchecked","Unchecked any one!"),BJUI.setRegional("selectmsg","Please select one option!"),BJUI.setRegional("validatemsg","Submitted form data has [{0}] field an error, please after modified submitting!"),BJUI.setRegional("idChecked","is not standardized, ID need to start with a letter, components include (0-9, letters, hyphens, underscore)"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","My home"),window.FRAG={dialog:'<div class="bjui-dialog bjui-dialog-container" style="top:150px; left:300px;">    <div class="dialogHeader" onselectstart="return false;" oncopy="return false;" onpaste="return false;" oncut="return false;">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <a class="maximize" href="javascript:;" title="#maximize#"><i class="fa fa-plus-circle"></i></a>        <a class="restore" href="javascript:;" title="#restore#"><i class="fa fa-history"></i></a>        <a class="minimize" href="javascript:;" title="#minimize#"><i class="fa fa-minus-circle"></i></a>        <h1><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></h1>    </div>    <div class="dialogContent unitBox"></div>    <div class="resizable_h_l" tar="nw"></div>    <div class="resizable_h_r" tar="ne"></div>    <div class="resizable_h_c" tar="n"></div>    <div class="resizable_c_l" tar="w" style="height:100%;"></div>    <div class="resizable_c_r" tar="e" style="height:100%;"></div>    <div class="resizable_f_l" tar="sw"></div>    <div class="resizable_f_r" tar="se"></div>    <div class="resizable_f_c" tar="s"></div></div>',taskbar:'<div id="bjui-taskbar" style="left:0px; display:none;">    <div class="taskbarContent">        <ul></ul>    </div>    <div class="taskbarLeft taskbarLeftDisabled"><i class="fa fa-angle-double-left"></i></div>    <div class="taskbarRight"><i class="fa fa-angle-double-right"></i></div></div>',splitBar:'<div id="bjui-splitBar"></div>',splitBarProxy:'<div id="bjui-splitBarProxy"></div>',resizable:'<div id="bjui-resizable" class="bjui-resizable"></div>',alertBackground:'<div class="bjui-alertBackground"></div>',maskBackground:'<div class="bjui-maskBackground bjui-ajax-mask"></div>',maskProgress:'<div class="bjui-maskProgress bjui-ajax-mask"><i class="fa fa-cog fa-spin"></i>&nbsp;&nbsp;#progressmsg#<div class="progressBg"><div class="progress"></div></div></div>',progressBar_custom:'<div id="bjui-progressBar-custom" class="progressBar"><i class="fa fa-cog fa-spin"></i> <span></span></div>',dialogMask:'<div class="bjui-dialogBackground"></div>',orderby:'<a href="javascript:;" class="order asc" data-order-direction="asc" title="#asc#"><i class="fa fa-angle-up"></i></a><a href="javascript:;" class="order desc" data-order-direction="desc" title="#desc#"><i class="fa fa-angle-down"></i></a>',slidePanel:'<div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#bjui-accordionmenu" href="##id#" class="#class#">#icon#&nbsp;#title#<b>#righticon#</b></a></h4>    </div>    <div id="#id#" class="panel-collapse collapse#bodyclass#">        <div class="panel-body">        </div>    </div></div>',pagination:'<ul class="pagination">    <li class="j-first">        <a class="first" href="javascript:;"><i class="fa fa-step-backward"></i> #first#</a>        <span class="first"><i class="fa fa-step-backward"></i> #first#</span>    </li>    <li class="j-prev">        <a class="previous" href="javascript:;"><i class="fa fa-backward"></i> #prev#</a>        <span class="previous"><i class="fa fa-backward"></i> #prev#</span>    </li>    #pageNumFrag#    <li class="j-next">        <a class="next" href="javascript:;">#next# <i class="fa fa-forward"></i></a>        <span class="next">#next# <i class="fa fa-forward"></i></span>    </li>    <li class="j-last">        <a class="last" href="javascript:;">#last# <i class="fa fa-step-forward"></i></a>        <span class="last">#last# <i class="fa fa-step-forward"></i></span>    </li>    <li class="jumpto"><span class="p-input"><input class="form-control input-sm-pages" type="text" size="2.6" value="#pageCurrent#" title="#jumpto#"></span><a class="goto" href="javascript:;" title="#jump#"><i class="fa fa-chevron-right"></i></a></li></ul>',gridPaging:'<ul class="pagination">    <li class="page-total">        <span title="#total#">#count#</span>    </li>    <li class="page-jumpto"><span class="page-input"><input class="form-control input-sm-pages" type="text" size="3.2" value="#pageCurrent#" title="#jumpto#"></span></li>    <li class="page-first btn-nav">        <a href="javascript:;" title="#first#"><i class="fa fa-step-backward"></i></a>    </li>    <li class="page-prev btn-nav">        <a href="javascript:;" title="#prev#"><i class="fa fa-backward"></i></a>    </li>    #pageNumFrag#    <li class="page-next btn-nav">        <a href="javascript:;" title="#next#"><i class="fa fa-forward"></i></a>    </li>    <li class="page-last btn-nav">        <a href="javascript:;" title="#last#"><i class="fa fa-step-forward"></i></a>    </li></ul>',gridPageNum:'<li class="page-num#active#"><a href="javascript:;">#num#</a></li>',gridMenu:'<div class="datagrid-menu-box">    <ul>        <li class="datagrid-li-asc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-asc"></i></span><span class="title">#asc#</span></a></li>        <li class="datagrid-li-desc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-desc"></i></span><span class="title">#desc#</span></a></li>        <li class="datagrid-li-filter"><a href="javascript:;"><span class="icon"><i class="fa fa-filter"></i></span><span class="title">#filter#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-showhide"><a href="javascript:;"><span class="icon"><i class="fa fa-check-square-o"></i></span><span class="title">#showhide#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-lock"><a href="javascript:;"><span class="icon"><i class="fa fa-lock"></i></span><span class="title">#lock#</span></a></li>        <li class="datagrid-li-unlock disable"><a href="javascript:;"><span class="icon"><i class="fa fa-unlock"></i></span><span class="title">#unlock#</span></a></li>    </ul></div>',gridFilter:'<div class="datagrid-filter-box"><fieldset><legend>#label#</legend><span class="filter-a"></span><span class="filter-and"><select data-toggle="selectpicker" data-container="true" data-width="100%"><option value="and">AND</option><option value="or">OR</option></select></span><span class="filter-b"></span><span class="filter-ok"><button type="button" class="btn-green ok" data-icon="check">#filter#</button><button type="button" class="btn-orange clear" data-icon="remove">#clear#</button></span></fieldset></div>',gridShowhide:'<li data-index="#index#" class="datagrid-col-check"><a href="javascript:;"><i class="fa fa-check-square-o"></i>#label#</a></li>',gridEditBtn:'<button type="button" class="btn btn-green edit"><i class="fa fa-edit"></i> #edit#</button><button type="button" class="btn btn-green update"><i class="fa fa-edit"></i> #update#</button><button type="button" class="btn btn-green save"><i class="fa fa-check"></i> #save#</button><button type="button" class="btn btn-orange cancel"><i class="fa fa-undo"></i> #cancel#</button><button type="button" class="btn btn-red delete"><i class="fa fa-remove"></i> #del#</button>',gridDialogEditBtns:'<ul>    <li class="pull-left"><button type="button" class="btn btn-orange prev" data-icon="arrow-up">#prev#</button></li>    <li class="pull-left"><button type="button" class="btn btn-orange next" data-icon="arrow-down">#next#</button></li>    <li><button type="button" class="btn btn-red cancel" data-icon="remove">#cancel#</button></li>    <li><button type="button" class="btn btn-default save" data-icon="save">#save#</button></li></ul>',gridExpandBtn:'<span title="#expandMsg#"><i class="fa fa-plus"></i></span>',gridShrinkBtn:'<span title="#shrinkMsg#"><i class="fa fa-minus"></i></span>',alertBoxFrag:'<div id="bjui-alertMsgBox" class="bjui-alert"><div class="alertContent"><div class="#type#"><div class="alertInner"><h1><i class="fa #fa#"></i>#title#</h1><div class="msg">#message#</div></div><div class="toolBar"><ul>#btnFragment#</ul></div></div></div></div>',alertBtnFrag:'<li><button class="btn btn-#class#" rel="#callback#" type="button">#btnMsg#</button></li>',calendarFrag:'<div id="bjui-calendar">    <div class="main">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <div class="head">            <table width="100%" border="0" cellpadding="0" cellspacing="2">                <tr>                    <td width="20"><a class="prev" href="javascript:;" title="#prev#"><i class="fa fa-arrow-left"></i></a></td>                    <td><select name="year"></select></td>                    <td><select name="month"></select></td>                    <td width="20"><a class="next" href="javascript:;" title="#next#"><i class="fa fa-arrow-right"></i></a></td>                </tr>            </table>        </div>        <div class="body">            <dl class="dayNames"><dt>7</dt><dt>1</dt><dt>2</dt><dt>3</dt><dt>4</dt><dt>5</dt><dt>6</dt></dl>            <dl class="days"><!-- date list --></dl>            <div style="clear:both;height:0;line-height:0"></div>        </div>        <div class="foot">            <table class="time">                <tr>                    <td>                        <input type="text" class="hh" maxlength="2" data-type="hh" data-start="0" data-end="23">:<input                         type="text" class="mm" maxlength="2" data-type="mm" data-start="0" data-end="59">:<input                         type="text" class="ss" maxlength="2" data-type="ss" data-start="0" data-end="59">                    </td>                    <td><ul><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul></td>                </tr>            </table>            <button type="button" class="clearBtn btn btn-orange">#clear#</button>            <button type="button" class="okBtn btn btn-default">#ok#</button>        </div>        <div class="tm">            <ul class="hh">                <li>0</li>                <li>1</li>                <li>2</li>                <li>3</li>                <li>4</li>                <li>5</li>                <li>6</li>                <li>7</li>                <li>8</li>                <li>9</li>                <li>10</li>                <li>11</li>                <li>12</li>                <li>13</li>                <li>14</li>                <li>15</li>                <li>16</li>                <li>17</li>                <li>18</li>                <li>19</li>                <li>20</li>                <li>21</li>                <li>22</li>                <li>23</li>            </ul>            <ul class="mm">                <li>0</li>                <li>5</li>                <li>10</li>                <li>15</li>                <li>20</li>                <li>25</li>                <li>30</li>                <li>35</li>                <li>40</li>                <li>45</li>                <li>50</li>                <li>55</li>            </ul>            <ul class="ss">                <li>0</li>                <li>10</li>                <li>20</li>                <li>30</li>                <li>40</li>                <li>50</li>            </ul>        </div>    </div></div>',spinnerBtn:'<ul class="bjui-spinner"><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul>',lookupBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="lookupbtn"><i class="fa fa-search"></i></a>',findgridBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="findgridbtn"><i class="fa fa-search"></i></a>',dateBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="datepickerbtn"><i class="fa fa-calendar"></i></a>',navtabCM:'<ul id="bjui-navtabCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</li></ul>',dialogCM:'<ul id="bjui-dialogCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</span></li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</span></li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</span></li></ul>',externalFrag:'<iframe src="{url}" style="width:100%;height:{height};" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>',uploadTemp:'<div id="{fileId}" class="item">    <div class="info">        <span class="up_filename">{fileName}</span><span class="up_confirm" title="#upConfirm#"><i class="fa fa-play-circle-o"></i></span><span class="up_pause" title="#upPause#"><span class="glyphicon glyphicon-pause"></span></span><span class="up_cancel" title="#upCancel#"><i class="fa fa-times-circle-o"></i></span>    </div>    <div class="preview"><span class="img"></span></div>    <div class="progress"><div class="bar"></div></div>    <span class="percent">{percent}</span>    <span class="filesize"><span class="uploadedsize">{uploadedSize}</span>/<span class="totalsize">{fileSize}</span></span></div>',uploadFrag:'<input class="bjui-upload-select-file" style="display:none;" type="file" name="fileselect[]" #multi# accept="#accept#"><a href="javascript:void(0)" class="btn btn-default bjui-upload-select">#btnTxt#</a><div class="queue"></div>'}}(jQuery),+function(a){"use strict";a.fn.extend({ajaxUrl:function(b){var c=a(this);c.trigger(BJUI.eventType.beforeAjaxLoad),b.loadingmask&&c.trigger(BJUI.eventType.ajaxStatus),a.ajax({type:b.type||"GET",url:b.url,data:b.data||{},cache:!1,dataType:"html",timeout:BJUI.ajaxTimeout,success:function(d){var e=d.toJson(),f=c.find("> .bjui-ajax-mask");e[BJUI.keys.statusCode]?(e[BJUI.keys.statusCode]==BJUI.statusCode.error?(e[BJUI.keys.message]&&c.alertmsg("error",e[BJUI.keys.message]),c.closest(".bjui-layout").length||(c.closest(".navtab-panel").length?c.navtab("closeCurrentTab"):c.dialog("closeCurrent"))):e[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&(c.closest(".bjui-dialog").length&&c.dialog("closeCurrent"),c.closest(".navtab-panel").length&&c.navtab("closeCurrentTab"),BJUI.alertmsg("info",e[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()),f.fadeOut("normal",function(){a(this).remove()})):c.empty().html(d).append(f).initui(),a.isFunction(b.callback)&&b.callback(d)},error:function(a,b,d){c.bjuiajax("ajaxError",a,b,d),c.closest(".bjui-layout").length||(c.closest(".navtab-panel").length?c.navtab("closeCurrentTab"):c.dialog("closeCurrent")),c.trigger("bjui.ajaxError")},statusCode:{0:function(){BJUI.alertmsg("error",BJUI.regional.ajaxnosend)},503:function(){BJUI.alertmsg("error",BJUI.regional.statusCode_503)}}})},loadUrl:function(b,c,d){a(this).ajaxUrl({url:b,data:c,callback:d})},doAjax:function(b){var d,e,c=a(this);return b.url?b.callback?(b.callback=b.callback.toFunc(),b.loadingmask&&(d=c.getPageTarget(),d.trigger(BJUI.eventType.ajaxStatus),e=d.find("> .bjui-ajax-mask")),b.type||(b.type="POST"),b.dataType||(b.dataType="json"),b.cache||(b.cache=!1),b.timeout=b.ajaxTimeout||BJUI.ajaxTimeout,b.success=function(c){e?b.callback?a.when(b.callback(c)).done(function(){d.trigger("bjui.ajaxStop")}):d.trigger("bjui.ajaxStop"):b.callback(c)},b.error=b.error||function(a,b,c){BJUI.ajax("ajaxError",a,b,c),e&&d.trigger("bjui.ajaxError")},b.statusCode={0:function(){BJUI.alertmsg("error",BJUI.regional.ajaxnosend)},503:function(){BJUI.alertmsg("error",BJUI.regional.statusCode_503)}},a.ajax(b),void 0):(BJUI.debug("The ajax callback is undefined!"),void 0):(BJUI.debug("The ajax url is undefined!"),void 0)},getPageTarget:function(){var b;return b=this.closest(".bjui-layout").length?this.closest(".bjui-layout"):this.closest(".navtab-panel").length?a.CurrentNavtab:a.CurrentDialog},resizePageH:function(){return this.each(function(){if(!a(this).closest(".tab-content").length){var b=a(this),c=b.find("> .bjui-pageHeader"),d=b.find("> .bjui-pageContent"),e=b.find("> .bjui-pageFooter"),f=c.outerHeight()||0,g=e.outerHeight()||0;e.css("bottom")&&(g+=parseInt(e.css("bottom"))||0),!g&&b.hasClass("dialogContent")&&(g=5),d.css({top:f,bottom:g})}})},getMaxIndexObj:function(b){var c=0,d=0;return b.each(function(b){var e=parseInt(a(this).css("zIndex"))||1;e>c&&(c=e,d=b)}),b.eq(d)},serializeJson:function(){var b={},c=this.serializeArray();return a.each(c,function(){void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},isTag:function(b){return b?a(this).prop("tagName")?a(this)[0].tagName.toLowerCase()==b?!0:!1:!1:!1},isBind:function(b){var c=a(this).data("events");return c&&b&&c[b]},log:function(a){return this.each(function(){console&&console.log("%s: %o",a,this)})}}),a.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(){return new RegExp(/^([-]{0,1}(\d+)[\.]+(\d+))|([-]{0,1}(\d+))$/).test(this)},isNormalID:function(){return new RegExp(/^[a-zA-Z][0-9a-zA-Z_-]*$/).test(this)},includeChinese:function(){return new RegExp(/[\u4E00-\u9FA5]/).test(this)},trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},startsWith:function(a){return 0===this.indexOf(a)},endsWith:function(a){var b=this.length-a.length;return b>=0&&this.lastIndexOf(a)===b},replaceSuffix:function(a){return this.replace(/\[[0-9]+\]/,"["+a+"]").replace("#index#",a)},replaceSuffix2:function(a){return this.replace(/\-(i)([0-9]+)$/,"-i"+a).replace("#index#",a)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(a,b){return this.replace(new RegExp(a,"gm"),b)},replacePlh:function(b){return b=b||a(document),this.replace(/{\/?[^}]*}/g,function(a){var c=b.find(a.replace(/[{}]+/g,""));return c&&c.val()?c.val():a})},replaceMsg:function(a){return this.replace(new RegExp("({.*})","g"),a)},replaceTm:function(a){return a?this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(b){return a[b.replace(/[{}]+/g,"")]}):this},replaceTmById:function(b){var c=b||a(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(a){var b=c.find("#"+a.replace(/[{}]+/g,""));return b.val()?b.val():a})},isFinishedTm:function(){return!new RegExp("{/?[^}]*}").test(this)},skipChar:function(a){return this&&0!==this.length?this.charAt(0)===a?this.substring(1).skipChar(a):this:""},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isSpaces:function(){var a,b;for(a=0;a<this.length;a+=1)if(b=this.charAt(a)," "!=b&&"\n"!=b&&"	"!=b&&"\r"!=b)return!1;return!0},isPhone:function(){return new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this)},isUrl:function(){return new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){return this.isUrl()&&-1==this.indexOf("://"+document.domain)},toBool:function(){return"true"===this.toLowerCase()?!0:!1},toJson:function(){var a=this;try{return"object"==typeof a&&(a=a.toString()),a.trim().match("^{(.+:.+,*){1,}}$")?JSON.parse(this):this}catch(b){return this}},toObj:function(){var a=null;try{a=new Function("return "+this)()}catch(b){a=this,BJUI.debug('String toObj：Parse "String" to "Object" error! Your str is: '+this)}return a},toFunc:function(){var a,b,c;if(!this||!this.length)return void 0;if(this.startsWith("function"))return new Function("return "+this)();try{for(a=this.split("."),b=window,c=0;c<a.length;c++)b=b[a[c]];if("function"==typeof b)return b}catch(d){return void 0}}}),a.extend(Function.prototype,{toFunc:function(){return this}}),a.extend(Array.prototype,{remove:function(a){return 0>a?this:this.slice(0,a).concat(this.slice(a+1,this.length))},unique:function(){var b,a=new Array;for(this.sort(),b=0;b<this.length;b++)this[b]!=this[b+1]&&(a[a.length]=this[b]);return a},myIndexOf:function(a){if(!this||!this.length)return-1;for(var c,b=0;c=this[b];b++)if(c==a)return b;return-1},toJson:function(){var b={},c=this;return a.each(c,function(){void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""
}),b}}),a.isJson=function(b){var c=!0;try{c=a.parseJSON(b)}catch(d){return!1}return c?!0:!1}}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},f.data(),"object"==typeof c&&c),h=f.data("bjui.basedrag");h||f.data("bjui.basedrag",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c};b.prototype.init=function(){var a=this;this.options.$obj=this.$element,this.options.obj&&(this.options.$obj=this.options.obj),this.options.event?this.start(this.options.event):this.options.selector?this.$element.find(this.options.selector).on("mousedown",function(b){a.start.apply(a,[b])}):this.$element.on("mousedown",function(b){a.start.apply(a,[b])})},b.prototype.start=function(){document.onselectstart=function(){return!1};var c=this;this.options.oleft||(this.options.oleft=parseInt(this.$element.css("left"))||0),this.options.otop||(this.options.otop=parseInt(this.$element.css("top"))||0),a(document).on("mouseup.bjui.basedrag",function(a){c.stop.apply(c,[a])}).on("mousemove.bjui.basedrag",function(a){c.drag.apply(c,[a])})},b.prototype.drag=function(b){var c,d,e,f;return b||(b=window.event),c=this.options,d=c.oleft+(b.pageX||b.clientX)-c.event.pageX,e=c.otop+(b.pageY||b.clientY)-c.event.pageY,1>e&&(e=0),"horizontal"==c.move?c.minW&&d>=parseInt(this.options.$obj.css("left"))+c.minW&&c.maxW&&d<=parseInt(this.options.$obj.css("left"))+c.maxW?this.$element.css("left",d):c.scop&&c.relObj&&(d-parseInt(c.relObj.css("left"))>c.cellMinW?this.$element.css("left",d):this.$element.css("left",d)):"vertical"==c.move?this.$element.css("top",e):(f=c.selector?this.options.$obj.find(c.selector):this.options.$obj,d>=2*-f.outerWidth()/3&&e>=0&&d+f.outerWidth()/3<a(window).width()&&e+f.outerHeight()<a(window).height()&&this.$element.css({left:d,top:e})),c.drag&&c.drag.apply(this.$element,[this.$element,b,d,e]),this.preventEvent(b)},b.prototype.stop=function(b){return a(document).off("mousemove.bjui.basedrag").off("mouseup.bjui.basedrag"),this.options.stop&&this.options.stop.apply(this.$element,[this.$element,b]),this.options.event&&this.destroy(),document.onselectstart=function(){return!0},this.preventEvent(b)},b.prototype.preventEvent=function(a){return a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),!1},b.prototype.destroy=function(){this.$element.removeData("bjui.basedrag"),this.options.nounbind||this.$element.off("mousedown")},d=a.fn.basedrag,a.fn.basedrag=c,a.fn.basedrag.Constructor=b,a.fn.basedrag.noConflict=function(){return a.fn.basedrag=d,this}}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},f.data(),"object"==typeof c&&c),h=f.data("bjui.slidebar");h||f.data("bjui.slidebar",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var b,d;a(function(){a("#bjui-leftside").after("<!-- Adjust the width of Left slide -->").after(FRAG.splitBar).after(FRAG.splitBarProxy)}),b=function(b,c){this.$element=a(b),this.$bar=this.$element.find("#bjui-sidebar"),this.$sbar=this.$element.find("#bjui-sidebar-s"),this.$lock=this.$bar.find("> .toggleCollapse > .lock"),this.$navtab=a("#bjui-navtab"),this.$collapse=this.$sbar.find(".collapse"),this.$split=a("#bjui-splitBar"),this.$split2=a("#bjui-splitBarProxy"),this.isfloat=!1,this.options=c},b.prototype.lock=function(){var b=this,c=b.$bar.outerWidth()+4,d=BJUI.windowWidth-a("#bjui-sidebar").width()-6;b.faLock(),b.hoverLock(),b.$sbar.animate({left:-10},20),b.$bar.removeClass("shadown"),b.isfloat=!1,b.$navtab.animate({left:c,width:d},500,function(){a(window).trigger(BJUI.eventType.resizeGrid)}),b.$split.show()},b.prototype.unlock=function(){var b=this,c=0-b.$bar.outerWidth()-0,d=BJUI.windowWidth-6;b.faUnLock(),b.hoverUnLock(),b.$navtab.animate({left:6,width:d},400),b.$bar.animate({left:c},500,function(){b.$sbar.animate({left:0},200),b.$split.hide(),a(window).trigger(BJUI.eventType.resizeGrid)}),b.isfloat=!1},b.prototype.float=function(){var a=this;a.$sbar.animate({left:-10},200),a.$bar.addClass("shadown").animate({left:0},500),a.isfloat=!0},b.prototype.hideFloat=function(){var a=this,b=0-a.$bar.outerWidth()-0;a.$bar.animate({left:b-10},500,function(){a.$sbar.animate({left:0},100)}),a.isfloat=!1},b.prototype.hoverLock=function(){var a=this;a.$lock.hover(function(){a.tipUnLock(),a.faUnLock()},function(){a.tipLock(),a.faLock()})},b.prototype.hoverUnLock=function(){var a=this;a.$lock.hover(function(){a.tipLock(),a.faLock()},function(){a.tipUnLock(),a.faUnLock()})},b.prototype.tipLock=function(){this.$lock.tooltip("destroy").tooltip({title:"保持锁定，始终显示导航栏",container:"body"})},b.prototype.tipUnLock=function(){this.$lock.tooltip("destroy").tooltip({title:"解除锁定，自动隐藏导航栏",container:"body"})},b.prototype.faLock=function(){this.$lock.find("> i").attr("class","fa fa-lock")},b.prototype.faUnLock=function(){this.$lock.find("> i").attr("class","fa fa-unlock-alt")},b.prototype.init=function(){var b=this;BJUI.ui.showSlidebar?b.hoverLock():b.unlock(),this.$lock.off("click.bjui.slidebar").on("click.bjui.slidebar",function(){b.isfloat?b.lock():b.unlock(),BJUI.ui.showSlidebar=!BJUI.ui.showSlidebar}),this.$collapse.hover(function(){b.float(),b.$navtab.click(function(){b.isfloat&&b.hideFloat()})}),this.$split.mousedown(function(c){b.$split2.each(function(){var d=a(this);return setTimeout(function(){d.show()},100),d.css({visibility:"visible",left:b.$split.css("left")}).basedrag(a.extend(b.options,{obj:b.$bar,move:"horizontal",event:c,stop:function(){var c,d,e,f;a(this).css("visibility","hidden"),c=parseInt(a(this).css("left"))-parseInt(b.$split.css("left")),d=b.$bar.outerWidth()+c,e=parseInt(b.$navtab.css("left"))+c,f=b.$navtab.outerWidth()-c,b.$bar.css("width",d),b.$split.css("left",a(this).css("left")),b.$navtab.css({left:e,width:f})}})),!1})}),a("#bjui-hnav-navbar-box").length&&b.moveHnav()},b.prototype.moveHnav=function(){var b=a("#bjui-hnav-navbar-box"),c=b.find("> #bjui-hnav-navbar"),d=b.prev(),e=b.next();d.hover(function(){c.stop().animate({left:0},2e3,function(){d.hide()})},function(){c.stop(),b.data("hnav.move")&&e.show()}).on("click",function(){return c.stop().animate({left:0},"fast",function(){d.hide()}),!1}),e.hover(function(){c.stop().animate({left:b.width()-b.data("hnav.liw")-10},2e3,function(){e.hide()})},function(){c.stop(),"0px"!=c.css("left")&&d.show()}).on("click",function(){return c.stop().animate({left:b.width()-b.data("hnav.liw")-10},"fast",function(){e.hide()}),!1})},b.prototype.initHnav=function(){var f,g,h,i,b=this,c=b.$element.text().trim(),d=b.$element.parent(),e=a("#bjui-accordionmenu");f=d.find("> .items > ul.ztree"),g=d.find("> .items > ul.menu-items"),(f.length||g.length)&&(f.length&&(i=f),g.length&&(i=i?i.add(g):g,g.find("a").each(function(){var b=a(this),c=b.data("options");!b.data("icon.init")&&c&&"string"==typeof c&&(c=c.toObj(),c&&c.faicon&&(c.faicon=c.faicon.trim(),c.faicon.startsWith("fa-")&&(c.faicon=c.faicon.substr(3)),b.prepend('<i class="fa fa-'+c.faicon+'"></i>').data("icon.init",!0).attr("title",b.text())))})),e.empty(),i.each(function(b){var f,g,i,d=a(this),j=d.data("faicon"),l=(d.data("faiconClose"),j?j:"dot-circle-o");d.data("tit")&&(c=d.data("tit")),g=b?"collapsed":"",i=b?"":" in",f=FRAG.slidePanel.replaceAll("#id#","bjui-collapse"+b).replaceAll("#title#",c).replaceAll("#righticon#",'<i class="fa fa-angle-down"></i>').replaceAll("#class#",g).replaceAll("#bodyclass#",i),f=l?f.replaceAll("#icon#",'<i class="fa fa-'+l+'"></i>'):f.replaceAll("#icon#",""),h=a(f),h.find("> .panel-collapse > .panel-body").append(d.removeAttr("data-noinit")),e.append(h),b||h.collapse("show")}),a("#bjui-sidebar").initui(),d.addClass("active").data("bjui.slidebar.hnav.panels",e.find("> .panel")).siblings().removeClass("active"))},d=a.fn.slidebar,a.fn.slidebar=c,a.fn.slidebar.Constructor=b,a.fn.basedrag.noConflict=function(){return a.fn.slidebar=d,this},a(document).one(BJUI.eventType.afterInitUI,function(){a("#bjui-leftside").slidebar({minW:150,maxW:700})}),a(document).on("click.bjui.slidebar.data-api",'[data-toggle="slidebar"]',function(b){var d=a(this).parent(),e=a("#bjui-accordionmenu"),f=d.data("bjui.slidebar.hnav.panels");e.find("> .panel").detach(),f&&f.length?(e.append(f),d.addClass("active").siblings().removeClass("active")):c.call(a(this),"initHnav"),b.preventDefault()})}(jQuery),+function(a){"use strict";function f(b){var c=arguments,d=b;return this.each(function(){var f=a(this),g=a.extend({},e.DEFAULTS,f.data(),"object"==typeof b&&b),h=f.data("bjui.contextmenu");h||f.data("bjui.contextmenu",h=new e(this,g)),"string"==typeof d&&a.isFunction(h[d])?([].shift.apply(c),c?h[d].apply(h,c):h[d]()):h.init()})}var b,c,d,e,g;a(function(){var e=function(){b=a('<div id="bjui-contextmenu"></div>').hide(),c=a('<div id="bjui-contextmenuShadow"></div>').hide(),d=[],a("body").append("<!-- contextmenu -->").append(b).append(c)};e()}),e=function(b,c){this.$element=a(b),this.options=c},e.DEFAULTS={id:void 0,shadow:!0,bindings:{},ctrSub:null},e.prototype.init=function(){var c,a=this,b=this.options;b.id&&(d.push({id:b.id,shadow:b.shadow,bindings:b.bindings||{},ctrSub:b.ctrSub}),c=d.length-1,this.$element.on("contextmenu",function(d){return a.display(c,this,d,b),!1}))},e.prototype.display=function(e,f,g){var m,n,i=this,j=d[e],k=BJUI.regional[j.id],l=FRAG[j.id];a.each(k,function(a){l=l.replace("#"+a+"#",k[a])}),b.html(l),a.each(j.bindings,function(c,d){a('[rel="'+c+'"]',b).on("click",function(){i.hide(),d(a(f),a("#bjui-"+j.id))})}),m=g.pageX,n=g.pageY,a(window).width()<m+b.width()&&(m-=b.width()),a(window).height()<n+b.height()&&(n-=b.height()),b.css({left:m,top:n}).show(),j.shadow&&c.css({width:b.width(),height:b.height(),left:m+3,top:n+3}).show(),a(document).one("click",i.hide),a.isFunction(j.ctrSub)&&j.ctrSub(a(f),a("#bjui-"+j.id))},e.prototype.hide=function(){b.hide(),c.hide()},e.prototype.show=function(b){var c=this;b.items&&b.items.length&&c.$element.on("contextmenu",function(d){var e=!0;return b.exclude&&c.$element.find(b.exclude).each(function(){return this==d.target||a(this).find(d.target).length?(e=!1,void 0):void 0}),e?(c.custom(b.items,d),!1):(d.stopPropagation(),!e)})},e.prototype.custom=function(d,e){var f,g,i,h,j,k;b.empty().html("<ul></ul>"),f=this,g=f.options,h=b.find("> ul"),a.each(d,function(b,c){var d="";c.icon&&(d='<i class="fa fa-'+c.icon+'"></i>'),"diver"==c.title?i=a('<li class="diver"></li>'):(i=a('<li><span class="icon">'+d+'</span><span class="title">'+c.title+"</span></li>"),c.func&&"string"==typeof c.func&&(c.func=c.func.toFunc()),c.func&&i.on("click",function(){f.hide(),c.func(f.$element,i)})),i.appendTo(h)}),j=e.pageX,k=e.pageY,a(window).width()<j+b.width()&&(j-=b.width()),a(window).height()<k+b.height()&&(k-=b.height()),b.css({left:j,top:k}).show(),g.shadow&&c.css({width:b.width(),height:b.height(),left:j+3,top:k+3}).show(),a(document).one("click",f.hide)},g=a.fn.contextmenu,a.fn.contextmenu=f,a.fn.contextmenu.Constructor=e,a.fn.contextmenu.noConflict=function(){return a.fn.contextmenu=g,this}}(jQuery),+function(a){"use strict";function p(b){var c=arguments,d=b,e="bjui.navtab",f=a("body"),g=f.data(e)||{};return this.each(function(){var k,i=(a(this),a.extend({},o.DEFAULTS,"object"==typeof b&&b)),j=i&&i.id;if(j){if(!j.isNormalID())return BJUI.debug("Navtab Plugin: ID ["+j+"] "+BJUI.regional.idChecked),void 0}else j=g.current?g.current.options.id:BJUI.ui.overwriteHomeTab?"main":"navtab";i.id=j,k=g&&g[j],k?"object"==typeof b&&b&&a.extend(k.options,b):g[j]=k=new o(i),f.data(e,g),"string"==typeof d&&a.isFunction(k[d])?([].shift.apply(c),c?k[d].apply(k,c):k[d]()):k.openTab()})}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,q;a(function(){var c=function(){b=0,e=a("#bjui-navtab"),f=e.find(".navtab-tab"),g=e.find(".navtab-panel"),h=e.find(".tabsLeft"),i=e.find(".tabsRight"),j=e.find(".tabsMore"),k=e.find(".tabsMoreList"),l=f.find("li:first"),m=k.find("li:first"),h.click(function(){a(this).navtab("scrollPrev")}),i.click(function(){a(this).navtab("scrollNext")}),j.click(function(){k.show()}),a(document).on("click.bjui.navtab.switchtab",function(b){var c="I"==b.target.tagName?a(b.target).parent():a(b.target);j[0]!=c[0]&&k.hide()});var c,d;l.navtab("contextmenu",l).click(function(){a(this).hasClass("active")||a(this).navtab("switchTab","main")}).find("> a > span").html(function(a,b){return c=b.replace("#maintab#",BJUI.regional.maintab)}),d=a.extend({},o.DEFAULTS,l.data(),{id:"main",title:c}),l.data("options",a.extend({},d)),l.attr("data-url")&&a(document).one(BJUI.eventType.initUI,function(){l.removeAttr("data-url").navtab("reload",d)}),setTimeout(function(){m.trigger("click")},100),m.click(function(){a(this).hasClass("active")?k.hide():a(this).navtab("switchTab","main")}).find("> a").html(function(a,b){return b.replace("#maintab#",BJUI.regional.maintab)})};c()}),o=function(a){this.options=a,this.tools=this.TOOLS()},o.DEFAULTS={id:null,title:"New tab",url:null,type:"GET",data:{},loadingmask:!0,fresh:!1,autorefresh:!1,onLoad:null,beforeClose:null,onClose:null},o.prototype.TOOLS=function(){var j=this,l={getDefaults:function(){return o.DEFAULTS},getTabs:function(){return f.find("> li")},getPanels:function(){return g.find("> div")},getMoreLi:function(){return k.find("> li")},getTab:function(a){var b=this.indexTabId(a);return b>=0?this.getTabs().eq(b):void 0},getPanel:function(a){var b=this.indexTabId(a);return b>=0?this.getPanels().eq(b):void 0},getTabsW:function(a,b){return this.tabsW(this.getTabs().slice(a,b))},tabsW:function(b){var c=0;return b.each(function(){c+=a(this).outerWidth(!0)}),c},indexTabId:function(b){var c=-1;return b?(this.getTabs().each(function(d){return a(this).data("options").id==b?(c=d,!1):void 0}),c):c},getLeft:function(){return f.position().left},getScrollBarW:function(){return e.width()-55},visibleStart:function(){var b=this.getTabs(),c=this.getLeft(),d=0,e=0;return b.each(function(b){return d+c>=0?(e=b,!1):(d+=a(this).outerWidth(!0),void 0)}),e},visibleEnd:function(){var b=this,c=this.getTabs(),d=this.getLeft(),e=0,f=c.length;return c.each(function(c){return e+=a(this).outerWidth(!0),e+d>b.getScrollBarW()?(f=c,!1):void 0}),f},scrollPrev:function(){var a=this.visibleStart();a>0&&this.scrollTab(-this.getTabsW(0,a-1))},scrollNext:function(){var a=this.visibleEnd();a<this.getTabs().size()&&this.scrollTab(-this.getTabsW(0,a+1)+this.getScrollBarW())},scrollTab:function(a){f.animate({left:a},150,function(){j.tools.ctrlScrollBtn()})},scrollCurrent:function(){var a=this.tabsW(this.getTabs()),c=this.getScrollBarW();c>=a?this.scrollTab(0):this.getLeft()<c-a?this.scrollTab(c-a):b<this.visibleStart()?this.scrollTab(-this.getTabsW(0,b)):b>=this.visibleEnd()&&this.scrollTab(c-this.getTabs().eq(b).outerWidth(!0)-this.getTabsW(0,b))},ctrlScrollBtn:function(){var a=this.tabsW(this.getTabs());this.getScrollBarW()>a?(h.hide(),i.hide(),f.parent().removeClass("tabsPageHeaderMargin")):(h.show().removeClass("tabsLeftDisabled"),i.show().removeClass("tabsRightDisabled"),f.parent().addClass("tabsPageHeaderMargin"),this.getLeft()>=0?h.addClass("tabsLeftDisabled"):this.getLeft()<=this.getScrollBarW()-a&&i.addClass("tabsRightDisabled"))},switchTab:function(e){var l,f=this.getTabs().removeClass("active").eq(e).addClass("active"),g=this.getPanels(),h=g.eq(e),i=j.options.onSwitch?j.options.onSwitch.toFunc():null,k=a(FRAG.maskBackground);g.css({top:"-10000000px"}),f.data("reloadFlag")?(h.animate({top:0}),j.refresh(f.data("options").id)):h.find(".bjui-ajax-mask").length?h.css({top:0}):(h.css({top:0}).append(k),k.fadeOut("normal",function(){a(this).remove()})),this.getMoreLi().removeClass("active").eq(e).addClass("active"),b=e,this.scrollCurrent(),c=f,a.CurrentNavtab=d=h,i&&i.apply(j),l=a("body").data("bjui.navtab"),j.options.id||a.extend(j.options,f.data("options")),l.current=j,h.trigger("bjui.navtab.switch")},closeTab:function(c,d){var m,o,e=this.getTabs().eq(c),f=this.getMoreLi().eq(c),g=this.getPanels().eq(c),h=e.data("options"),i=h.beforeClose?h.beforeClose.toFunc():null,k=h.onClose?h.onClose.toFunc():null,l=!0;return i&&(l=i.apply(j,[g])),l?(e.remove(),f.remove(),g.trigger(BJUI.eventType.beforeCloseNavtab).remove(),n&&clearInterval(n),k&&k.apply(j),b>=c&&b--,d&&(m=this.indexTabId(d),m>0&&(b=m)),o=a("body").data("bjui.navtab"),o[h.id]&&delete o[h.id],this.scrollCurrent(),this.switchTab(b),void 0):(j.tools.switchTab(c),void 0)},closeOtherTab:function(c){c=c||b,this.getTabs().each(function(b){b>0&&c!=b&&a(this).find("> .close").trigger("click")})},loadUrlCallback:function(a){a.find(":button.btn-close").click(function(){j.closeCurrentTab()})},updateTit:function(a,b){this.getTabs().eq(a).find("> a").attr("title",b).find("> span").html(b),this.getMoreLi().eq(a).find("> a").attr("title",b).html(b)},reload:function(a,b){var c,d;b=b||a.data("reloadFlag"),c=a.data("options"),b&&(a.data("reloadFlag",!1),d=j.tools.getPanel(c.id),a.hasClass("external")?j.openExternal(c.url,d,c.data):j.tools.reloadTab(d,c))},reloadTab:function(a,b){var c=b.onLoad?b.onLoad.toFunc():null,d=b.autorefresh&&(isNaN(String(b.autorefresh))?15:b.autorefresh);a.trigger(BJUI.eventType.beforeLoadNavtab).ajaxUrl({type:b.type||"GET",url:b.url,data:b.data||{},loadingmask:b.loadingmask,callback:function(){j.tools.loadUrlCallback(a),c&&c.apply(j,[a]),n&&clearInterval(n),d&&(n=setInterval(function(){a.navtab("refresh")},1e3*d)),BJUI.ui.clientPaging&&a.data("bjui.clientPaging")&&a.pagination("setPagingAndOrderby",a)}})}};return l},o.prototype.contextmenu=function(a){var c=this;a.contextmenu({id:"navtabCM",bindings:{reload:function(a){a.data("options").url&&c.refresh(a.data("options").id)},closeCurrent:function(a){var d=a.data("options").id;d?c.closeTab(d):c.closeCurrentTab()},closeOther:function(a){if(a.index()){var e=c.tools.indexTabId(a.data("options").id);c.tools.closeOtherTab(e>0?e:b)}else c.closeAllTab()},closeAll:function(){c.closeAllTab()}},ctrSub:function(a,b){var d=b.find('[rel="reload"]'),e=b.find('[rel="closeCurrent"]');b.find('[rel="closeOther"]'),b.find('[rel="closeAll"]'),c.tools.getTabs(),a.index()||(e.addClass("disabled"),a.data("options").url||d.addClass("disabled"))}})},o.prototype.openTab=function(){var h,i,j,l,m,n,c=this,d=this.options,e=this.tools;return!d.url&&d.href&&(d.url=d.href),d.url?(d.url=decodeURI(d.url).replacePlh(),d.url.isFinishedTm()?(d.url=encodeURI(d.url),h=d.id?e.indexTabId(d.id):b,h>=0?(i=e.getTabs().eq(h),j=e.getPanels().eq(h),l=i.data("options"),d.fresh||d.url!=l.url?c.reload(d):d.title!=l.title&&(l.title=d.title,e.updateTit(h,d.title)),b=h,"main"==d.id&&this.contextmenu(i)):(m='<li><a href="javascript:" title="#title#"><span>#title#</span></a><span class="close">&times;</span></li>',i=a(m.replaceAll("#title#",d.title)),j=a('<div class="navtabPage unitBox"></div>'),n=a('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",d.title)),i.appendTo(f),j.appendTo(g),n.appendTo(k),i.data("options",a.extend({},d)),d.external||d.url&&d.url.isExternalUrl()?(i.addClass("external"),this.openExternal(d.url,j,d.data)):(i.removeClass("external"),e.reloadTab(j,d)),b=e.getTabs().length-1,this.contextmenu(i),i.on("click",function(){a(this).hasClass("active")||c.switchTab(d.id)}).on("click.bjui.navtab.close",".close",function(){c.closeTab(d.id)}).on("mousedown.bjui.navtab.drag","a",function(b){i.data("bjui.navtab.drag",!0),setTimeout(a.proxy(function(){i.data("bjui.navtab.drag")&&c.drag(b,i,j,n)},c),150),b.preventDefault()}).on("mouseup.bjui.navtab.drag","a",function(){i.data("bjui.navtab.drag",!1)}),n.on("click",function(){c.switchTab(d.id)})),e.switchTab(b),e.scrollCurrent(),void 0):(a("body").alertmsg("error",d.warn||BJUI.regional.plhmsg),BJUI.debug("Navtab Plugin: The new navtab's url is incorrect, url: "+d.url),void 0)):(BJUI.debug("Navtab Plugin: Error trying to open a navtab, url is undefined!"),void 0)},o.prototype.closeTab=function(a){var b=this.tools.indexTabId(a);b>0&&this.tools.closeTab(b)},o.prototype.closeCurrentTab=function(a){b>0&&this.tools.closeTab(b,a)},o.prototype.closeAllTab=function(){this.tools.getTabs().find("> .close").trigger("click")},o.prototype.reloadFlag=function(a){var d,e,c=a.split(",");for(d=0;d<c.length;d++)e=this.tools.getTab(c[d].trim()),e&&(this.tools.indexTabId(c[d])==b?this.tools.reload(e,!0):e.data("reloadFlag",!0))},o.prototype.switchTab=function(a){var b=this.tools.indexTabId(a);this.tools.switchTab(b)},o.prototype.scrollPrev=function(){this.tools.scrollPrev()},o.prototype.scrollNext=function(){this.tools.scrollNext()},o.prototype.refresh=function(a){var b,d;b=a?"string"==typeof a?this.tools.getTab(a):a:c,b&&b.length&&(d=this.tools.getPanel(b.data("options").id),d.removeData("bjui.clientPaging"),this.reload(b.data("options")))},o.prototype.reload=function(c){var g,h,d=this,e=a.extend({},"object"==typeof c&&c),f=e.id?this.tools.getTab(e.id):this.tools.getTabs().eq(b);f&&(g=f.data("options"),h=function(){e.title&&e.title!=g.title&&d.tools.updateTit(f.index(),e.title),f.data("options",a.extend({},g,e)),d.tools.reload(f,!0)},g.reloadWarn?a("body").alertmsg("confirm",g.reloadWarn,{okCall:function(){h()}}):h())},o.prototype.reloadForm=function(b,e){var j,k,l,m,n,f=a.extend({},"object"==typeof e&&e),g=f.id?this.tools.getTab(f.id):c,h=f.id?this.tools.getPanel(f.id):d;if(g&&h){if(g.data("options"),j={},k={},l=f.form||h.find("#pagerForm"),l&&l.length)if(f.type=f.type||l.attr("method")||"POST",f.url=f.url||l.attr("action"),k=l.serializeJson(),b){m=BJUI.pageInfo;for(n in m)j[m[n]]=k[m[n]]}else j=k;f.data=a.extend({},f.data||{},j),g.hasClass("external")?this.openExternal(f.url,h,f.data):this.tools.reloadTab(h,f)}},o.prototype.getCurrentPanel=function(){return this.tools.getPanels().eq(b)},o.prototype.checkTimeout=function(){var a=JSON.parse(d.html());a&&a[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrentTab()},o.prototype.openExternal=function(b,c,d){var e=c.closest(".navtab-panel").height();d&&!a.isEmptyObject(d)&&(b.indexOf("?")?b+="&":"?",b+=a.param(d)),c.html(FRAG.externalFrag.replaceAll("{url}",b).replaceAll("{height}",e+"px"))},o.prototype.drag=function(b,c,d,e){var s,g=this,h=g.tools.getTabs(),i=g.tools.getPanels(),j=g.tools.getMoreLi(),k=f.next(".bjui-navtab-drag"),n=(c.prev(),c.next(),c.index()),p=(c.width(),c.position().left),q=[],r=[];h.length<=2||(k.length||(k=a('<div class="bjui-navtab-drag" style="position:absolute; top:0; left:1px; width:2px; height:25px; background:#ff6600; display:none;"></div>'),k.insertAfter(f)),k.css("left",p-2),f.find("> li").each(function(){q.push(a(this).position().left)}),c.find("> a").basedrag({move:"horizontal",oleft:p,drag:function(b,d,e){c.addClass("navtab-drag"),r=[e],a.merge(r,q),r.sort(function(a,b){return a-b}),s=a.inArray(e,r),s||(s=1),s==h.length?k.css("left",q[s-1]-2+h.last().width()):k.css("left",q[s]-2),k.show()},stop:function(){c.removeClass("navtab-drag"),k.hide(),n!=s&&(s==h.length?n!=h.length-1&&(c.insertAfter(h.eq(s-1)),d.insertAfter(i.eq(s-1)),e.insertAfter(j.eq(s-1))):(c.insertBefore(h.eq(s)),d.insertBefore(i.eq(s)),e.insertBefore(j.eq(s))))},event:b,nounbind:!0}))},q=a.fn.navtab,a.fn.navtab=p,a.fn.navtab.Constructor=o,a.fn.navtab.noConflict=function(){return a.fn.navtab=q,this},BJUI.navtab=function(){p.apply(a("body"),arguments)},a(document).on("click.bjui.navtab.data-api",'[data-toggle="navtab"]',function(b){var c=a(this),d=c.attr("href"),e=c.data(),f=e.options;f&&("string"==typeof f&&(f=f.toObj()),"object"==typeof f&&a.extend(e,f)),e.title||(e.title=c.text()),d&&!e.url&&(e.url=d),p.call(c,e),b.preventDefault()})}(jQuery),+function(a){"use strict";function g(b){var c=arguments,d=b,e="bjui.dialog",g=a("body"),h=g.data(e)||{};return this.each(function(){var l,j=(a(this),a.extend({},f.DEFAULTS,"object"==typeof b&&b)),k=j&&j.id;if(k){if(!k.isNormalID())return BJUI.debug("Dialog Plugin: ID ["+k+"] "+BJUI.regional.idChecked),void 0}else k=h.current?h.current.options.id:"dialog";j.id=k,l=h&&h[k],l?"object"==typeof b&&b&&a.extend(l.options,b):h[k]=l=new f(j),g.data(e,h),"string"==typeof d&&a.isFunction(l[d])?([].shift.apply(c),c?l[d].apply(l,c):l[d]()):l.open()})}var b,c,d,e,f,h;a(function(){var c=function(){b=a("#bjui-resizable"),d="dialogShadow",e=f.ZINDEX,a("body").append("<!-- dialog resizable -->").append(FRAG.resizable)};c()}),f=function(b){this.$element=a("body"),this.options=b,this.tools=this.TOOLS()},f.DEFAULTS={id:null,title:"New Dialog",url:null,type:"GET",data:{},loadingmask:!0,width:500,height:300,minW:65,minH:40,max:!1,mask:!1,resizable:!0,drawable:!0,maxable:!0,minable:!0,fresh:!1,onLoad:null,beforeClose:null,onClose:null},f.ZINDEX=30,f.prototype.TOOLS=function(){var b=this,c={getDefaults:function(){return f.DEFAULTS},init:function(c){var e=b.options.width>b.options.minW?b.options.width:b.options.minW,f=b.options.height>b.options.minH?b.options.height:b.options.minH,g=a(window).width(),h=a(window).height(),i=b.options.max?0:(h-f)/3;e>g&&(e=g),f>h&&(f=h),c.height(f).width(e).show().css({left:(g-e)/2,top:0,opacity:.1}).animate({top:i>0?i:0,opacity:1}).addClass(d).find("> .dialogContent").height(f-a("> .dialogHeader",c).outerHeight()-6),a("body").find("> .bjui-dialog-container").not(c).removeClass(d)},reload:function(c,d){var f,h,e=c.find("> .dialogContent"),g=d&&d.data;d=d||c.data("options"),f=d.onLoad?d.onLoad.toFunc():null,c.trigger(BJUI.eventType.beforeLoadDialog),d.url?(g&&("string"==typeof g&&(g=g.trim().startsWith("{")?g.toObj():g.toFunc()),"function"==typeof g&&(g=g.apply())),e.ajaxUrl({type:d.type||"GET",url:d.url,data:g||{},loadingmask:d.loadingmask,callback:function(){f&&f.apply(b,[c]),BJUI.ui.clientPaging&&c.data("bjui.clientPaging")&&c.pagination("setPagingAndOrderby",c)}})):(d.html?(h=d.html,a.isFunction(h.toFunc())&&(h=h.toFunc())):d.target&&(h=a(d.target).html()||c.data("bjui.dialog.target"),a(d.target).empty(),c.data("bjui.dialog.target",h)),e.trigger(BJUI.eventType.beforeAjaxLoad).html(h).initui(),f&&f.apply(b,[c]))},resizeContent:function(b,c,d){var e=b.find("> .dialogContent");e.css({width:c-12,height:d-b.find("> .dialogHeader").outerHeight()-6}).resizePageH(),a(window).trigger(BJUI.eventType.resizeGrid)}};return c},f.prototype.open=function(){var j,k,l,b=this,d=b.options,f=a("body"),g=f.data("bjui.dialog"),h=g[d.id],i=h&&h.dialog;if(d.target||a(d.target).length||d.html)d.url=void 0;else{if(!d.url&&d.href&&(d.url=d.href),!d.url)return BJUI.debug("Dialog Plugin: Error trying to open a dialog, url is undefined!"),void 0;if(d.url=decodeURI(d.url).replacePlh(),!d.url.isFinishedTm())return BJUI.alertmsg("error",d.warn||BJUI.regional.plhmsg),BJUI.debug("Dialog Plugin: The new dialog's url is incorrect, url: "+d.url),void 0;d.url=encodeURI(d.url)}i?(j=i.data("options"),this.switchDialog(i),i.is(":hidden")&&i.show(),(d.fresh||d.url!=j.url)&&b.reload(d)):(k=BJUI.regional.dialog,l=FRAG.dialog.replace("#close#",k.close).replace("#maximize#",k.maximize).replace("#restore#",k.restore).replace("#minimize#",k.minimize).replace("#title#",k.title),i=a(l).data("options",a.extend({},d)).css("z-index",++e).hide().appendTo(f),i.find("> .dialogHeader > h1 > span.title").html(d.title),this.tools.init(i),d.maxable?i.find("a.maximize").show():i.find("a.maximize").hide(),d.minable?i.find("a.minimize").show():i.find("a.minimize").hide(),d.max&&b.maxsize(i),d.mask?this.addMask(i):d.minable&&a.fn.taskbar&&this.$element.taskbar({id:d.id,title:d.title}),i.on("click",function(d){a(d.target).data("bjui.dialog")||c&&c[0]!=i[0]&&b.switchDialog(i)}).on("click",".btn-close",function(a){b.close(i),a.preventDefault()}).on("click",".dialogHeader > a",function(c){var d=a(this);d.hasClass("close")&&b.close(i),d.hasClass("minimize")&&b.minimize(i),d.hasClass("maximize")&&(b.switchDialog(i),b.maxsize(i)),d.hasClass("restore")&&b.restore(i),c.preventDefault(),c.stopPropagation()}).on("dblclick",".dialogHeader > h1",function(){d.maxable&&(i.find("> .dialogHeader > a.restore").is(":hidden")?i.find("a.maximize").trigger("click"):i.find("> .dialogHeader > a.restore").trigger("click"))}).on("mousedown.bjui.dialog.drag",".dialogHeader > h1",function(c){b.switchDialog(i),d.drawable&&!i.data("max")&&(i.data("bjui.dialog.task",!0),setTimeout(a.proxy(function(){i.data("bjui.dialog.task")&&b.drag(c,i)},b),150),c.preventDefault())}).on("mouseup.bjui.dialog.drag",".dialogHeader > h1",function(){i.data("bjui.dialog.task",!1)}).on("mousedown.bjui.dialog.resize",'div[class^="resizable"]',function(c){if(!d.drawable||i.data("max"))return!1;if(!d.resizable)return!1;var e=a(this);b.switchDialog(i),b.resizeInit(c,a("#bjui-resizable"),i,e),e.show(),c.preventDefault()}).on("mouseup.bjui.dialog.resize",'div[class^="resizable"]',function(a){a.preventDefault()}),h.dialog=i,this.tools.reload(i,d)),a.CurrentDialog=c=i,g.current=this},f.prototype.addMask=function(b){var c=b.data("bjui.dialog.mask");b.wrap('<div style="z-index:'+e+'" class="bjui-dialog-wrap"></div>'),b.find("> .dialogHeader > a.minimize").hide(),c&&c.length||(c=a(FRAG.dialogMask),c.css("z-index",1).show().insertBefore(b),b.data("bjui.dialog.mask",c))},f.prototype.refresh=function(b){var d,e,f,g;if(b&&"string"==typeof b)for(d=b.split(","),e=a("body").data("bjui.dialog"),f=0;f<d.length;f++)g=e[d[f].trim()].dialog,g&&(g.removeData("bjui.clientPaging"),this.tools.reload(g));else c&&(c.removeData("bjui.clientPaging"),this.tools.reload(c))},f.prototype.reload=function(b){var g,h,c=this,d=a.extend({},"object"==typeof b&&b),e=a("body").data("bjui.dialog"),f=d.id&&e[d.id]&&e[d.id].dialog||c.getCurrent();f&&f.length&&(g=f.data("options"),d=a.extend({},g,d),h=function(){var b=f.find("> .dialogContent");d.width!=g.width&&(d.max?f.animate({width:d.width},"normal",function(){b.width(d.width)}):(f.width(d.width),b.width(d.width))),d.height!=g.height&&(d.max?f.animate({height:d.height},"normal",function(){b.height(d.height-f.find("> .dialogHeader").outerHeight()-6).resizePageH()}):(f.height(d.height),b.height(d.height-f.find("> .dialogHeader").outerHeight()-6))),d.maxable!=g.maxable&&(d.maxable?f.find("a.maximize").show():f.find("a.maximize").hide()),d.minable!=g.minable&&(d.minable?f.find("a.minimize").show():f.find("a.minimize").hide()),d.max!=g.max&&d.max&&setTimeout(c.maxsize(f),10),d.mask!=g.mask&&(d.mask?(c.addMask(f),a.fn.taskbar&&c.$element.taskbar("closeDialog",d.id)):d.minable&&a.fn.taskbar&&c.$element.taskbar({id:d.id,title:d.title})),d.title!=g.title&&(f.find("> .dialogHeader > h1 > span.title").html(d.title),f.taskbar("changeTitle",d.id,d.title)),f.data("options",a.extend({},d)),c.tools.reload(f,g)},g.reloadWarn?f.alertmsg("confirm",g.reloadWarn,{okCall:function(){h()}}):h())},f.prototype.reloadForm=function(b,d){var g,i,j,k,l,m,e=a.extend({},"object"==typeof d&&d),f=a("body").data("bjui.dialog");if(e.id?f&&f[e.id]&&(g=f[e.id].dialog):g=c,g){if(g.data("options"),i={},j={},k=e.form||g.find("#pagerForm"),k&&k.length)if(e.type=e.type||k.attr("method")||"POST",e.url=e.url||k.attr("action"),j=k.serializeJson(),b){l=BJUI.pageInfo;for(m in l)i[l[m]]=j[l[m]]}else i=j;e.data=a.extend({},e.data||{},i),this.tools.reload(g,e)}},f.prototype.getCurrent=function(){return c},f.prototype.switchDialog=function(b){var f,g,e=b.css("z-index");if(c&&c!=b){if(c.data("options").mask)return;f=c.css("z-index"),g=a("body").data("bjui.dialog"),c.css("z-index",e),b.css("z-index",f),a.CurrentDialog=c=b,g.current=this,a.fn.taskbar&&this.$element.taskbar("switchTask",b.data("options").id)}b.addClass(d),a("body").find("> .bjui-dialog-container").not(b).removeClass(d)},f.prototype.close=function(b){var d=this,g=a("body").data("bjui.dialog"),h="string"==typeof b?g[b].dialog:b,i=h.data("bjui.dialog.mask"),j=h.data("options"),k=h.data("bjui.dialog.target"),l=j.beforeClose?j.beforeClose.toFunc():null,m=j.onClose?j.onClose.toFunc():null,n=!0;if(h&&j){if(l&&(n=l.apply(d,[h])),!n)return d.switchDialog(h),void 0;j.target&&k&&a(j.target).html(k),i&&i.length?(i.remove(),h.unwrap()):a.fn.taskbar&&this.$element.taskbar("closeDialog",j.id),h.animate({top:-h.outerHeight(),opacity:.1},"normal",function(){delete g[j.id],h.trigger(BJUI.eventType.beforeCloseDialog).remove(),m&&m.apply(d),a.CurrentDialog=c=null;
    var b=a("body").find(".bjui-dialog-container"),i=null;b.length?i=d.$element.getMaxIndexObj(b):e=f.ZINDEX,i&&i.is(":visible")&&(a.CurrentDialog=c=i,d.switchDialog(i))})}},f.prototype.closeCurrent=function(){this.close(c)},f.prototype.checkTimeout=function(){var a=c.find("> .dialogContent"),b=JSON.parse(a.html());b&&b[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrent()},f.prototype.maxsize=function(b){b.data("original",{top:b.css("top"),left:b.css("left"),width:b.css("width"),height:b.css("height")}).data("max",!0),b.find("> .dialogHeader > a.maximize").hide(),b.find("> .dialogHeader > a.restore").show();var c=a(window).width(),d=a(window).height()-a("#bjui-taskbar").height()-1;b.css({top:0,left:0,width:c,height:d}),this.tools.resizeContent(b,c,d)},f.prototype.restore=function(a){var b=a.data("original"),c=parseInt(b.width),d=parseInt(b.height);a.css({top:b.top,left:b.left,width:c,height:d}),this.tools.resizeContent(a,c,d),a.find("> .dialogHeader > a.maximize").show(),a.find("> .dialogHeader > a.restore").hide(),a.data("max",!1)},f.prototype.minimize=function(b){b.hide(),a.fn.taskbar&&this.$element.taskbar("minimize",b);var c=a("body").find(".bjui-dialog-container:visible"),d=null;c.length&&(d=this.$element.getMaxIndexObj(c)),d&&this.switchDialog(d)},f.prototype.drag=function(b,c){a("#bjui-dialogProxy"),c.find("> .dialogContent").css("opacity",".3"),c.basedrag({selector:"> .dialogHeader",stop:function(){c.css({left:c.css("left"),top:c.css("top")}).find("> .dialogContent").css("opacity",1)},event:b,nounbind:!0})},f.prototype.resizeDialog=function(b,c,d){var e,j,f=parseInt(b.css("left")),g=parseInt(b.css("top")),h=parseInt(b.css("height")),i=parseInt(b.css("width"));e="n"==d||"nw"==d?parseInt(c.css("top"))-g:h-parseInt(c.css("height")),0>g&&(g=0),c.css({top:g,left:f,width:i+2,height:h+1}).find("> .dialogContent").css("width",i-10),"w"!=d&&"e"!=d&&(j=c.find("> .dialogContent"),j.css({height:h-c.find("> .dialogHeader").outerHeight()-6}).resizePageH()),a(window).trigger(BJUI.eventType.resizeGrid)},f.prototype.resizeInit=function(b,c,d,e){var f=this,g=e.attr("tar");a("body").css("cursor",g+"-resize"),c.css({top:d.css("top"),left:d.css("left"),height:d.outerHeight(),width:d.css("width")}).show(),this.options.dragCurrent||(this.options.dragCurrent={$resizable:c,$dialog:d,target:g,oleft:parseInt(c.css("left"))||0,owidth:parseInt(c.css("width"))||0,otop:parseInt(c.css("top"))||0,oheight:parseInt(c.css("height"))||0,ox:b.pageX||b.screenX,oy:b.pageY||b.clientY},a(document).on("mouseup.bjui.dialog.resize",a.proxy(f.resizeStop,f)),a(document).on("mousemove.bjui.dialog.resize",a.proxy(f.resizeStart,f)))},f.prototype.resizeStart=function(b){var d,e,f,g,h,i,c=this.options.dragCurrent;c&&(b||(b=window.event),d=(b.pageX||b.screenX)-c.ox,e=(b.pageY||b.clientY)-c.oy,f=c.$dialog.data("bjui.dialog.mask"),(f&&f.length||!((b.pageY||b.clientY)<=0||(b.pageY||b.clientY)>=a(window).height()-c.$dialog.find("> .dialogHeader").outerHeight()))&&(g=c.target,h=c.owidth,i=c.oheight,"n"!=g&&"s"!=g&&(h+=g.indexOf("w")>=0?-d:d),h>=this.options.minW&&(g.indexOf("w")>=0&&c.$resizable.css("left",c.oleft+d),"n"!=g&&"s"!=g&&c.$resizable.css("width",h)),"w"!=g&&"e"!=g&&(i+=g.indexOf("n")>=0?-e:e),i>=this.options.minH&&(g.indexOf("n")>=0&&c.$resizable.css("top",c.otop+e),"w"!=g&&"e"!=g&&c.$resizable.css("height",i))))},f.prototype.resizeStop=function(){var c=this.options.dragCurrent;return c?(a(document).off("mouseup.bjui.dialog.resize").off("mousemove.bjui.dialog.resize"),this.options.dragCurrent=null,this.resizeDialog(c.$resizable,c.$dialog,c.target),a("body").css("cursor",""),c.$resizable.hide(),void 0):!1},h=a.fn.dialog,a.fn.dialog=g,a.fn.dialog.Constructor=f,a.fn.dialog.noConflict=function(){return a.fn.dialog=h,this},BJUI.dialog=function(){g.apply(a("body"),arguments)},a(document).on("click.bjui.dialog.data-api",'[data-toggle="dialog"]',function(b){var c=a(this),d=c.attr("href"),e=c.data(),f=e.options;f&&("string"==typeof f&&(f=f.toObj()),"object"==typeof f&&a.extend(e,f)),e.title||(e.title=c.text()),d&&!e.url&&(e.url=d),g.call(c,e),b.preventDefault()})}(jQuery),+function(a){"use strict";function l(b){var c=arguments,d=b;return this.each(function(){var e=a(this),f=a.extend({},k.DEFAULTS,e.data(),"object"==typeof b&&b),g=e.data("bjui.taskbar");g?g.options.id!=f.id&&e.data("bjui.taskbar",g=new k(this,f)):e.data("bjui.taskbar",g=new k(this,f)),"string"==typeof d&&a.isFunction(g[d])?([].shift.apply(c),c?g[d].apply(g,c):g[d]()):g.init()})}var b,c,d,e,f,g,h,i,j,k,m;a(function(){var k=function(){b=a("#bjui-resizable"),c=a(FRAG.taskbar),d=c.find(".taskbarContent"),e=d.find("> ul"),f=c.find(".taskbarLeft"),g=c.find(".taskbarRight"),h="disabled",i="selected",j="taskbarMargin",a("body").append("<!-- dialog task bar -->").append(c),f.click(function(){a(this).taskbar("scrollLeft")}),g.click(function(){a(this).taskbar("scrollRight")})};k()}),k=function(b,c){this.$element=a(b),this.$task=null,this.options=c,this.tools=this.TOOLS()},k.DEFAULTS={id:void 0,title:void 0},k.prototype.init=function(){var d,b=this,c=e.find("#task-"+this.options.id);this.show(),c.length?c.find("> div > span.title").html(this.options.title):(d='<li id="#taskid#"><div class="taskbutton"><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></div><div class="close"><i class="fa fa-times-circle"></i></div></li>',c=a(d.replace("#taskid#","task-"+this.options.id).replace("#title#",this.options.title)),c.appendTo(e)),this.contextmenu(c),this.switchTask(c),this.tools.scrollTask(c),c.click(function(d){if(a(d.target).closest("div").hasClass("close")||a(d.target).hasClass("close"))c.dialog("close",b.options.id);else{var e=a("body").data("bjui.dialog"),f=e[b.options.id].dialog;c.hasClass("selected")?f.find(".dialogHeader a.minimize").trigger("click"):f.is(":hidden")?b.restoreDialog(f):(f.trigger("click"),c.addClass(i)),b.scrollCurrent(c)}return!1})},k.prototype.TOOLS=function(){var k={scrollCurrent:function(){var b,c,d,a=this.tasksW(this.getTasks());a>this.getTaskBarW()?(b=this,c=e.find("> li:last-child"),d=this.getTaskBarW()-c.position().left-c.outerWidth(!0),e.animate({left:d},200,function(){b.ctrlScrollBtn()})):this.ctrlScrollBtn()},getTaskBarW:function(){return d.width()-(f.is(":hidden")?f.width()+2:0)-(g.is(":hidden")?g.width()+2:0)},scrollTask:function(a){var c,b=this;a.position().left+this.getLeft()+a.outerWidth()>this.getBarWidth()?(c=this.getTaskBarW()-a.position().left-a.outerWidth(!0)-2,e.animate({left:c},200,function(){b.ctrlScrollBtn()})):a.position().left+this.getLeft()<0&&(c=this.getLeft()-(a.position().left+this.getLeft()),e.animate({left:c},200,function(){b.ctrlScrollBtn()}))},ctrlScrollBtn:function(){var a=this.tasksW(this.getTasks());this.getTaskBarW()>a?(d.removeClass(j),g.hide(),f.hide(),this.getTasks().eq(0).length&&this.scrollTask(this.getTasks().eq(0))):(d.addClass(j),g.show().removeClass(h),f.show().removeClass(h),this.getLeft()>=0&&f.addClass(h),this.getLeft()<=this.getTaskBarW()-a&&g.addClass(h))},getLeft:function(){return e.position().left},visibleStart:function(){var c,a=this.getLeft(),b=this.getTasks();for(c=0;c<b.size();c++)if(b.eq(c).position().left+b.eq(c).outerWidth(!0)+a>=0)return b.eq(c);return b.eq(0)},visibleEnd:function(){var c,a=this.getLeft(),b=this.getTasks();for(c=0;c<b.size();c++)if(b.eq(c).position().left+b.eq(c).outerWidth(!0)+a>this.getBarWidth())return b.eq(c);return b.eq(b.size()-1)},getTasks:function(){return e.find("> li")},tasksW:function(b){var c=0;return b.each(function(){c+=a(this).outerWidth(!0)}),c},getBarWidth:function(){return c.innerWidth()},getCurrent:function(){return e.find("li."+i)}};return k},k.prototype.contextmenu=function(b){var c=this;b.contextmenu({id:"dialogCM",bindings:{reload:function(a){a.dialog("refresh",c.options.id)},closeCurrent:function(a){var d=a.isTag("li")?a:c.tools.getCurrent();d.find(".close").trigger("click")},closeOther:function(b){var d=e.find("> li").not(b);d.each(function(){a(this).find(".close").trigger("click")})},closeAll:function(){var e=c.tools.getTasks();e.each(function(){a(this).find(".close").trigger("click")})}},ctrSub:function(a,b){var d=b.find('[rel="closeCurrent"]'),e=b.find('[rel="closeOther"]');c.tools.getCurrent().length?1==c.tools.getTasks().size()&&e.addClass(h):(d.addClass(h),e.addClass(h))}})},k.prototype.closeDialog=function(a){var b="string"==typeof a?this.getTask(a):a;b&&b.length&&(b.remove(),this.tools.getTasks().size()||this.hide(),this.tools.scrollCurrent(),this.$element.removeData("bjui.taskbar"))},k.prototype.minimize=function(c){var d=this,e=a("body").data("bjui.dialog"),f="string"==typeof c?e[c].dialog:c,g=this.getTask(f.data("options").id);b.css({top:f.css("top"),left:f.css("left"),height:f.css("height"),width:f.css("width")}).show().animate({top:a(window).height()-60,left:g.position().left,width:g.outerWidth(),height:g.outerHeight()},250,function(){a(this).hide(),d.inactive(g)})},k.prototype.restoreDialog=function(c){var d=this.getTask(c.data("options").id);b.css({top:a(window).height()-60,left:d.position().left,height:d.outerHeight(),width:d.outerWidth()}).show().animate({top:c.css("top"),left:c.css("left"),width:c.css("width"),height:c.css("height")},250,function(){a(this).hide(),c.show().trigger("click.bjui.taskbar.restore")}),this.switchTask(d)},k.prototype.inactive=function(a){var b="string"==typeof a?this.getTask(a):a;b.removeClass(i)},k.prototype.scrollLeft=function(){var a=this.tools.visibleStart();this.tools.scrollTask(a)},k.prototype.scrollRight=function(){var a=this.tools.visibleEnd();this.tools.scrollTask(a)},k.prototype.scrollCurrent=function(a){this.tools.scrollTask(a)},k.prototype.switchTask=function(a){this.tools.getCurrent().removeClass(i);var b="string"==typeof a?this.getTask(a):a;b.addClass(i)},k.prototype.getTask=function(a){return e.find("#task-"+a)},k.prototype.changeTitle=function(a,b){var c=this.getTask(a);c&&b&&c.find(".title").html(b)},k.prototype.show=function(){c.is(":hidden")&&c.show().animate({bottom:0},500)},k.prototype.hide=function(){c.is(":visible")&&c.animate({bottom:-50},500,function(){c.hide()})},m=a.fn.taskbar,a.fn.taskbar=l,a.fn.taskbar.Constructor=k,a.fn.taskbar.noConflict=function(){return a.fn.taskbar=m,this}}(jQuery),+function(a){"use strict";function d(b){var d=arguments,e=b,f="bjui.ajax",g=a("body");return this.each(function(){var k,h=a(this),i=a.extend({},c.DEFAULTS,"object"==typeof b&&b),j=h.data(f);j?this===g[0]?j=new c(this,i):a.extend(j.options,"object"==typeof b&&b):j=new c(this,i),h.data(f,j),"string"==typeof e&&(k=j[e.toLowerCase()],a.isFunction(k)&&([].shift.apply(d),d?k.apply(j,d):k()))})}var b,e,c=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS()};c.DEFAULTS={okalert:!0,reload:!0,loadingmask:!0},c.NAVTAB="navtab",c.prototype.TOOLS=function(){var b=this,d={getPagerForm:function(b,c,d){var f,g,e=a.extend({},BJUI.pageInfo);if(d||(d=b.find("#pagerForm:first")[0]),b.data("bjui.clientPaging")&&(c=a.extend({},b.data("bjui.clientPaging"),c),b.data("bjui.clientPaging",c)),d)for(f in e)g="",c&&c[f]&&(g=c[f]),d[e[f]]?g&&(d[e[f]].value=g):a('<input type="hidden" name="'+e[f]+'" value="'+g+'">').appendTo(a(d));return d},getTarget:function(){return b.$element.closest(".navtab-panel").length?c.NAVTAB:"dialog"}};return d},c.prototype.ajaxdone=function(a){a[BJUI.keys.statusCode]==BJUI.statusCode.error?a[BJUI.keys.message]&&BJUI.alertmsg("error",a[BJUI.keys.message]):a[BJUI.keys.statusCode]==BJUI.statusCode.timeout?(BJUI.alertmsg("info",a[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()):a[BJUI.keys.message]&&BJUI.alertmsg("correct",a[BJUI.keys.message])},c.prototype.ajaxerror=function(a,b,c){var d=a.responseText,e=this,f=e.options,g=f.failCallback;"string"==typeof d&&d.startsWith("{")?this.ajaxdone(d.toObj()):BJUI.alertmsg("error","<div>Http status: "+a.status+" "+a.statusText+"</div>"+"<div>ajaxOptions: "+b+" </div>"+"<div>thrownError: "+c+" </div>"+"<div>"+d+"</div>"),g&&("string"==typeof g&&(g=g.toFunc()),"function"==typeof g?g.apply(e,[d,f]):BJUI.debug("The callback function 'failCallback' is incorrect: "+g))},c.prototype.ajaxcallback=function(b){var c=this,d=c.options,e=d.okCallback,f=d.errCallback,g=d.okAfterCallback,h=[],i=[],j=[],k=[],l=function(){"string"==typeof e&&(e=e.toFunc()),"function"==typeof e?e.apply(c,[b,d]):BJUI.debug("The callback function 'okCallback' is incorrect: "+e)},m=function(){"string"==typeof g&&(g=g.toFunc()),"function"==typeof g?g.apply(c,[b,d]):BJUI.debug("The callback function 'okAfterCallback' is incorrect: "+g)},n=function(){"string"==typeof f&&(f=f.toFunc()),"function"==typeof f?f.apply(c,[b,d]):BJUI.debug("The callback function 'errCallback' is incorrect: "+f)};if("string"==typeof b&&(b=b.toObj()),d.okalert&&c.ajaxdone(b),!b[BJUI.keys.statusCode]&&e)return l(),void 0;if(b[BJUI.keys.statusCode]==BJUI.statusCode.ok){if(e)return l(),void 0;b.tabid&&a.merge(h,b.tabid.split(",")),d.tabid&&a.merge(h,d.tabid.split(",")),b.dialogid&&a.merge(i,b.dialogid.split(",")),d.dialogid&&a.merge(i,d.dialogid.split(",")),b.divid&&a.merge(j,b.divid.split(",")),d.divid&&a.merge(j,d.divid.split(",")),b.datagrid&&a.merge(k,b.datagrid.split(",")),d.datagrid&&a.merge(k,d.datagrid.split(",")),h.length&&(a.unique(h),setTimeout(function(){BJUI.navtab("reloadFlag",h.join(","))},100)),i.length&&(a.unique(i),setTimeout(function(){BJUI.dialog("refresh",i.join(","))},100)),j.length&&(a.unique(j),setTimeout(function(){c.refreshdiv(j.join(","))},100)),k.length&&setTimeout(function(){a.each(k,function(b,c){a("#"+c.trim()).datagrid("refresh")})},100),c.$target==a.CurrentNavtab?c.navtabcallback(b):c.$target==a.CurrentDialog?c.dialogcallback(b):c.divcallback(b),g&&m()}else f&&n()},c.prototype.divcallback=function(b,c,d){var f,g,h,e=this;d=e.options,f=b.forward||d.forward||null,g=b.forwardConfirm||d.forwardConfirm||null,d.reload&&!f&&e.refreshlayout(d),d.reloadNavtab&&setTimeout(function(){BJUI.navtab("refresh")},100),f&&(h=function(){a.extend(d,{url:f}),e.refreshlayout(d)},g?BJUI.alertmsg("confirm",g,{okCall:function(){h()}}):h())},c.prototype.navtabcallback=function(a){var g,b=this,c=b.options,d=a.closeCurrent||c.closeCurrent||!1,e=a.forward||c.forward||null,f=a.forwardConfirm||c.forwardConfirm||null;d&&!e?BJUI.navtab("closeCurrentTab"):c.reload&&!e&&setTimeout(function(){BJUI.navtab("refresh")},100),e&&(g=function(){BJUI.navtab("reload",{url:e})},f?BJUI.alertmsg("confirm",f,{okCall:function(){g()},cancelCall:function(){d&&BJUI.navtab("closeCurrentTab")}}):g())},c.prototype.dialogcallback=function(a){var g,b=this,c=b.options,d=a.closeCurrent||c.closeCurrent||!1,e=a.forward||c.forward||null,f=a.forwardConfirm||c.forwardConfirm||null;d&&!e?BJUI.dialog("closeCurrent"):c.reload&&!e&&setTimeout(function(){BJUI.dialog("refresh")},100),c.reloadNavtab&&setTimeout(function(){BJUI.navtab("refresh")},100),e&&(g=function(){BJUI.dialog("reload",{url:e})},f?BJUI.alertmsg("confirm",a.forwardConfirm,{okCall:function(){g()},cancelCall:function(){d&&BJUI.dialog("closeCurrent")}}):g())},c.prototype.pagecallback=function(b,d){var e=this,f=a.extend({},c.DEFAULTS,b),g=d||null,h=null;g&&g.length?(h=e.tools.getPagerForm(g,f),h&&(a.extend(f,a(h).data()),e.reloadlayout({target:g[0],type:a(h).attr("method")||"POST",url:a(h).attr("action"),data:a(h).serializeArray(),loadingmask:f.loadingmask}))):e.tools.getTarget()==c.NAVTAB?(g=a.CurrentNavtab,h=e.tools.getPagerForm(g,f),h&&a.extend(f,a(h).data()),e.$element.navtab("reloadForm",!1,f)):(g=a.CurrentDialog,h=e.tools.getPagerForm(g,f),h&&a.extend(f,a(h).data()),e.$element.dialog("reloadForm",!1,f))},c.prototype.doajax=function(b){var e,h,d=this,f=d.$element;return b||(b={}),b.loadingmask||(b.loadingmask=!1),b=a.extend({},c.DEFAULTS,"object"==typeof b&&b),d.options=b,b.target?e=b.target instanceof jQuery?b.target:a(b.target):f[0]!==a("body")[0]&&(e=f.closest(".bjui-layout")),e&&e.length||(e=a.CurrentDialog||a.CurrentNavtab),d.$target=e,b.url?(b.url=decodeURI(b.url).replacePlh(e),b.url.isFinishedTm()?(b.url=encodeURI(b.url),b.callback&&b.callback.toFunc(),h=function(){b.callback||(b.callback=a.proxy(function(a){d.ajaxcallback(a)},d)),e.doAjax(b)},b.confirmMsg?BJUI.alertmsg("confirm",b.confirmMsg,{okCall:function(){h()}}):h(),void 0):(BJUI.alertmsg("error",b.warn||BJUI.regional.plhmsg),BJUI.debug("Bjuiajax Plugin: 'doajax' method: The url is incorrect: "+b.url),void 0)):(BJUI.debug("Bjuiajax Plugin: 'doajax' method: the url is undefined!"),void 0)},c.prototype.ajaxform=function(b){var i,j,k,c=this,d=a.extend({},"object"==typeof b&&b),e=c.$element,f=null,g=null,h=d.callback;return e[0]===a("body")[0]?(g=d.form,g instanceof jQuery||(g=a(d.form))):(g=e,f=g.closest(".bjui-layout")),g&&g.length&&g.isTag("form")?(i=g.attr("enctype"),d.target&&(f=d.target,f instanceof jQuery||(f=a(f))),f&&f.length||(f=a.CurrentDialog||a.CurrentNavtab),c.$target=f,d.url=d.url||g.attr("action"),BJUI.isIE(8)&&!d.type&&(g[0].getAttributeNode("method").specified||(d.type="POST")),d.type=d.type||g.attr("method")||"POST",a.extend(c.options,d),h&&(h=h.toFunc()),j=function(b){h?h.apply(c,[b,g]):a.proxy(c.ajaxcallback(b),c)},k=function(){var b={loadingmask:c.options.loadingmask,type:c.options.type,url:c.options.url,callback:j,error:a.proxy(c.ajaxerror,c)};i&&"multipart/form-data"==i?window.FormData?a.extend(b,{data:new FormData(g[0]),contentType:!1,processData:!1}):a.extend(b,{data:g.serializeArray(),files:g.find(":file"),iframe:!0,processData:!1}):a.extend(b,{data:g.serializeArray()}),c.options.ajaxTimeout&&(b.ajaxTimeout=c.options.ajaxTimeout),g.doAjax(b)},c.options.confirmMsg?BJUI.alertmsg("confirm",c.options.confirmMsg,{okCall:k}):k(),void 0):(BJUI.debug("Bjuiajax Plugin: 'ajaxform' method: Not set the form!"),void 0)},c.prototype.ajaxsearch=function(b){var h,i,k,c=this,d=a.extend({},"object"==typeof b&&b),e=c.$element,g={pageCurrent:1},j=d.isValid;if(d.target&&(i=a(d.target)),e[0]===a("body")[0]){if(h=d.form,h instanceof jQuery||(h=a(d.form)),!h||!h.length||!h.isTag("form"))return BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: Not set the form!"),void 0;d.target?(i=d.target,i instanceof jQuery||(i=a(i))):i=h.closest(".bjui-layout"),i&&i.length||(i=a.CurrentDialog||a.CurrentNavtab)}else{if(h=e,i=h.closest(".bjui-layout"),!h.isTag("form"))return BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: Not set the form!"),void 0;i&&i.length||(i=a.CurrentDialog||a.CurrentNavtab),d.url||(d.url=h.attr("action"))}return c.$target=i,d.url||(d.url=h.attr("action")),d.url?(d.url=decodeURI(d.url).replacePlh(h.closest(".unitBox")),d.url.isFinishedTm()?(d.url=encodeURI(d.url),d.type||(d.type=h.attr("method")||"POST"),c.tools.getPagerForm(i,g,h[0]),d.form=h,a.extend(c.options,d),k=function(){var b,e,f,g;if(i.hasClass("bjui-layout")){if(b=h.serializeJson(),e={},d.clearQuery){f=BJUI.pageInfo;for(g in f)e[f[g]]=b[f[g]];b=e}c.reloadlayout({target:i[0],type:c.options.type,url:c.options.url,data:b,loadingmask:c.options.loadingmask})}else i[0]===a.CurrentNavtab[0]?BJUI.navtab("reloadForm",c.options.clearQuery,d):BJUI.dialog("reloadForm",c.options.clearQuery,d)},j?k():a.fn.validator?h.isValid(function(a){a&&k()}):k(),void 0):(BJUI.alertmsg("error",d.warn||BJUI.regional.plhmsg),BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: The form's action or url is incorrect: "+d.url),void 0)):(BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: The form's action or url is undefined!"),void 0)},c.prototype.doload=function(b){var c=this,d=null,e=a.extend({},"object"==typeof b&&b);return a.extend(c.options,e),e.target&&(d=e.target,d instanceof jQuery||(d=a(d))),d&&d.length?e.url?(e.url=decodeURI(e.url).replacePlh(),e.url.isFinishedTm()?(e.url=encodeURI(e.url),d.removeData("bjui.clientPaging").data("options",e),c.reloadlayout(e),void 0):(BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),BJUI.debug("Bjuiajax Plugin: 'doload' method: The url is incorrect: "+e.url),void 0)):(BJUI.debug("Bjuiajax Plugin: 'doload' method: The url is undefined!"),void 0):(BJUI.debug("Bjuiajax Plugin: 'doload' method: Not set loaded container, like [data-target]."),void 0)},c.prototype.refreshlayout=function(c){var e,d=this;if(c&&(e=c,e instanceof jQuery||(e=a(e))),!e||!e.length)return b&&clearInterval(b),BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: No argument, can not refresh DIV.(parameters:[selector/jQuery object/element])"),void 0;if(e&&e.length){if(!e.data("options"))return BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: The target(DIV) is not a reload layout!"),void 0;e.removeData("bjui.clientPaging"),d.reloadlayout(e.data("options"))}},c.prototype.reloadlayout=function(c){var d=null,e=a.extend({},"object"==typeof c&&c),f=e&&e.autorefresh&&(isNaN(String(e.autorefresh))?15:e.autorefresh);return e.target&&(d=e.target,d instanceof jQuery||(d=a(d))),d&&d.length?d.data("options")?(e=a.extend({},d.data("options"),e),d.addClass("bjui-layout").data("options",e).ajaxUrl({type:e.type,url:e.url,data:e.data,loadingmask:e.loadingmask,callback:function(a){BJUI.ui.clientPaging&&d.data("bjui.clientPaging")&&d.pagination("setPagingAndOrderby",d),e.callback&&e.callback.apply(this,[d,a]),b&&clearInterval(b),f&&(b=setInterval(function(){d.bjuiajax("refreshlayout",d)},1e3*f))}}),void 0):(BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: This target(DIV) is not initialized!"),void 0):(b&&clearInterval(b),BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: Not set loaded container, like [data-target]."),void 0)},c.prototype.refreshdiv=function(a){var b,c;if(a&&"string"==typeof a)for(b=a.split(","),c=0;c<b.length;c++)this.refreshlayout("#"+b[c])},c.prototype.ajaxdownload=function(b){var d,f,c=this,e=a.extend({},"object"==typeof b&&b);return e.loadingmask=!1,a.extend(c.options,e),e.target&&(d=e.target,d instanceof jQuery||(d=a(d))),d&&d.length||(d=a.CurrentDialog||a.CurrentNavtab),c.$target=d,e.url?(e.url=decodeURI(e.url).replacePlh(d),e.url.isFinishedTm()?(f=function(){var b={};b.failCallback=function(a){a.trim().startsWith("{")&&(a=a.toObj()),c.ajaxdone(a),d.trigger("bjui.ajaxError")},b.prepareCallback=function(){e.loadingmask&&d.trigger("bjui.ajaxStart")},b.successCallback=function(){d.trigger("bjui.ajaxStop")},e.type&&!e.httpMethod&&(e.httpMethod=e.type),console.log(e),a.extend(b,e),b.data||(b.data={}),"undefined"==typeof b.data.ajaxrequest&&(b.data.ajaxrequest=!0),a.fileDownload(e.url,b)},e.confirmMsg?BJUI.alertmsg("confirm",e.confirmMsg,{okCall:function(){f()}}):f(),void 0):(BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),BJUI.debug("Bjuiajax Plugin: 'ajaxdownload' method: The url is incorrect: "+e.url),void 0)):(BJUI.debug("Bjuiajax Plugin: 'ajaxdownload' method: The url is undefined!"),void 0)},c.prototype.doexport=function(b){var g,h,d=this,e=d.$element,f=b.target?a(b.target):null;return b.url?(b.url=decodeURI(b.url).replacePlh(e.closest(".unitBox")),b.url.isFinishedTm()?(h=function(){f&&f.length||(f=d.tools.getTarget()==c.NAVTAB?a.CurrentNavtab:a.CurrentDialog),g=d.tools.getPagerForm(f),g&&(b.data||(b.data={}),a.extend(b.data,a(g).serializeJson())),a.fileDownload(b.url,{failCallback:function(a){a.trim().startsWith("{")&&(a=a.toObj()),d.ajaxdone(a)},data:b.data||{}})},b.confirmMsg?BJUI.alertmsg("confirm",b.confirmMsg,{okCall:function(){h()}}):h(),void 0):(BJUI.alertmsg("error",b.warn||BJUI.regional.plhmsg),BJUI.debug("The ajax url is incorrect: "+b.url),void 0)):(BJUI.debug("Error trying to open a ajax link: url is undefined!"),void 0)},c.prototype.doexportchecked=function(b){var g,h,d=this,e=d.$element,f=b.target?a(b.target):null;return b.url?(b.url=decodeURI(b.url).replacePlh(e.closest(".unitBox")),b.url.isFinishedTm()?(h=function(){if(!b.group)return BJUI.alertmsg("error",b.warn||BJUI.regional.nocheckgroup),void 0;f&&f.length||(f=d.tools.getTarget()==c.NAVTAB?a.CurrentNavtab:a.CurrentDialog);var e=[],h=f.find(":checkbox[name="+b.group+"]:checked");return h.length?(h.each(function(){e.push(a(this).val())}),g=b.idname||"ids",b.data=b.data||{},b.data[g]=e.join(","),a.fileDownload(b.url,{failCallback:function(a){a.trim().startsWith("{")&&(a=a.toObj()),d.ajaxdone(a)},data:b.data}),void 0):(BJUI.alertmsg("error",BJUI.regional.notchecked),void 0)},b.confirmMsg?BJUI.alertmsg("confirm",b.confirmMsg,{okCall:function(){h()}}):h(),void 0):(BJUI.alertmsg("error",b.warn||BJUI.regional.plhmsg),BJUI.debug("The ajax url is incorrect: "+b.url),void 0)):(BJUI.debug("Error trying to open a export link: url is undefined!"),void 0)},c.prototype.doajaxchecked=function(b){var g,h,d=this,e=d.$element,f=b.target?a(b.target):null;return b=a.extend({},c.DEFAULTS,"object"==typeof b&&b),b.url?(b.url=decodeURI(b.url).replacePlh(e.closest(".unitBox")),b.url.isFinishedTm()?(h=function(){if(!b.group)return BJUI.alertmsg("error",b.warn||BJUI.regional.nocheckgroup),void 0;f&&f.length||(f=d.tools.getTarget()==c.NAVTAB?a.CurrentNavtab:a.CurrentDialog);var h=[],i=f.find(":checkbox[name="+b.group+"]:checked"),j=b.callback&&b.callback.toFunc();return i.length?(i.each(function(){h.push(a(this).val())}),g=b.idname||"ids",b.data=b.data||{},b.data[g]=h.join(","),e.doAjax({type:b.type,url:b.url,data:b.data,callback:j?j:a.proxy(function(a){d.ajaxcallback(a)},d)}),void 0):(BJUI.alertmsg("error",BJUI.regional.notchecked),void 0)},b.confirmMsg?BJUI.alertmsg("confirm",b.confirmMsg,{okCall:function(){h()}}):h(),void 0):(BJUI.alertmsg("error",b.warn||BJUI.regional.plhmsg),BJUI.debug("The ajax url is incorrect: "+b.url),void 0)):(BJUI.debug("Error trying to open a del link: url is undefined!"),void 0)},e=a.fn.bjuiajax,a.fn.bjuiajax=d,a.fn.bjuiajax.Constructor=c,a.fn.bjuiajax.noConflict=function(){return a.fn.bjuiajax=e,this},BJUI.ajax=function(){d.apply(a("body"),arguments)},a(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxform"]',function(b){var c=a(this),e=c.data();d.call(c,"ajaxform",e),b.preventDefault()}),a(function(){a.fn.validator?a(document).on(BJUI.eventType.initUI,function(b){a(b.target).find('form[data-toggle="ajaxsearch"]').each(function(){var b=a(this),c=b.data();c.isValid=!0,b.validator({valid:function(){d.call(b,"ajaxsearch",c)}})})}):a(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxsearch"]',function(b){var c=a(this),e=c.data();d.call(c,"ajaxsearch",e),b.preventDefault()})}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadsearch"]',function(b){var e,c=a(this),f=c.closest("form");f&&f.length&&(e=f.data(),e.clearQuery=c.data("clearQuery")||!0,d.call(f,"ajaxsearch",e),b.preventDefault())}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxload"]',function(b){var c=a(this),e=c.data(),f=e.options;f&&("string"==typeof f&&(f=f.toObj()),"object"==typeof f&&(delete e.options,a.extend(e,f))),e.url||(e.url=c.attr("href")),d.call(c,"doload",e),b.preventDefault()}),a(document).on(BJUI.eventType.initUI,function(b){a(b.target).find('[data-toggle="autoajaxload"]').each(function(){var b=a(this),c=b.data();c.target=this,d.call(b,"doload",c)})}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="refreshlayout"]',function(b){var c=a(this),e=c.data("target");d.call(c,"refreshlayout",e),b.preventDefault()}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadlayout"]',function(b){var c=a(this),e=c.data();d.call(c,"reloadlayout",e),b.preventDefault()}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajax"]',function(b){var c=a(this),e=c.data(),f=e.options;f&&("string"==typeof f&&(f=f.toObj()),"object"==typeof f&&(delete e.options,a.extend(e,f))),e.url||(e.url=c.attr("href")),d.call(c,"doajax",e),b.preventDefault()}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxdownload"]',function(b){var c=a(this),e=c.data(),f=e.options;f&&("string"==typeof f&&(f=f.toObj()),"object"==typeof f&&(delete e.options,a.extend(e,f))),e.url||(e.url=c.attr("href")),d.call(c,"ajaxdownload",e),b.preventDefault()}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexport"]',function(b){var c=a(this),e=c.data();e.url||(e.url=c.attr("href")),d.call(c,"doexport",e),b.preventDefault()}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexportchecked"]',function(b){var c=a(this),e=c.data();e.url||(e.url=c.attr("href")),d.call(c,"doexportchecked",e),b.preventDefault()}),a(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajaxchecked"]',function(b){var c=a(this),e=c.data();e.url||(e.url=c.attr("href")),d.call(c,"doajaxchecked",e),b.preventDefault()})}(jQuery),+function(a){"use strict";function f(b){var c=arguments,d=b,f="bjui.alertmsg",g=a("body"),h=g.data(f);return this.each(function(){var j=(a(this),a.extend({},e.DEFAULTS,"object"==typeof b&&b));h?h.options=j:h=new e(j),g.data(f,h),"string"==typeof d&&a.isFunction(h[d])&&([].shift.apply(c),c?h[d].apply(h,c):h[d]())})}var b,c,d,e,g;a(function(){var d=function(){b=a(FRAG.alertBoxFrag).hide().html(""),c=a(FRAG.alertBackground).hide().html(""),a("body").append("<!-- alert msg box -->").append(b).append("<!-- alert msg box mask bg -->").append(c)};d()}),e=function(a){this.options=a,this.tools=this.TOOLS(),this.clearTime=null},e.DEFAULTS={displayPosition:"topcenter",displayMode:"slide",autoClose:null,alertTimeout:3e3,mask:null,types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},fas:{error:"fa-times-circle",info:"fa-info-circle",warn:"fa-exclamation-circle",correct:"fa-check-circle",confirm:"fa-question-circle"}},e.prototype.TOOLS=function(){var e=this,f={getTitle:function(a){return e.options.title||BJUI.regional.alertmsg.title[a]},keydownOk:function(a){return a.which==BJUI.keyCode.ENTER?(a.data.target.trigger("click"),!1):!0},keydownEsc:function(a){a.which==BJUI.keyCode.ESC&&a.data.target.trigger("click")},openPosition:function(){var a=BJUI.alertMsg.displayPosition,c=BJUI.alertMsg.displayMode,d=460,f=b.outerHeight(),g={},h={};switch(a?e.options.displayPosition&&"topcenter"!=e.options.displayPosition&&(a=e.options.displayPosition):a=e.options.displayPosition,c?e.options.displayMode&&"silde"!=e.options.displayMode&&(c=e.options.displayMode):c=e.options.displayMode,a){case"topleft":g={top:0-f,left:0,"margin-left":0},h={top:0};break;case"topcenter":g={top:0-f},h={top:0};break;case"topright":g={top:0-f,left:"auto",right:0,"margin-left":0},h={top:0};break;case"middleleft":g={top:"50%",left:0-d,"margin-left":0,"margin-top":0-f/2},h={left:0};break;case"middlecenter":g={top:"0","margin-top":0-f/2},h={top:"50%"};break;case"middleright":g={top:"50%",left:"auto",right:0-d,"margin-top":0-f/2},h={right:0};break;case"bottomleft":g={top:"auto",left:0,bottom:0-f,"margin-left":0},h={bottom:0};break;case"bottomcenter":g={top:"auto",bottom:0-f},h={bottom:0};break;case"bottomright":g={top:"auto",left:"auto",right:0,bottom:0-f,"margin-left":0},h={bottom:0}}"slide"==c?b.css(g).show().animate(h,500):"fade"==c?(g.opacity=.1,b.css(g).css(h).show().animate({opacity:1},500)):b.css(g).css(h).show()},closePosition:function(){var d=BJUI.alertMsg.displayPosition,f=BJUI.alertMsg.displayMode,g=460,h=b.outerHeight(),i={};switch(d?e.options.displayPosition&&"topcenter"!=e.options.displayPosition&&(d=e.options.displayPosition):d=e.options.displayPosition,f?e.options.displayMode&&"silde"!=e.options.displayMode&&(f=e.options.displayMode):f=e.options.displayMode,d){case"topleft":i={top:0-h};break;case"topcenter":i={top:0-h};break;case"topright":i={top:0-h};break;case"middleleft":i={left:0-g};break;case"middlecenter":i={top:0-h};break;case"middleright":i={right:0-g};break;case"bottomleft":i={bottom:0-h};break;case"bottomcenter":i={bottom:0-h};break;case"bottomright":i={bottom:0-h}}"slide"==f?b.animate(i,500,function(){c.hide(),a(this).hide().empty()}):"fade"==f?b.animate({opacity:0},500,function(){c.hide(),a(this).hide().empty()}):(b.hide().remove(),c.hide())},open:function(f,g,h){var k,l,n,o,p,q,i=this,j="",m=BJUI.alertMsg.alertTimeout;if(h)for(n=0;n<h.length;n++)o=h[n].call?"callback":"",p=h[n].cls?h[n].cls:"default",q=h[n].cls&&"green"==h[n].cls?"check":"close",j+=FRAG.alertBtnFrag.replace("#btnMsg#",'<i class="fa fa-'+q+'"></i> '+h[n].name).replace("#callback#",o).replace("#class#",p);
    k=a(FRAG.alertBoxFrag.replace("#type#",f).replace("#fa#",e.options.fas[f]).replace("#title#",this.getTitle(f)).replace("#message#",g).replace("#btnFragment#",j)).hide().appendTo("body"),b&&b.length&&b.remove(),b=k,i.openPosition(),d&&(clearTimeout(d),d=null),null==e.options.mask&&e.options.types.info!=f&&e.options.types.correct!=f&&c.show(),null==e.options.autoClose&&(e.options.types.info==f||e.options.types.correct==f)&&(m?e.options.alertTimeout&&3e3!=e.options.alertTimeout&&(m=e.options.alertTimeout):m=e.options.alertTimeout,d=setTimeout(function(){i.close()},m)),l=b.find(".btn"),l.each(function(b){a(this).on("click",a.proxy(function(){e.tools.close();var a=h[b].call;"string"==typeof a&&(a=a.toFunc()),"function"==typeof a&&a.call()},e)),h[b].keyCode===BJUI.keyCode.ENTER&&a(document).on("keydown.bjui.alertmsg.ok",{target:l.eq(b)},i.keydownOk),h[b].keyCode===BJUI.keyCode.ESC&&a(document).on("keydown.bjui.alertmsg.esc",{target:l.eq(b)},i.keydownEsc)})},alert:function(b,c,d){var f,g;a.extend(e.options,"object"==typeof d&&d),f=a.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null},e.options),g=[{name:f.okName,call:f.okCall,cls:"default",keyCode:BJUI.keyCode.ENTER}],this.open(b,c,g)},close:function(){a(document).off("keydown.bjui.alertmsg.ok").off("keydown.bjui.alertmsg.esc"),this.closePosition()}};return f},e.prototype.error=function(a,b){this.tools.alert(this.options.types.error,a,b)},e.prototype.info=function(a,b){this.tools.alert(this.options.types.info,a,b)},e.prototype.warn=function(a,b){this.tools.alert(this.options.types.warn,a,b)},e.prototype.ok=function(a,b){this.tools.alert(this.options.types.correct,a,b)},e.prototype.correct=function(a,b){this.tools.alert(this.options.types.correct,a,b)},e.prototype.confirm=function(b,c){var d,e;a.extend(this.options,"object"==typeof c&&c),d=a.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options),e=[{name:d.okName,call:d.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:d.cancelName,call:d.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}],this.tools.open(this.options.types.confirm,b,e)},g=a.fn.alertmsg,a.fn.alertmsg=f,a.fn.alertmsg.Constructor=e,a.fn.alertmsg.noConflict=function(){return a.fn.alertmsg=g,this},BJUI.alertmsg=function(){f.apply(a("body"),arguments)},a(document).on("click.bjui.alertmsg.data-api",'[data-toggle="alertmsg"]',function(b){var g,c=a(this),d=c.data(),e=d.options;return e&&("string"==typeof e&&(e=e.toObj()),"object"==typeof e&&a.extend(d,e)),(g=d.type)?(d.msg||e.msg&&(d.msg=e.msg),f.call(c,g,d.msg||g,d),b.preventDefault(),void 0):!1})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.pagination");h||f.data("bjui.pagination",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS()};b.DEFAULTS={first:"li.j-first",prev:"li.j-prev",next:"li.j-next",last:"li.j-last",nums:"li.j-num > a",jump:"li.jumpto",pageNumFrag:'<li class="#liClass#"><a href="javascript:;">#pageNum#</a></li>',total:0,pageSize:10,pageNum:10,pageCurrent:1,callback:function(){return!1}},b.prototype.TOOLS=function(){var b=this.options,c={pageNums:function(){return Math.ceil(b.total/b.pageSize)},getInterval:function(){var a=Math.ceil(b.pageNum/2),c=this.pageNums(),d=c-b.pageNum,e=this.getCurrentPage()>a?Math.max(Math.min(this.getCurrentPage()-a,d),0):0,f=this.getCurrentPage()>a?Math.min(this.getCurrentPage()+a,c):Math.min(b.pageNum,c);return{start:e+1,end:f+1}},getCurrentPage:function(){var a=parseInt(b.pageCurrent);return isNaN(a)?1:a},hasPrev:function(){return this.getCurrentPage()>1},hasNext:function(){return this.getCurrentPage()<this.pageNums()}};return c},b.prototype.init=function(){function n(c,d){c.on("click",function(c){var e={pageCurrent:d,pageSize:b.options.pageSize};b.setClientPaging(e),a(this).bjuiajax("pageCallback",e,b.$element.closest(".bjui-layout")),c.preventDefault()})}var b,c,d,e,f,g,h,i,j,k,l,m;for(BJUI.ui.clientPaging&&!this.getClientPaging()&&this.setClientPaging({pageCurrent:this.options.pageCurrent,pageSize:this.options.pageSize}),b=this,c=this.options,d=this.tools,e=d.getInterval(),f="",g=FRAG.pagination,h=BJUI.regional.pagination,i=e.start;i<e.end;i++)f+=c.pageNumFrag.replaceAll("#pageNum#",i).replaceAll("#liClass#",i==d.getCurrentPage()?"selected j-num":"j-num");g=g.replaceAll("#pageNumFrag#",f).replaceAll("#pageCurrent#",d.getCurrentPage()).replaceAll("#first#",h.first).replaceAll("#last#",h.last).replaceAll("#prev#",h.prev).replaceAll("#next#",h.next).replaceAll("#jumpto#",h.jumpto).replaceAll("#jump#",h.jump),this.$element.html(g),j=this.$element.find(c.first),k=this.$element.find(c.prev),l=this.$element.find(c.next),m=this.$element.find(c.last),d.hasPrev()?(j.add(k).find("> span").hide(),n(k,d.getCurrentPage()-1),n(j,1)):j.add(k).addClass("disabled").find("> a").hide(),d.hasNext()?(l.add(m).find("> span").hide(),n(l,d.getCurrentPage()+1),n(m,d.pageNums())):l.add(m).addClass("disabled").find("> a").hide(),this.$element.find(c.nums).each(function(b){n(a(this),b+e.start)}),this.$element.find(c.jump).each(function(){var d=a(this).find(":text"),e=a(this).find(".goto");e.on("click",function(){var e=d.val(),f={pageCurrent:e,pageSize:c.pageSize};e&&e.isPositiveInteger()&&(b.setClientPaging(f),a(this).bjuiajax("pageCallback",f,b.$element.closest(".bjui-layout")))}),d.keyup(function(a){a.keyCode==BJUI.keyCode.ENTER&&e.trigger("click")})})},b.prototype.changePagesize=function(){var a=this,b=a.$element.val(),c={pageSize:b};isNaN(b)||(a.setClientPaging(c),a.$element.bjuiajax("pageCallback",c,a.$element.closest(".bjui-layout")))},b.prototype.orderBy=function(){var c=this;c.$element.css({cursor:"pointer"}).click(function(){var b=a(this).data("orderField"),d=a(this).data("orderDirection"),e={orderField:b,orderDirection:d};c.setClientPaging(e),a(this).bjuiajax("pageCallback",e,c.$element.closest(".bjui-layout"))})},b.prototype.destroy=function(){this.$element.removeData("bjui.pagination").empty()},b.prototype.getTarget=function(){var c,b=this;return c=b.$element.closest(".bjui-layout").length?b.$element.closest(".bjui-layout"):b.$element.closest(".navtab-panel").length?a.CurrentNavtab:a.CurrentDialog},b.prototype.getClientPaging=function(){return this.getTarget().data("bjui.clientPaging")},b.prototype.setClientPaging=function(b){if(BJUI.ui.clientPaging){var c=this.getTarget();c.data("bjui.clientPaging",a.extend({},c.data("bjui.clientPaging")||{},b))}},b.prototype.setClientOrder=function(a){if(BJUI.ui.clientPaging){var b=this.getClientPaging();b&&b.orderField||this.setClientPaging(a)}},b.prototype.setPagingAndOrderby=function(a){var b=a.data("bjui.clientPaging");a.find('[data-toggle="pagination"]').pagination("destroy").pagination(b),b.pageSize&&a.find('select[data-toggle-change="changepagesize"]').selectpicker("val",b.pageSize),b.orderField&&a.find('th[data-order-field="'+b.orderField+'"]').addClass(b.orderDirection).siblings().removeClass("asc desc")},d=a.fn.pagination,a.fn.pagination=c,a.fn.pagination.Constructor=b,a.fn.pagination.noConflict=function(){return a.fn.pagination=d,this},a(document).on(BJUI.eventType.initUI,function(b){var d=a(b.target).find('[data-toggle="pagination"]');d.length&&c.call(d)}),a(document).on("change.bjui.pagination.data-api",'select[data-toggle-change="changepagesize"]',function(b){var d=a(this);d.data(),c.call(d,"changePagesize"),b.preventDefault()})}(jQuery),+function($){"use strict";function LZ(a){return(0>a||a>9?"":"0")+a}function formatDate(a,b){var c,d,e,f,g,h,i,j,k,l,m,C;for(b+="",c="",d=0,e="",f="",g=a.getYear()+"",h=a.getMonth()+1,i=a.getDate(),j=a.getDay(),k=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),C={},g.length<4&&(g=""+(g-0+1900)),C["y"]=""+g,C["yyyy"]=g,C["yy"]=g.substring(2,4),C["M"]=h,C["MM"]=LZ(h),C["MMM"]=MONTH_NAMES[h-1],C["NNN"]=MONTH_NAMES[h+11],C["d"]=i,C["dd"]=LZ(i),C["E"]=DAY_NAMES[j+7],C["EE"]=DAY_NAMES[j],C["H"]=k,C["HH"]=LZ(k),C["h"]=k?k>12?k-12:k:12,C["hh"]=LZ(C["h"]),C["K"]=k>11?k-12:k,C["k"]=k+1,C["KK"]=LZ(C["K"]),C["kk"]=LZ(C["k"]),C["a"]=k>11?"PM":"AM",C["m"]=l,C["mm"]=LZ(l),C["s"]=m,C["ss"]=LZ(m);d<b.length;){for(e=b.charAt(d),f="";b.charAt(d)==e&&d<b.length;)f+=b.charAt(d++);c+=null!=C[f]?C[f]:f}return c}function _isInteger(a){return new RegExp(/^\d+$/).test(a)}function _getInt(a,b,c,d){var e,f;for(e=d;e>=c;e--){if(f=a.substring(b,b+e),f.length<c)return null;if(_isInteger(f))return f}return null}function parseDate(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t;for(a+="",b+="",c=0,d=0,e="",f="",j=new Date(1900,0,1),k=j.getYear(),l=j.getMonth()+1,m=1,n=j.getHours(),o=j.getMinutes(),p=j.getSeconds(),q="";d<b.length;){for(e=b.charAt(d),f="";b.charAt(d)==e&&d<b.length;)f+=b.charAt(d++);if("yyyy"==f||"yy"==f||"y"==f){if("yyyy"==f&&(h=4,i=4),"yy"==f&&(h=2,i=2),"y"==f&&(h=2,i=4),k=_getInt(a,c,h,i),null==k)return 0;c+=k.length,2==k.length&&(k=k>70?1900+(k-0):2e3+(k-0))}else if("MMM"==f||"NNN"==f){for(l=0,r=0;r<MONTH_NAMES.length;r++)if(s=MONTH_NAMES[r],a.substring(c,c+s.length).toLowerCase()==s.toLowerCase()&&("MMM"==f||"NNN"==f&&r>11)){l=r+1,l>12&&(l-=12),c+=s.length;break}if(1>l||l>12)return 0}else if("EE"==f||"E"==f){for(r=0;r<DAY_NAMES.length;r++)if(t=DAY_NAMES[r],a.substring(c,c+t.length).toLowerCase()==t.toLowerCase()){c+=t.length;break}}else if("MM"==f||"M"==f){if(l=_getInt(a,c,f.length,2),null==l||1>l||l>12)return 0;c+=l.length}else if("dd"==f||"d"==f){if(m=_getInt(a,c,f.length,2),null==m||1>m||m>31)return 0;c+=m.length}else if("hh"==f||"h"==f){if(n=_getInt(a,c,f.length,2),null==n||1>n||n>12)return 0;c+=n.length}else if("HH"==f||"H"==f){if(n=_getInt(a,c,f.length,2),null==n||0>n||n>23)return 0;c+=n.length}else if("KK"==f||"K"==f){if(n=_getInt(a,c,f.length,2),null==n||0>n||n>11)return 0;c+=n.length}else if("kk"==f||"k"==f){if(n=_getInt(a,c,f.length,2),null==n||1>n||n>24)return 0;c+=n.length,n--}else if("mm"==f||"m"==f){if(o=_getInt(a,c,f.length,2),null==o||0>o||o>59)return 0;c+=o.length}else if("ss"==f||"s"==f){if(p=_getInt(a,c,f.length,2),null==p||0>p||p>59)return 0;c+=p.length}else if("a"==f){if("am"==a.substring(c,c+2).toLowerCase())q="AM";else{if("pm"!=a.substring(c,c+2).toLowerCase())return 0;q="PM"}c+=2}else{if(a.substring(c,c+f.length)!=f)return 0;c+=f.length}}if(c!=a.length)return 0;if(2==l)if(0==k%4&&0!=k%100||0==k%400){if(m>29)return 0}else if(m>28)return 0;return(4==l||6==l||9==l||11==l)&&m>30?0:(12>n&&"PM"==q?n=n-0+12:n>11&&"AM"==q&&(n-=12),new Date(k,l-1,m,n,o,p))}function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");Date.prototype.formatDate=function(a){return formatDate(this,a)},String.prototype.parseDate=function(a){return this.length<a.length&&(a=a.slice(0,this.length)),parseDate(this,a)},Date.prototype.formatDateTm=function(a){var f,g,h,i,b=this.getFullYear(),c=this.getMonth()+1,d=this.getDate(),e=a.replaceAll("%y",b).replaceAll("%M",c).replaceAll("%d",d);return e=replaceTmEval(e),f=1900,g=0,h=1,i=e.split("-"),i.length>0&&(f=i[0]),i.length>1&&(g=i[1]-1),i.length>2&&(h=i[2]),new Date(f,g,h).formatDate("yyyy-MM-dd")}}(jQuery),+function(a){"use strict";function u(b){var c=arguments,d=b;return this.each(function(){var e=a(this),f=a.extend({},t.DEFAULTS,e.data(),"object"==typeof b&&b),g=e.data("bjui.datepicker");g||e.data("bjui.datepicker",g=new t(this,f)),"string"==typeof d&&a.isFunction(g[d])?([].shift.apply(c),c?g[d].apply(g,c):g[d]()):g.init()})}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v;a(function(){var t=function(){var v,w,t=BJUI.regional.datepicker,u=FRAG.calendarFrag.replace("#close#",t.close).replace("#prev#",t.prev).replace("#next#",t.next).replace("#clear#",t.clear).replace("#ok#",t.ok);b=a(u).hide(),a("body").append("<!-- datepicker -->").append(b),c=b.find("> .main"),d=b.find("a.prev"),e=b.find("a.next"),f=b.find("select[name=year]"),g=b.find("select[name=month]"),h=b.find(".time"),i=h.find(":text"),j=h.find("ul > li"),k=h.find(".hh"),l=h.find(".mm"),m=h.find(".ss"),n=c.find("> .tm"),o=b.find(".close"),p=c.find("> .body > .days"),q=c.find("> .body > .dayNames"),r=b.find(".clearBtn"),s=b.find(".okBtn"),v="",w=BJUI.regional.datepicker,a.each(w.dayNames,function(a,b){v+="<dt>"+b+"</dt>"}),q.html(v),a.each(w.monthNames,function(a,b){var c=a+1;g.append('<option value="'+c+'">'+b+"</option>")}),b.on("selectstart",function(){return!1})};t()}),t=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS(),this.$dateBtn=null;var d=new Date;this.options.minDate=d.formatDateTm(this.options.minDate),this.options.maxDate=d.formatDateTm(this.options.maxDate),this.events={focus_time:"focus.bjui.datepicker.time",click_prev:"click.bjui.datepicker.prev",click_next:"click.bjui.datepicker.next",click_ok:"click.bjui.datepicker.ok",click_days:"click.bjui.datepicker.days",click_clear:"click.bjui.datepicker.clear",click_close:"click.bjui.datepicker.close",click_tm:"click.bjui.datepicker.tm",click_spinner:"click.bjui.datepicker.spinner",mousedown_sp:"mousedown.bjui.datepicker.spinner",mouseup_sp:"mouseup.bjui.datepicker.spinner",change_ym:"change.bjui.datepicker.ym",click_time:"click.bjui.datepicker.time",keydown_time:"keydown.bjui.datepicker.time",keyup_time:"keyup.bjui.datepicker.time"}},t.DEFAULTS={pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},t.EVENTS={afterChange:"afterchange.bjui.datepicker"},t.prototype.TOOLS=function(){var c=this,d={changeTmMenu:function(a){n.removeClass("hh").removeClass("mm").removeClass("ss"),a&&(n.addClass(a),i.removeClass("slt").filter("."+a).addClass("slt"))},clickTmMenu:function(b,d){n.find("> ul").hide().filter("."+d).show().find("> li").off(c.events.click_tm).on(c.events.click_tm,function(){var c=a(this),d=parseInt(c.text())<10?"0"+c.text():c.text();b.val(d)})},keydownInt:function(a){return a.keyCode>=48&&a.keyCode<=57||a.keyCode==BJUI.keyCode.DELETE||a.keyCode==BJUI.keyCode.BACKSPACE?void 0:!1},changeTm:function(a,b){var c=parseInt(a.val()),d=parseInt(a.data("start"))||0,e=parseInt(a.data("end")),f=parseInt(a.data("step")||1),g=b?b.data("add")?b.data("add"):-1:0,h=c;1==g?e-f>=c&&(h=c+f):-1==g?c>=d+f&&(h=c-f):c>e?h=e:d>c&&(h=d),10>h&&(h="0"+h),a.val(h)},closeCalendar:function(e){d.changeTmMenu(),e&&(a(document).off(c.events.click_close),b.hide())},get:function(a){return c.options[a]},getDays:function(a,b){return 2==b?a%4||!(a%100)&&a%400?28:29:/4|6|9|11/.test(b)?30:31},minMaxDate:function(a){var b=a.split("-").length-1,c="y-M-d";return 1==b?c="y-M":b||(c="y"),a.parseDate(c)},getMinDate:function(){return this.minMaxDate(c.options.minDate)},getMaxDate:function(){var e,a=c.options.maxDate,b=a.split("-").length-1,d=this.minMaxDate(a);return 2>b&&(e=this.getDays(d.getFullYear(),d.getMonth()+1),d.setDate(e),b||d.setMonth(11)),d},getDateWrap:function(a){var b,d,e;return a||(a=this.parseDate(c.sDate)||new Date),b=a.getFullYear(),d=a.getMonth()+1,e=this.getDays(b,d),{year:b,month:d,day:a.getDate(),hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds(),days:e,date:a}},changeDate:function(a,b,d){var e=new Date(a,b-1,d||1);return c.sDate=this.formatDate(e),e},changeDateTime:function(a,b,d,e,f,g){var h=new Date(a,b-1,d,e,f,g);return c.sDate=this.formatDate(h),h},changeDay:function(a,b){b||(b=0);var c=this.getDateWrap();return this.changeDate(c.year,c.month+parseInt(b),a)},changeMonth:function(a){var b=f.get(0).selectedIndex,c=f.find("option").length,d=1*g.val()+a;d?13==d&&(b==c-1?d=12:(d=1,b++,f.get(0).selectedIndex=b)):b?(d=12,b--,f.get(0).selectedIndex=b):d=1,g.val(d).change()},parseDate:function(a){return a?a.parseDate(c.options.pattern):null},formatDate:function(a){return a.formatDate(c.options.pattern)},hasHour:function(){return-1!=c.options.pattern.indexOf("H")},hasMinute:function(){return-1!=c.options.pattern.indexOf("m")},hasSecond:function(){return-1!=c.options.pattern.indexOf("s")},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){var b,a=["y","M","d","E"];for(b=0;b<a.length;b++)if(-1!=c.options.pattern.indexOf(a[b]))return!0;return!1},afterChange:function(a){var b=this.formatDate(a);c.$element.trigger(t.EVENTS.afterChange,{date:a,value:b})}};return d},t.prototype.addBtn=function(){var d,e,b=this,c=b.$element;this.$dateBtn||this.options.addbtn||c.parent().hasClass("wrap_bjui_btn_box")||(this.$dateBtn=a(FRAG.dateBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),d=this.$element.parent(),e=this.$element.addClass("form-control").innerHeight(),d.css({position:"relative",display:"inline-block"}),this.$dateBtn.css({height:e,lineHeight:e+"px"}).appendTo(d),this.$dateBtn.on("selectstart",function(){return!1}))},t.prototype.init=function(){var b,h,i,j,n,q,t,u;for(this.$element.val()&&(this.sDate=this.$element.val().trim()),b=this,this.options,h=this.tools,i=h.getDateWrap(),j=h.getMinDate(),n=h.getMaxDate(),q=j.getFullYear(),t=n.getFullYear(),f.empty(),u=q;t>=u;u++)f.append('<option value="'+u+'"'+(i.year==u?" selected":"")+">"+u+"</option>");g.val(i.month),f.add(g).off(this.events.change_ym).on(this.events.change_ym,function(){var a,c;h.hasTime()?(a=p.find(".slt"),c=h.changeDateTime(f.val(),g.val(),a.data("day"),i.hour,i.minute,i.second),b.create(h.getDateWrap(c),j,n)):(a=p.find(".slt"),c=h.changeDate(f.val(),g.val(),a.data("day")),b.create(h.getDateWrap(c),j,n))}),d.off(this.events.click_prev).on(this.events.click_prev,function(){b.tools.changeMonth(-1)}),e.off(this.events.click_prev).on(this.events.click_prev,function(){b.tools.changeMonth(1)}),r.off(this.events.click_clear).on(this.events.click_clear,function(){b.$element.val(""),h.closeCalendar(!0)}),s.off(this.events.click_ok).on(this.events.click_ok,function(){var c,a=p.find("dd.slt");return a.hasClass("disabled")?!1:(c=h.changeDay(a.data("day"),a.data("month")),h.hasTime()&&(c.setHours(parseInt(k.val())),c.setMinutes(parseInt(l.val())),c.setSeconds(parseInt(m.val()))),h.closeCalendar(!0),b.$element.val(h.formatDate(c)).focus(),h.afterChange(c),void 0)}),o.off(this.events.click_close).on(this.events.click_close,function(){h.closeCalendar(!0)}),a(document).on(this.events.click_close,function(c){var d=a(c.target);c.target!=b.$element.get(0)&&(d.closest("#calendar").length||("datepicker"==d.data("toggle")||"datepickerbtn"==d.parent().data("toggle")||"datepickerbtn"==d.data("toggle")?h.closeCalendar(!1):h.closeCalendar(!0)))}),this.create(i,j,n)},t.prototype.create=function(d,e,f){var u,v,w,x,y,z,A,g=this,o=this.options,q=this.tools,r=new Date(d.year,d.month-1,1),s=r.getDay(),t="";if(s>0)for(r.setMonth(r.getMonth()-1),u=q.getDateWrap(r),v=u.days-s+1;v<=u.days;v++)w=new Date(d.year,d.month-2,v),x=w>=e&&f>=w?"":" disabled",t+='<dd class="other'+x+'" data-month="-1" data-day="'+v+'">'+v+"</dd>";for(v=1;v<=d.days;v++)w=new Date(d.year,d.month-1,v),x=w>=e&&f>=w?"":"disabled",v==d.day&&(x+=" slt"),t+='<dd class="'+x+'" data-day="'+v+'">'+v+"</dd>";for(v=1;v<=42-s-d.days;v++)w=new Date(d.year,d.month,v),x=w>=e&&f>=w?"":" disabled",t+='<dd class="other'+x+'" data-month="1" data-day="'+v+'">'+v+"</dd>";y=p.html(t).find("dd"),y.not(".disabled").off(this.events.click_days).on(this.events.click_days,function(){var c,b=a(this);q.hasTime()?(y.removeClass("slt"),b.addClass("slt")):(c=q.changeDay(b.data("day"),b.data("month")),q.closeCalendar(!0),g.$element.val(q.formatDate(c)).focus(),q.afterChange(c))}),q.hasDate()?c.removeClass("nodate"):c.addClass("nodate"),q.hasTime()?(h.show(),k.val(d.hour<10?"0"+d.hour:d.hour).off(this.events.focus_time).on(this.events.focus_time,function(){q.changeTmMenu("hh")}),z=parseInt(d.minute/o.mmStep)*o.mmStep,l.val(10>z?"0"+z:z).data("step",o.mmStep).off(this.events.focus_time).on(this.events.focus_time,function(){q.changeTmMenu("mm")}),m.val(q.hasSecond()?d.second<10?"0"+d.second:d.second:"00").data("step",o.ssStep).off(this.events.focus_time).on(this.events.focus_time,function(){q.changeTmMenu("ss")}),b.off("click").on("click",function(b){a(b.target).closest(".time").length||(n.find("> ul").hide(),q.changeTmMenu())}),i.off(this.events.keydown_time).on(this.events.keydown_time,q.keydownInt).each(function(){var b=a(this);b.off(g.events.keyup_time).on(g.events.keyup_time,function(){q.changeTm(b)})}).off(this.events.click_time).on(this.events.click_time,function(){q.clickTmMenu(a(this),a(this).data("type"))}),A=null,j.off(this.events.click_spinner).on(this.events.click_spinner,function(b){var c=a(this);i.filter(".slt").each(function(){q.changeTm(a(this),c)}),b.preventDefault()}).off(this.events.mousedown_sp).on(this.events.mousedown_sp,function(){var c=a(this);A=setInterval(function(){i.filter(".slt").each(function(){q.changeTm(a(this),c)})},150)}).off(this.events.mouseup_sp).on(this.events.mouseup_sp,function(){clearTimeout(A)}),q.hasHour()||k.attr("disabled",!0),q.hasMinute()||l.attr("disabled",!0),q.hasSecond()||m.attr("disabled",!0)):h.hide(),this.show()},t.prototype.show=function(){var c=this.$element.offset(),d=c.top+this.$element.get(0).offsetHeight,e=b.outerHeight(!0);d>e&&d>a(window).height()-e&&(d=c.top-e),b.css({left:c.left,top:d}).show().click(function(a){a.stopPropagation()})},v=a.fn.datepicker,a.fn.datepicker=u,a.fn.datepicker.Constructor=t,a.fn.datepicker.noConflict=function(){return a.fn.datepicker=v,this},a(document).on(BJUI.eventType.initUI,function(b){var c=a(b.target).find('[data-toggle="datepicker"]');c.length&&(c.data("nobtn")||u.call(c,"addBtn"))}),a(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepickerbtn"]',function(b){var c=a(this).prevAll('[data-toggle="datepicker"]');c&&c.is(":text")&&(u.call(c,c.data()),b.preventDefault())}),a(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepicker"]',function(b){var c=a(this);c.data("onlybtn")||c.is(":text")&&(u.call(c,c.data()),b.preventDefault())})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.ajaxtab");h||f.data("bjui.ajaxtab",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c};b.DEFAULTS={url:void 0,target:void 0,reload:!1},b.prototype.init=function(){var b,a=this.options;return a.url?(a.url=decodeURI(a.url).replacePlh(this.$element.closest(".unitBox")),a.url.isFinishedTm()?(a.url=encodeURI(a.url),a.target?(a.reload?this.load():(b=this.$element.data("bjui.ajaxtab.reload"),b?this.$element.tab("show"):this.load()),void 0):(BJUI.debug("Ajaxtab Plugin: Attribute 'target' is not defined!"),void 0)):(this.$element.alertmsg("error",a.warn||BJUI.regional.plhmsg),BJUI.debug("Ajaxtab Plugin: The new ajaxtab's url is incorrect, url: "+a.url),void 0)):(BJUI.debug("Ajaxtab Plugin: Error trying to open a tab, url is undefined!"),void 0)},b.prototype.load=function(){var b=this.$element,c=this.options;a(c.target).ajaxUrl({url:c.url,data:{},callback:function(){b.data("bjui.ajaxtab.reload",!0).tab("show")}})},d=a.fn.ajaxtab,a.fn.ajaxtab=c,a.fn.ajaxtab.Constructor=b,a.fn.ajaxtab.noConflict=function(){return a.fn.ajaxtab=d,this},a(document).on("click.bjui.ajaxtab.data-api",'[data-toggle="ajaxtab"]',function(b){var d=a(this),e=d.data();e.url||(e.url=d.attr("href")),c.call(d,e),b.preventDefault()})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend(!0,{},b.DEFAULTS,"object"==typeof c&&c),h=f.data("bjui.datagrid");h||f.data("bjui.datagrid",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS(),this.datanames={tbody:"bjui.datagrid.tbody.dom",td_html:"bjui.datagrid.td.html",changeData:"bjui.datagrid.tr.changeData"},this.classnames={s_checkbox:"datagrid-checkbox",s_linenumber:"datagrid-linenumber",s_edit:"datagrid-column-edit",s_lock:"datagrid-lock",s_menu:"datagrid-menu-box",s_filter:"datagrid-filter-box",s_showhide:"datagrid-showhide-box",th_cell:"datagrid-cell",th_menu:"datagrid-column-menu",btn_menu:"datagrid-column-menu-btn",th_col:"datagrid-col",th_field:"datagrid-col-field",th_sort:"datagrid-sortable",th_resize:"datagrid-resize-head",th_resizemark:"datagrid-column-resizemark",tr_child:"datagrid-child-tr",tr_edit:"datagrid-edit-tr",tr_add:"datagrid-add-tr",tr_selected:"datagrid-selected-tr",td_edit:"datagrid-edit-td",td_changed:"datagrid-changed",td_child:"datagrid-child-td",td_linenumber:"datagrid-linenumber-td",td_checkbox:"datagrid-checkbox-td",li_asc:"datagrid-li-asc",li_desc:"datagrid-li-desc",li_filter:"datagrid-li-filter",li_showhide:"datagrid-li-showhide",li_lock:"datagrid-li-lock",li_unlock:"datagrid-li-unlock"}};b.DEFAULTS={gridTitle:"",columns:null,data:null,dataUrl:null,updateRowUrl:null,postData:null,loadType:"POST",dataType:"json",local:"remote",fieldSortable:!0,filterThead:!0,sortAll:!1,filterAll:!1,filterMult:!0,selectMult:!1,linenumberAll:!1,showLinenumber:!0,showCheckboxcol:!1,showChildcol:void 0,showEditbtnscol:!1,showTfoot:!1,showToolbar:!1,showNoDataTip:!0,toolbarItem:"",toolbarCustom:"",columnResize:!0,columnMenu:!0,columnShowhide:!0,columnFilter:!1,columnLock:!0,paging:!0,pagingAlign:"center",hasChild:!1,childOptions:{width:"100%",height:"auto",paging:!1,columnMenu:!1,filterThead:!1,childUpdate:!1},editUrl:null,editCallback:null,editMode:"inline",editDialogOp:null,editType:"POST",inlineEditMult:!0,saveAll:!0,addLocation:"first",delUrl:null,delType:"POST",delPK:null,delConfirm:!0,delCallback:null,jsonPrefix:"",contextMenuH:!0,contextMenuB:!1,hScrollbar:!1,fullGrid:!1,importOption:null,exportOption:null,beforeEdit:null,beforeDelete:null,beforeSave:null,afterSave:null,afterDelete:null,clickRow:null,dblOnClick:null,editdblOnclick:!1,issaveallback:null},b.renderItem=function(b,c,d){if(!d||!d.length)return"";var e="";return a.each(d,function(a,c){return"undefined"!=typeof c[b]?(e=c[b],!1):void 0}),e},b.renderItemMulti=function(b,c,d){if(!d||!d.length)return"";var e=[],f="array"===a.type(b)?b:String(b).split(",");return a.each(d,function(b,c){a.each(f,function(a,b){return"undefined"!=typeof c[b]?(e.push(c[b]),!1):void 0})}),e.join(",")},b.prototype.TOOLS=function(){var c=this,d=c.options,e={getPageCount:function(a,b){return Math.ceil(b/a)},getPageInterval:function(a,b,c){var d=Math.ceil(c/2),e=a-c,f=b>d?Math.max(Math.min(b-d,e),0):0,g=b>d?Math.min(b+d,a):Math.min(c,a);return g-f==c&&(g+=1),c>g&&(g+=1),f+1==g&&(g+=1),{start:f+1,end:g}},getRight:function(b){var d=0,e=b.data("index"),f=c.$tbody.find("> tr:first > td:lt("+(e+1)+")");return f&&f.length||(f=c.$colgroupH.find("> col:lt("+(e+1)+")")),f.each(function(){var b=a(this),c=b.is(":hidden")?0:b.outerWidth();d+=c}),d},getRight4Lock:function(b){var d=0,e=c.$lockTbody.find("> tr:first > td:eq("+b+")"),f=e&&e.prevAll().add(e);return f&&f.length||(f=c.$lockColgroupH.filter(":lt("+(b+1)+")")),f.each(function(){var b=a(this),c=b.is(":hidden")?0:b.outerWidth();d+=c}),d},beforeEdit:function(a,b){var e=d.beforeEdit;return e&&("string"==typeof e&&(e=e.toFunc()),"function"==typeof e)?e.call(c,a,b):!0},beforeSave:function(a,b){var e=d.beforeSave;return e&&("string"==typeof e&&(e=e.toFunc()),"function"==typeof e)?e.call(c,a,b):!0},afterSave:function(b,e){var j,k,m,n,l,f=d.afterSave,g=c.options.childUpdate,h=c.$element.data("bjui.datagrid.parent"),i=function(a){a.closest("table").datagrid("updateRow",a)};f&&("string"==typeof f&&(f=f.toFunc()),"function"==typeof f&&f.call(c,b,e)),b.each(function(){a(this).removeData("datagrid.addData")}),h&&g&&("string"==typeof g&&-1===g.indexOf("all")?e.addFlag&&-1!==g.indexOf("add")?i(h):-1!==g.indexOf("edit")&&i(h):i(h)),c.fixedColumnWidth&&(l=a('<div class="bjui-datagrid"></div>'),a.each(c.columnModel,function(b,d){d.fixedWidth&&(j||(j=c.$element.clone().addClass("table table-bordered").appendTo(l),j.prepend(c.$thead.clone()),l.appendTo(a("body")),j.attr("style","width:auto !important;").initui(),j.find("colgroup").remove(),j.find(".datagrid-filter").remove()),k=j.find("> tbody > tr:first-child"),k.hasClass("datagrid-nodata")?(rowspan=c.$trsH.length>1?c.$trsH.length-parseInt(d.th.attr("rowspan")||1,10):0,m=j.find("> thead > tr:eq("+rowspan+") > th:eq("+d.th.index()+")").css("width",""),n=m.outerWidth()+5):(m=j.find("> tbody > tr:first-child > td:eq("+b+")").css({width:"","white-space":"nowrap"}),n=m.outerWidth()+5),c.$colgroupH.find("> col").eq(b).css("width",n),c.$colgroupB.find("> col").eq(b).css("width",n),c.$colgroupF&&c.$colgroupF.find("> col").eq(b).css("width",n))}),l&&l.remove(),c.fixedColumnWidth=null),"auto"===d.height&&(c.$boxB.scrollTop(5),c.$boxB.scrollTop&&c.fixedHeight())},afterDelete:function(){var a=d.afterDelete;a&&("string"==typeof a&&(a=a.toFunc()),"function"==typeof a&&a.call(c))},setColspan:function(a,b){a.colspan&&(a.colspan=a.colspan+b-1),a.index=a.index+b-1,a.parent&&this.setColspan(a.parent,b)},setOp:function(a){return a.name?(a.menu="undefined"==typeof a.menu?!0:a.menu,a.lock="undefined"==typeof a.lock?!0:a.lock,a.edit="undefined"==typeof a.edit?!0:a.edit,a.add="undefined"==typeof a.add?!0:a.add,a.quicksort="undefined"==typeof a.quicksort?!0:a.quicksort,a.quickfilter="undefined"==typeof a.quickfilter?!0:a.quickfilter):a.menu=a.lock=a.edit=a.add=a.quickSort=a.quickfilter=!1,a.hide="undefined"==typeof a.hide?!1:a.hide,a},createTrsByData:function(b,d){var f;c.$tbody||(c.$tbody=a("<tbody></tbody>")),b&&(f=b.data?b.data:b,c.paging.total=f.length||0,c.paging.total||(f=[]),"object"==typeof b&&c.paging.total&&(b[BJUI.pageInfo.total]&&(c.paging.total=parseInt(b[BJUI.pageInfo.total],10)),b[BJUI.pageInfo.pageSize]&&(d&&c.paging.pageSize!=b[BJUI.pageInfo.pageSize]&&c.$boxP&&c.$boxP.trigger("bjui.datagrid.paging.pageSize",b[BJUI.pageInfo.pageSize]),c.paging.pageSize=parseInt(b[BJUI.pageInfo.pageSize],10))),c.paging.pageCount=e.getPageCount(c.paging.pageSize,c.paging.total),c.paging.pageCurrent>c.paging.pageCount&&(c.paging.pageCurrent=c.paging.pageCount),c.paging.pageCurrent||(c.paging.pageCurrent=1),this.initTbody(f,d)),c.init_tbody||c.$tbody.appendTo(c.$tableB),c.init_thead||c.initThead()},initTbody:function(b,e){var n,f=this,g=c.allData,h=d.dataType||"json",i=c.columnModel,j=c.hiddenFields,l=(c.regional,[]),m=c.attach,o=c.paging,p=0,q=o.pageSize,r=function(){var t,k,r,s,u;if(h=h.toLowerCase(),b&&(g=c.allData=b),"local"===d.local&&c.$element.data("allData",b),g.length?"local"===d.local?(p=o.pageSize*(o.pageCurrent-1),q=p+o.pageSize,o.total!=g.length&&(o.total=g.length),p>g.length&&(p=o.pageSize*(o.pageCount-1))):g.length>o.pageSize&&(q=o.pageSize):q=0,q>g.length&&(q=g.length),"array"===h&&b&&b.length&&"array"===a.type(b[0])){for(k=p,r=q,s=[],"local"===d.local&&(k=0,r=g.length),u=k;r>u;u++)n={},t=0,a.each(g[u],function(b,c){var d,e=c;i[t]&&i[t].gridNumber&&t++,i[t]&&i[t].gridCheckbox&&t++,"string"==typeof e&&(e='"'+e+'"'),i[t]&&!i[t].gridEdit?(d='{"'+i[t].name+'":'+e+"}",a.extend(n,JSON.parse(d))):(i[t]&&i[t].gridEdit&&t++,t>=i.length&&j&&j[b-i.length]&&(d='{"'+j[b-i.length]+'":'+e+"}",a.extend(n,JSON.parse(d)))),t++}),s.push(n);g=c.allData=s}for(u=p;q>u;u++)n=a.extend({},c.allData[u],m),l.push(n);f.createTrs(l,e),c.data=l,c.$element.trigger("afterLoad.bjui.datagrid",{datas:l}),c.init_tfoot&&c.initTfoot()};e&&c.$boxM?c.$boxM.show().trigger("bjui.ajaxStop").trigger("bjui.ajaxStart",[50,r]):r()},createTrs:function(b,e){var n,o,p,q,r,w,z,A,B,C,D,E,F,s,t,u,v,x,G,H,I,f=this,g=c.columnModel,h=c.paging,i=[],j=BJUI.doRegional(FRAG.gridEditBtn,c.regional),k=BJUI.doRegional(FRAG.gridExpandBtn,c.regional),m=!1;
    for(e&&(a.each(g,function(a,b){b.locked&&(c.colLock(b.th,!1),b.lock_refresh=!0)}),c.$tbody.empty(),c.$lockTableH&&c.$lockTableH.empty(),c.$lockTableB&&c.$lockTableB.empty()),b.length||e||(n={},n[g[0].name]="0",m=!0,b=[],b.push(n)),o=(new Date).getTime(),c.begintime=o,p=!0,q=0,r=b.length;r>q;q++){for(s=b[q],t=g.length,u=d.linenumberAll?(h.pageCurrent-1)*h.pageSize+(q+1):q+1,v=[],x=BJUI.StrBuilder(),a.extend(s,{gridNumber:u,gridIndex:q}),G=0;t>G;G++)w=g[G],z=w.name||"datagrid-noname",A=s[z],D="",E=[],B="",F="",C="",("undefined"==typeof A||"null"===A||null===A)&&(A=""),B=A,w.align&&(D=' align="'+w.align+'"'),w.gridChild&&(A=k),w.gridCheckbox&&(A='<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'),w.gridEdit&&(A=j,E.push(c.classnames.s_edit)),w.calc&&(w.calc_count||(w.calc_count=b.length),H=A?String(A).isNumber()?Number(A):0:0,"sum"===w.calc||"avg"===w.calc?p?(w.calc_sum=H,p=!1):w.calc_sum=(w.calc_sum||0)+H:"max"===w.calc?w.calc_max=w.calc_max?w.calc_max<H?H:w.calc_max:H:"min"===w.calc&&(w.calc_min=w.calc_min?w.calc_min>H?H:w.calc_min:H)),w.gridChild&&E.push(c.classnames.td_child),w.gridNumber&&E.push(c.classnames.td_linenumber),w.gridCheckbox&&E.push(c.classnames.td_checkbox),E=E.length?' class="'+E.join(" ")+'"':"",e&&w.hidden&&(F=' style="display:none;"'),w.items&&!w.render&&(w.render=w.attrs&&w.attrs["multiple"]?a.datagrid.renderItemMulti:a.datagrid.renderItem),w.render&&"string"==typeof w.render&&(w.render=w.render.toFunc()),w.render&&"function"==typeof w.render&&(w.items?("string"==typeof w.items&&(w.items=w.items.trim().startsWith("[")?w.items.toObj():w.items.toFunc()),c.renderTds||(c.renderTds=[]),I=function(b,d,e,f){a.when(f.items.call(c)).done(function(a){f.items=a,c.delayRender--})},"function"==typeof w.items?(q||(c.delayRender||(c.delayRender=0),c.delayRender++,I(q*G,B,s,w)),c.renderTds.push({trindex:q,tdindex:G,label:B,data:s,render:w.render})):C=w.render.call(c,B,s,w.items)):C=w.render.call(c,B,s)),x.add("<td").add(D).add(E).add(F).add("><div>").add(C||A).add("</div></td>"),v.push(x.toString());i.push("<tr>"+v.join("")+"</tr>"),m?(i=[],i.push(f.createNoDataTr(!0)||"")):i.push(f.createChildTr(null,s))}c.$tbody.html(i.join("")),e&&(c.initEvents(),d.editMode&&c.edit(),b.length||f.createNoDataTr(),c.$boxP&&c.$boxP.trigger("bjui.datagrid.paging.jump"),a.each(g,function(a,b){b.lock_refresh&&(c.colLock(b.th,!0),delete b.lock_refresh)}),setTimeout(function(){c.$tableB.initui(),c.$lockTableB&&c.$lockTableB.initui(),c.fixedHeight(),c.$boxM&&c.$boxM.trigger("bjui.ajaxStop").hide()},b.length+1))},replacePlh:function(a,b){return a.replace(/{\/?[^}]*}/g,function(a){var c=a.replace(/[{}]+/g,""),d=b[c];return("undefined"==typeof d||"null"===d||null===d)&&(d=""),d})},createNoDataTr:function(b){if(c.options.showNoDataTip){if(b)return'<tr class="datagrid-nodata"><td colspan="'+c.columnModel.length+'">'+("string"==typeof c.options.showNoDataTip?c.options.showNoDataTip:BJUI.getRegional("datagrid.noData"))+"</td></tr>";c.$tbody.find("> tr").length||a('<tr class="datagrid-nodata"></tr>').html('<td colspan="'+c.columnModel.length+'">'+("string"==typeof c.options.showNoDataTip?c.options.showNoDataTip:BJUI.getRegional("datagrid.noData"))+"</td>").appendTo(c.$tbody)}},createChildTr:function(e){if(!(e&&e.next()&&e.next().hasClass(c.classnames.tr_child))&&d.hasChild&&d.childOptions&&d.childOptions.dataUrl){c.childOptions=a.extend(!0,{},b.DEFAULTS,d.childOptions);var g='<tr class="'+c.classnames.tr_child+'"><td colspan="'+c.columnModel.length+'" style="width:100%; padding:10px; background:#FAFAFA;"><table class="table-child"></table></td></tr>';if(!e||!e.length)return g;e.after(g)}},getNoChildTrIndex:function(a){var b;if(isNaN(a)){if(!a||!a.length)return-1;b=a.index()}else b=parseInt(a,10);return c.options.hasChild&&c.options.childOptions&&(b=2*b),b},getNoChildDataIndex:function(a){var b;return b=isNaN(a)?this.getNoChildTrIndex(a):parseInt(a,10),-1===b?b:(c.options.hasChild&&c.options.childOptions&&(b/=2),b)},loadData:function(b,e){var f=this,g=d.dataUrl,h=d.dataType||"json";c.columnModel,c.$boxM&&c.$boxM.show().trigger("bjui.ajaxStart"),h=h.toLowerCase(),"array"===h&&(h="text"),d.postData&&("string"==typeof d.postData&&(d.postData=d.postData.trim().startsWith("{")?d.postData.toObj():d.postData.toFunc()),"function"==typeof d.postData&&(d.postData=d.postData.apply()),"object"==typeof d.postData&&(b=b?a.extend({},d.postData,b):d.postData)),BJUI.ajax("doajax",{url:g,data:b||{},type:d.loadType,cache:d.cache||!1,dataType:h,xhrFields:{withCredentials:!0},headers:{Cookie:document.cookie},crossDomain:!0,okCallback:function(b){if("json"===h)f.createTrsByData(b,e);else if("text"===h)"array"!==a.type(b)&&(b=[]),f.createTrsByData(b,e);else if("xml"===h){var d,c=[];a(b).find("row").each(function(){d={},a(this).find("cell").each(function(){var c=a(this),e=c.text(),f=c.attr("name");d[f]=e}),c.push(d)}),c.length&&f.createTrsByData(c,e)}else BJUI.debug("Datagrid Plugin: The options 'dataType' is incorrect!")},errCallback:function(){c.destroy()},failCallback:function(){c.destroy()}})},appendColumns:function(){c.childColumn={name:"gridChild",gridChild:!0,width:30,minWidth:30,label:"...",align:"center",menu:!1,edit:!1,quicksort:!1},c.linenumberColumn={name:"gridNumber",gridNumber:!0,width:30,minWidth:30,label:"No.",align:"center",menu:!1,edit:!1,quicksort:!1},c.checkboxColumn={name:"gridCheckbox",gridCheckbox:!0,width:30,minWidth:30,label:"Checkbox",align:"center",menu:!1,edit:!1,quicksort:!1},c.editBtnsColumn={name:"gridEdit",gridEdit:!0,width:110,minWidth:110,label:"string"==typeof d.showEditbtnscol?d.showEditbtnscol:"菜单",align:"center",menu:!1,edit:!1,hide:!1,quicksort:!1}},setBoxbH:function(a){var f,b=a||c.boxH||d.height,e=0;100>b||(isNaN(b)&&("auto"===b?(b=(c.$boxT?c.$boxT.outerHeight():0)+(c.$boxH?c.$boxH.outerHeight():0)+(c.$toolbar?c.$toolbar.outerHeight():0)+(c.$boxP?c.$boxP.outerHeight():0)+(c.$boxB?c.$boxB.outerHeight():0)+(c.$boxF?c.$boxF.outerHeight():0)+25,c.$grid.height(b),c.boxH=b):b=c.$grid.height()),c.$boxT&&(f=c.$boxT.outerHeight(),b-=f,e+=f),c.$toolbar&&(f=c.$toolbar.outerHeight(),b-=f,e+=f),c.$boxP&&(b-=c.$boxP.outerHeight()),c.$boxF&&(b-=c.$boxF.outerHeight()),e+=c.$tableH.outerHeight(),b-=c.$boxH.outerHeight(),0>b&&(b=0),c.$boxB.height(b),c.$boxM.height(b).css({top:e}),c.$lockB&&c.$lockB.height(b),c.$element.data("bjui.datagrid.parent")&&c.$element.data("bjui.datagrid.parent").closest("table").datagrid("fixedHeight"))},showSubMenu:function(b,d,e){var f,i,g=d.outerWidth(),h=e.data("width")||e.outerWidth(),j=c.$boxH.width(),k=function(b,d,e){f=d.offset().left-c.$grid.offset().left-1,i={left:"50%"},b.removeClass("active"),d.hasClass("position-right")||g+h>j-f?(e.css({left:"auto",right:"100%"}),i={right:"50%"}):e.css({left:"100%",right:"auto"}),i.opacity=.2,e.stop().animate(i,"fast",function(){a(this).hide()})};b.hover(function(){if(e.appendTo(b),b.hasClass(c.classnames.li_filter)&&e.is(":visible"))return!1;var a=b.siblings("."+c.classnames.li_filter);a.length&&a.hasClass("active")&&k(a,d,a.find("> ."+c.classnames.s_filter)),f=d.offset().left-c.$grid.offset().left-1,i={left:"100%"},d.hasClass("position-right")||g+h>j-f?(e.css({left:"auto",right:"50%"}),i={right:"100%"}):e.css({left:"50%",right:"auto"}),i.opacity=1,b.addClass("active"),e.show().stop().animate(i,"fast")},function(){return b.hasClass(c.classnames.li_filter)?!1:(k(b,d,e),void 0)}),b.on("bjui.datagrid.th.submenu.hide",function(b,c,d){k(a(this),c,d)})},locking:function(a){var b=a.data("index"),d=c.columnModel[b],e=d.lock,f=d.locked,g=c.$menu,h=g.find("> ul"),i=h.find("> li."+c.classnames.li_lock),j=i.next();f?(i.addClass("disable"),j.removeClass("disable")):(j.addClass("disable"),i.removeClass("disable")),e?(i.show().off("click").on("click",function(){i.hasClass("disable")||(g.hide().data("bjui.datagrid.menu.btn").removeClass("active"),c.colLock(a,!0))}),j.show().off("click").on("click",function(){j.hasClass("disable")||(g.hide().data("bjui.datagrid.menu.btn").removeClass("active"),c.colLock(a,!1))})):(i.hide().off("click"),j.hide().off("click"))},createShowhide:function(){var b;c.$showhide||(c.col_showhide_count=c.columnModel.length,b=a('<ul class="'+c.classnames.s_showhide+'" role="menu"></ul>'),a.each(c.columnModel,function(d,e){var f,g;(e.gridNumber||e.gridCheckbox||e.gridEdit)&&c.col_showhide_count--,f=a(FRAG.gridShowhide.replaceAll("#index#",e.index).replaceAll("#label#",e.label||"")).toggleClass("nodisable",!!(e.gridNumber||e.gridCheckbox||e.gridEdit)),g=function(d){f.click(function(){if(a(this).hasClass("disable"))return!1;var e=a(this),f=!e.find("i").hasClass("fa-check-square-o");d.index,e.toggleClass("datagrid-col-check").find("i").attr("class","fa fa"+(f?"-check":"")+"-square-o"),c.showhideColumn(d.th,f),d.gridNumber||d.gridCheckbox||d.gridEdit||(c.col_showhide_count=f?c.col_showhide_count+1:c.col_showhide_count-1),1==c.col_showhide_count?b.find("> li.datagrid-col-check").addClass("disable"):b.find("> li.disable").removeClass("disable"),b.find("> li.nodisable").removeClass("disable")})},g(e),f.appendTo(b),e.hide&&f.trigger("click")}),b.appendTo(c.$grid),b.data("width",b.outerWidth()),c.$showhide=b)},showhide:function(a,b){var d=a.index,e=a.th,f=c.$tbody.find("> tr"),g=b?"":"none",h=function(a){var c=a.colspan;b?c++:c--,c?a.th.css("display",""):a.th.css("display","none"),a.th.attr("colspan",c),a.colspan=c,a.parent&&h(a.parent)};"undefined"==typeof a.hidden&&(a.hidden=!1),a.hidden!==!b&&(a.hidden=!b,e.css("display",g),f.find("> td:eq("+d+")").css("display",g),c.$colgroupH.find("> col").eq(d).css("display",g),c.$colgroupB.find("> col").eq(d).css("display",g),c.$thead.find("> tr.datagrid-filter > th:eq("+d+")").css("display",g),c.$boxF&&(c.$tableF.find("> thead > tr > th:eq("+d+")").css("display",g),c.$colgroupF.find("> col").eq(d).css("display",g)),a.calc&&c.$tfoot&&c.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),a.parent&&h(a.parent),c.$tbody.find("> tr."+c.classnames.tr_child+":visible > td table").trigger("bjui.datagrid.child.resize"))},jumpPage:function(a,b){var f,e=c.allData;a&&(c.paging.oldPageCurrent=c.paging.pageCurrent,c.paging.pageCurrent=a),b&&(c.paging.oldPageSize=c.paging.pageSize,c.paging.pageSize=b,c.paging.pageCount=this.getPageCount(b,c.paging.total),c.paging.pageCurrent>c.paging.pageCount&&(c.paging.pageCurrent=c.paging.pageCount)),"remote"===d.local?(f=this.getRemoteFilterData(!0),this.loadData(f,!0)):this.initTbody(e,!0)},quickSort:function(a){var g,h,b,e,f,i,j,k,l;if(c.isDom){if("local"===d.local)return;d.sortAll=!0}return c.$tbody.find("> tr."+c.classnames.tr_edit).length?(c.$tbody.alertmsg("info",BJUI.getRegional("datagrid.editMsg")),void 0):(b=a.th,e=c.data,f=c.allData,i=a.name,j=a.type,k=c.$thead.find("> tr > th.datagrid-quicksort-th"),i||(i="datagrid-noname"),l=function(b){b.sort(function(b,c){var d=typeof b[i],e=typeof c[i];return"boolean"===j||"number"===j||(d="number"===e)||(d="boolean"===e)?a.sortAsc?b[i]-c[i]:c[i]-b[i]:a.sortAsc?String(b[i]).localeCompare(c[i]):String(c[i]).localeCompare(b[i])})},k.find("> div > .datagrid-label > i").remove(),a.sortAsc?(h="desc",a.sortAsc=!1):(h="asc",a.sortAsc=!0),b.find("> div > .datagrid-label").prepend('<i class="fa fa-long-arrow-'+(a.sortAsc?"up":"down")+'"></i>'),d.sortAll?"remote"===d.local?(g={},g[BJUI.pageInfo.orderField]=i,g[BJUI.pageInfo.orderDirection]=h,g[BJUI.pageInfo.pageSize]=c.paging.pageSize,g[BJUI.pageInfo.pageCurrent]=c.paging.pageCurrent,this.loadData(g,!0)):(l(f),this.initTbody(f,!0)):(l(e),this.createTrs(e,!0)),void 0)},quickFilter:function(b,e){var l,f,h,i,j,m,n;if(c.isDom){if("remote"!=d.local)return BJUI.debug("Datagrid Plugin: Please change the local option is remote!"),void 0;if(!d.dataUrl)return BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!"),void 0}f=this,b.th,h=c.data,i=c.allData,j=b.name,m=function(b,c,d,e){var f=!1;switch(b){case"=":f=String(c)===String(d);break;case"!=":f=String(c)!==String(d);break;case">":f=parseFloat(d)>parseFloat(c);break;case"<":f=parseFloat(d)<parseFloat(c);break;case"like":e&&"select"===e.type?(f=String(c)===String(d),e.attrs&&e.attrs.multiple&&a.isArray(c)&&(f=-1!=a.inArray(d,c))):f=String(d).indexOf(String(c))>=0}return f},n=function(b,c){var d=function(b){var d=0;return a.each(c,function(a,c){var e=c.datas;return d++,e?(c.model.isFiltered=!0,c.model.th.trigger("bjui.datagrid.th.filter",[!0]),e.andor?"and"===e.andor?m(e.operatorA,e.valA,b[a],c.model)&&m(e.operatorB,e.valB,b[a],c.model)&&d--:"or"===e.andor&&(m(e.operatorA,e.valA,b[a],c.model)||m(e.operatorB,e.valB,b[a],c.model))&&d--:e.operatorB?m(e.operatorB,e.valB,b[a],c.model)&&d--:m(e.operatorA,e.valA,b[a],c.model)&&d--,void 0):(d--,c.model.isFiltered=!1,c.model.th.trigger("bjui.datagrid.th.filter",[!1]),c.model.$quickfilter&&c.model.$quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0)}),d?!1:!0};return a.grep(b,function(a){return d(a)})},c.filterDatas||(c.filterDatas={}),d.filterMult?c.filterDatas[j]={datas:e,model:b}:(c.filterDatas={},c.filterDatas[j]={datas:e,model:b}),"remote"!==d.local&&i&&(c.oldAllData?i=c.oldAllData.concat():c.oldAllData=i.concat()),d.filterAll?"remote"===d.local?f.loadData(f.getRemoteFilterData(),!0):(l=n(i,c.filterDatas),c.paging.pageCurrent=1,c.paging.pageCount=this.getPageCount(c.paging.pageSize,l.length),this.initTbody(l,!0)):c.isDom?f.loadData(f.getRemoteFilterData(),!0):(c.oldData?h=c.oldData.concat():c.oldData=h.concat(),l=n(h,c.filterDatas),this.createTrs(l,!0))},getRemoteFilterData:function(b){var g={};return c.filterDatas&&!a.isEmptyObject(c.filterDatas)&&(a.each(c.filterDatas,function(a,b){return b.datas?(b.model.isFiltered=!0,b.model.th.trigger("bjui.datagrid.th.filter",[!0]),d.jsonPrefix&&(a=d.jsonPrefix+"."+a),b.datas.andor&&(g["andor"]=b.datas.andor),b.datas.operatorA&&(g[a]=b.datas.valA,g[a+".operator"]=b.datas.operatorA),b.datas.operatorB&&(g[a]?(g[a]=[g[a],b.datas.valB],g[a+".operator"]=[g[a+".operator"],b.datas.operatorB]):(g[a]=b.datas.valB,g[a+".operator"]=b.datas.operatorB)),void 0):(b.model.isFiltered=!1,b.model.th.trigger("bjui.datagrid.th.filter",[!1]),b.model.$quickfilter&&b.model.$quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0)}),b||(c.paging.pageCurrent=1)),g[BJUI.pageInfo.pageSize]=c.paging.pageSize,g[BJUI.pageInfo.pageCurrent]=c.paging.pageCurrent,c.$element.data("filterDatas",g),g},setDomData:function(b){var d=c.columnModel,e={},f=b.attr("data-hidden-datas"),g=c.attach;return b.find("> td").each(function(b){var c=a(this),f=d[b],g=c.attr("data-val")||c.text();f.name?e[f.name]=g:e["datagrid-noname"+b]=g}),f&&(f=f.toObj()),a.extend(e,g,{gridNumber:b.index()+1},f),b.data("initData",e),e},initEditInputs:function(){var b=c.columnModel;return c.inputs=[],a.each(b,function(b,d){var e=d.name,f="",g="",h=[],i="";if(d)if(d.attrs&&"object"==typeof d.attrs&&a.each(d.attrs,function(a,b){"object"==typeof b&&(b=JSON.stringify(b).replaceAll('"',"'")),i+=" "+a+"="+b}),d===c.childColumn||d===c.linenumberColumn||d===c.checkboxColumn||d===c.editBtnsColumn)c.inputs.push("");else if(e)if(d.rule?f=' data-rule="'+d.label+"："+d.rule+'"':"date"===d.type&&(f=' data-rule="pattern('+(d.pattern||"yyyy-MM-dd")+')"'),d.type)switch(d.type){case"date":d.pattern||(d.pattern="yyyy-MM-dd"),g=' data-pattern="'+d.pattern+'"',c.inputs.push('<input type="text" name="'+e+'" data-toggle="datepicker"'+g+f+i+">");break;case"select":if(!d.items)return;a.each(d.items,function(b,c){a.each(c,function(a,b){h.push('<option value="'+a+'">'+b+"</option>")})}),c.inputs.push('<select name="'+e+'" data-toggle="selectpicker"'+f+i+' data-width="100%">'+h.join("")+"</select>");break;case"boolean":c.inputs.push('<input type="checkbox" name="'+e+'" data-toggle="icheck"'+f+i+' value="true">');break;case"lookup":c.inputs.push('<input type="text" name="'+e+'" data-toggle="lookup" data-custom-event="true"'+f+i+">");break;case"findgrid":c.inputs.push('<input type="text" name="'+e+'" data-toggle="findgrid" data-custom-event="true"'+f+i+">");break;case"spinner":c.inputs.push('<input type="text" name="'+e+'" data-toggle="spinner"'+f+i+">");break;case"textarea":c.inputs.push('<textarea data-toggle="autoheight" rows="1"'+f+i+"></textarea>");break;default:c.inputs.push('<input type="text" name="'+e+'"'+f+i+">")}else c.inputs.push('<input type="text" name="'+e+'"'+f+i+">");else c.inputs.push("")}),c.inputs},contextmenuH:function(){var b=this;c.$tableH.on("contextmenu","tr:not(.datagrid-filter)",function(d){var e,f;c.$showhide||b.createShowhide(),e=d.pageX,f=d.pageY,a(window).width()<e+c.$showhide.width()&&(e-=c.$showhide.width()),a(window).height()<f+c.$showhide.height()&&(f-=c.$showhide.height()),c.$menu&&c.$grid.trigger("click.bjui.datagrid.filter"),c.$showhide.appendTo("body").css({left:e,top:f,opacity:1,"z-index":9999}).show(),a(document).on("click",function(b){var d=a(b.target).closest("."+c.classnames.s_showhide);d.length||c.$showhide.css({left:"50%",top:0,opacity:.2,"z-index":""}).hide().appendTo(c.$grid)}),d.preventDefault(),d.stopPropagation()})},contextmenuB:function(a,b){a.contextmenu("show",{exclude:"input, .bootstrap-select",items:[{icon:"refresh",title:BJUI.getRegional("datagrid.refresh"),func:function(){c.refresh()}},{title:"diver"},{icon:"plus",title:BJUI.getRegional("datagrid.add"),func:function(){c.add()}},{icon:"edit",title:BJUI.getRegional("datagrid.edit"),func:function(a){var e=a;b&&(e=c.$tbody.find("> tr:eq("+e.index()+")")),c.doEditRow(e)}},{icon:"undo",title:BJUI.getRegional("datagrid.cancel"),func:function(a){var e=a;b&&(e=c.$tbody.find("> tr:eq("+e.index()+")")),e.hasClass(c.classnames.tr_edit)||(e=c.$tbody.find("> tr."+c.classnames.tr_edit)),c.doCancelEditRow(e)}},{icon:"remove",title:BJUI.getRegional("datagrid.del"),func:function(a){var e=a;b&&(e=c.$tbody.find("> tr:eq("+e.index()+")")),c.delRows(e)}}]})}};return e},b.prototype.init=function(){if(this.$element.isTag("table")&&!this.$element.data("bjui.datagrid.init")){this.$element.data("bjui.datagrid.init",!0);var b=this,c=b.options,d=b.tools,f=(b.$element.parent(),BJUI.StrBuilder());if(c.height=c.height||"auto",b.isDom=!1,b.columnModel=[],b.inputs=[],b.regional=BJUI.regional.datagrid,f.add('<div class="bjui-datagrid">').add(c.gridTitle?'<div class="datagrid-title">'+c.gridTitle+"</div>":"").add(c.showToolbar?'<div class="datagrid-toolbar"></div>':"").add('<div class="datagrid-box-h"><div class="datagrid-wrap-h"><table class="table table-bordered"><colgroup></colgroup></table></div></div>').add('<div class="datagrid-box-b"><div class="datagrid-wrap-b"></div></div>').add('<div class="datagrid-box-m"></div>').add(c.paging?'<div class="datagrid-paging-box"></div>':"").add("</div>"),b.$grid=a(f.toString()).insertAfter(b.$element).css("height",c.height),b.$boxH=b.$grid.find("> div.datagrid-box-h"),b.$boxB=b.$boxH.next(),b.$boxM=b.$boxB.next().css("height",c.height),b.$boxP=c.paging?b.$boxM.next():null,b.$boxT=c.gridTitle?b.$grid.find("> div.datagrid-title"):null,b.$toolbar=c.showToolbar?b.$boxH.prev():null,b.$tableH=b.$boxH.find("> div > table"),b.$tableB=b.$element,b.$grid.data("bjui.datagrid.table",b.$element.clone()),b.$boxB.find("> div").append(b.$element),b.initTop(),"string"==typeof c.paging&&(c.paging=c.paging.toObj()),b.paging=a.extend({},{pageSize:3e3,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5},"object"==typeof c.paging&&c.paging),b.attach={gridNumber:0,gridCheckbox:"#checkbox#",gridEdit:"#edit#"},b.$thead=b.$element.find("> thead"),b.$tbody=b.$element.find("> tbody"),b.$tbody&&b.$tbody.find("> tr").length)b.isDom=!0,b.setColumnModel(),b.$tbody.find("> tr > td").each(function(){var b=a(this),c=b.html();b.html("<div>"+c+"</div>")}),b.paging.total?b.paging.pageCount=d.getPageCount(b.paging.pageSize,b.paging.total):(b.paging.total=b.$tbody.find("> tr").length,b.paging.pageCount=1),b.paging.pageCurrent=1,b.initThead();else{if(b.$tbody=null,b.$element.find("> tbody").remove(),c.columns)"string"==typeof c.columns&&(c.columns=c.columns.trim().startsWith("[")?c.columns.toObj():c.columns.toFunc()),"function"==typeof c.columns&&(c.columns=c.columns.call()),b.$thead=null,b.$element.find("> thead").remove(),b.createThead();else{if(!(b.$thead&&b.$thead.length&&b.$thead.find("> tr").length))return BJUI.debug("Datagrid Plugin: No set options 'columns' !"),b.destroy(),void 0;b.setColumnModel()}c.data||c.dataUrl?b.createTbody():(BJUI.debug("Datagrid Plugin: No options 'data' or 'dataUrl'!"),b.destroy())}}},b.prototype.setColumnModel=function(){var h,i,b=this,c=b.options,d=b.$thead.find("> tr"),e=[],f=[],g=d.length;b.isDom||(b.tools.appendColumns(),i=g>1?' rowspan="'+g+'"':"",c.showCheckboxcol&&(b.columnModel.push(b.checkboxColumn),"lock"===c.showCheckboxcol&&(b.checkboxColumn.initLock=!0),h=a('<th class="'+b.classnames.td_checkbox+'"'+i+'><input type="checkbox" data-toggle="icheck"></th>'),h.prependTo(d.first()),i&&h.data("datagrid.column",b.checkboxColumn)),c.showLinenumber&&(b.columnModel.unshift(b.linenumberColumn),"lock"===c.showLinenumber&&(b.linenumberColumn.initLock=!0),h=a('<th class="'+b.classnames.td_linenumber+'"'+i+">No.</th>"),h.prependTo(d.first()),i&&h.data("datagrid.column",b.linenumberColumn)),(c.showChildcol||void 0===c.showChildcol&&c.hasChild&&c.childOptions)&&(b.columnModel.unshift(b.childColumn),h=a('<th class="'+b.classnames.td_child+'"'+i+">...</th>"),h.prependTo(d.first()),i&&h.data("datagrid.column",b.childColumn)),c.showEditbtnscol&&(h=a("<th"+i+">"+b.editBtnsColumn.label+"</th>"),h.appendTo(d.first()),i&&h.data("datagrid.column",b.editBtnsColumn),b.columnModel[h.index()]=b.editBtnsColumn)),d.length&&1==g?d.find("> th").each(function(d){var e=a(this).addClass("single-row").data("index",d),f=e.data("options"),g=e.attr("width")||"auto",h=e.html();b.columnModel.length&&b.columnModel[d]?(f=b.columnModel[d],f.index=d):(f&&"string"==typeof f&&(f=f.toObj()),"object"!=typeof f&&(f={}),f.index=d,f.label=h,f.width="undefined"==typeof f.width?g:f.width,f=b.tools.setOp(f),b.columnModel[d]=f),b.columnModel[d].th=e,e.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+h+'</div><div class="'+b.classnames.th_cell+'"><div class="'+b.classnames.th_resizemark+'"></div></div></div>'),f.menu&&c.columnMenu&&e.addClass(b.classnames.th_menu),c.fieldSortable&&f.quicksort&&e.addClass("datagrid-quicksort-th"),f.align&&e.attr("align",f.align)}):d.each(function(){var g=[],h=[],i=-1,j=0;e.length&&(g=e.concat(),h=f.concat()),e=[],f=[],a(this).find("> th").each(function(){var q,r,k=a(this),l=k.data("options")||k.data("datagrid.column")||{},m=parseInt(k.attr("colspan")||0,10),n=parseInt(k.attr("rowspan")||0,10),o=k.attr("width")||"auto",p=k.html();if(l&&"string"==typeof l&&(l=l.toObj()),"object"!=typeof l&&(l={}),BJUI.isIE(8)&&1===m&&(m=0),l.label=p,l.th=k,l.gridCheckbox&&(l.label="Checkbox"),i++,m){for(l.colspan=m,q=g.length?g[i]:i,r=q;q+m>r;r++)e[j++]=r,f[j-1]=l;i+=m-1,k.data("index",i),g.length&&(l.parent=h[i])}n&&1!=n||k.addClass("single-row"),m?k.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+p+'</div><div class="'+b.classnames.th_cell+'"><div class="'+b.classnames.th_resizemark+'"></div></div></div>'):(l.width="undefined"==typeof l.width?o:l.width,l=b.tools.setOp(l),k.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+p+'</div><div class="'+b.classnames.th_cell+'"><div class="'+b.classnames.th_resizemark+'"></div></div></div>'),l.menu&&c.columnMenu&&k.addClass(b.classnames.th_menu),c.fieldSortable&&l.quicksort&&k.addClass("datagrid-quicksort-th"),l.align&&k.attr("align",l.align),g.length?(l.index=g[i],l.parent=h[i],b.columnModel[g[i]]=l):(l.index=i,b.columnModel[i]=l),k.data("index",l.index))})})},b.prototype.createThead=function(){var g,h,i,j,k,l,m,b=this,c=b.options,d=c.columns,e=[],n=function(c,d,e,f){return d||(d=[]),e||(e=0),d[e]||(d[e]=[]),a.each(c,function(a,c){var h,g=d[e].length;return f&&(c.parent=f),c.columns?(h=c.columns.length,e&&c.parent&&b.tools.setColspan(c.parent,h),c.index=b.columnModel.length+h-1,c.colspan=h,c.quicksort=!1,d[e][g++]=c,n(c.columns,d,e+1,c)):(c.rowspan=e,c.index=b.columnModel.length,c=b.tools.setOp(c),d[e][g++]=c,b.columnModel.push(c),void 0)}),d};b.tools.appendColumns(),c.showCheckboxcol&&(d.unshift(b.checkboxColumn),"lock"===c.showCheckboxcol&&(b.checkboxColumn.initLock=!0)),c.showLinenumber&&(d.unshift(b.linenumberColumn),"lock"===c.showLinenumber&&(b.linenumberColumn.initLock=!0)),(c.showChildcol||void 0===c.showChildcol&&c.hasChild&&c.childOptions)&&d.unshift(b.childColumn),c.showEditbtnscol&&d.push(b.editBtnsColumn),e=n(d,e),b.columnModel[b.columnModel.length-(c.showEditbtnscol?2:1)].lock=!1,c.hiddenFields&&(b.hiddenFields=c.hiddenFields),b.$thead=a("<thead></thead>"),a.each(e,function(d,f){var p,n=a('<tr style="height:25px;"></tr>');a.each(f,function(d,f){g=f.label||f.name,h=f.align?' align="'+f.align+'"':"",i=f.width?' width="'+f.width+'"':"",j=f.colspan?' colspan="'+f.colspan+'"':"",k=e.length-f.rowspan>1?' rowspan="'+(e.length-f.rowspan)+'"':"",l='<div class="'+b.classnames.th_resizemark+'"></div>',m="",f.gridCheckbox&&(g='<input type="checkbox" data-toggle="icheck">'),f.colspan&&(h=' align="center"'),f.thalign&&(h=' align="'+f.thalign+'"'),f.menu&&c.columnMenu&&(m=' class="'+b.classnames.th_menu+'"'),p=a("<th"+m+i+h+j+k+'><div><div class="datagrid-space"></div><div class="datagrid-label">'+g+'</div><div class="'+b.classnames.th_cell+'">'+l+"</div></div></th>"),p.data("index",f.index).appendTo(n),k||p.addClass("single-row"),f.gridChild&&p.addClass(b.classnames.td_child),f.gridNumber&&p.addClass(b.classnames.td_linenumber),f.gridCheckbox&&p.addClass(b.classnames.td_checkbox),c.fieldSortable&&f.quicksort&&p.addClass("datagrid-quicksort-th"),f.th=p}),n.appendTo(b.$thead)}),b.$thead.appendTo(b.$element).initui()},b.prototype.createTbody=function(){var a=this,b=a.options,c=b.data;a.columnModel,c?("string"==typeof c&&(c=c.trim().startsWith("[")||c.trim().startsWith("{")?c.toObj():c.toFunc()),"function"==typeof c&&(c=c.call()),b.data=c,a.tools.createTrsByData(c)):b.dataUrl&&a.tools.loadData()},b.prototype.refresh=function(){var b=this,c=b.options,d=b.tools,f=(b.isDom,BJUI.pageInfo),g=b.paging,h={};return c.dataUrl?(c.postData&&c.postData[f.pageSize]||(h[f.pageSize]=g.pageSize,h[f.pageCurrent]=g.pageCurrent),d.loadData(h,!0),b.filterDatas=null,a.each(b.columnModel,function(a,b){b.th.trigger("bjui.datagrid.th.filter",[!1]),b.isFiltered=!1,b.$quickfilter&&b.$quickfilter.trigger("bjui.datagrid.thead.clearfilter")}),b.$thead.find("> tr > th.datagrid-quicksort-th").find("> div > .datagrid-label > i").remove(),void 0):c.data&&c.data.length?(d.initTbody(b.allData,!0),void 0):(BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!"),void 0)},b.prototype.refreshParent=function(){var a=this,b=a.$element.data("bjui.datagrid.parent");b&&b.length&&b.closest("table").datagrid("refresh")},b.prototype.refreshChild=function(b){var e,c=this,d=c.$tbody.find("> tr"),f=function(a){e=a.data("bjui.datagrid.child"),e&&e.length&&e.isTag("table")&&e.datagrid("refresh")};b instanceof jQuery?b.each(function(){f(a(this))}):isNaN(b)?a.each(b.split(","),function(a,b){2*b<d.length&&f(d.eq(2*b))}):2*b<d.length&&f(d.eq(2*b))},b.prototype.showChild=function(b,c,d){var g,h,i,j,k,l,m,e,f,n,o,p,q,r,s,t;"undefined"==typeof c&&(c=!0),e=this,f=e.options,n=e.$tbody.find("> tr:not(."+e.classnames.tr_child+")"),o=function(){f.fullGrid||e.fixedWidth(),e.fixedHeight()},p=function(a,b,c){if(e.$lockTableB){var d=e.$lockTableB.find("> tbody > tr:eq("+a+")");d.toggle(b),c?d.height(c):d.height()||d.height(g.height())}},q=function(b,c,f){h.find("> div").html(BJUI.doRegional(FRAG.gridShrinkBtn,e.regional)),c.fadeIn("normal",function(){f.data("bjui.datagrid.init")?(o(),p(j,!0),d&&d.apply(e,[f])):(l=a.extend(!0,{},e.childOptions),m=l.dataUrl,k=e.isDom?b.data("initData")||e.tools.setDomData(b):e.data[e.tools.getNoChildDataIndex(b.index())],m&&!m.isFinishedTm()&&(m=e.tools.replacePlh(m,k),m.isFinishedTm()?l.dataUrl=m:BJUI.debug("Datagrid Plugin: The datagrid options 'childOptions' in the 'dataUrl' options is incorrect: "+m)),f.datagrid(l).data("bjui.datagrid.parent",b).on("completed.bjui.datagrid",a.proxy(function(){o(),p(j,!0,c.outerHeight()),d&&d.apply(e,[f])},e)).on("bjui.datagrid.child.resize",function(){f.datagrid("fixedWidth").datagrid("fixedHeight")}),b.data("bjui.datagrid.child",f))})},r=function(a,b,c){b.fadeOut("normal",function(){h.find("> div").html(BJUI.doRegional(FRAG.gridExpandBtn,e.regional)),o(),p(j,!1),d&&d.apply(e,[c])})},s=function(a){g=a.next("."+e.classnames.tr_child),g&&g.length&&(h=a.find("> td."+e.classnames.td_child),j=g.index(),i=g.find("> td").find("table.table-child"),i&&i.length&&(g.is(":visible")?c||r(a,g,i):c&&q(a,g,i)))},d&&("string"==typeof d&&(d=d.toFunc()),"function"!=typeof d&&(d=!1)),b instanceof jQuery?b.each(function(){s(a(this))}):isNaN(b)?a.each(b.split(","),function(a,b){var c=n.eq(parseInt(b.trim(),10));c&&c.length&&s(c)}):isNaN(b)||(t=n.eq(b),t&&t.length&&s(t))},b.prototype.updateRow=function(b,c){var f,g,h,i,d=this,e=d.options,j=function(c,f){if(a.extend(g,"object"==typeof f&&f),d.dialogEditComplete(c,g),g["refresh.datagrid.child"]){var h=c.data("bjui.datagrid.child");h&&h.length?h.datagrid("refresh"):d.showChild(b)}"auto"===e.height&&(d.$boxB.scrollTop(5),d.$boxB.scrollTop&&d.fixedHeight())};if(b instanceof jQuery)i=b;else{if(isNaN(b))return BJUI.debug("Datagrid Plugin: Func 'updateRow', Parameter 'row' is incorrect!"),void 0;i=d.$tbody.find("> tr:not(."+d.classnames.tr_child+")").eq(parseInt(b,10))}if(d.isDom?g=i.data("initData")||d.tools.setDomData(i):(f=d.tools.getNoChildDataIndex(i.index()),g=d.data[f]),c){if("string"==typeof c&&(c=c.trim().startsWith("{")?c.toObj():c.toFunc()),"function"==typeof c&&(c=c.apply()),"object"!=typeof c&&!e.updateRowUrl)return BJUI.debug("Datagrid Plugin: Func 'updateRow', Parameter 'updateData' is incorrect!"),void 0;j(i,c)}else e.updateRowUrl?(h=d.tools.replacePlh(e.updateRowUrl,g),h.isFinishedTm()?BJUI.ajax("doajax",{url:h,type:e.loadType,okCallback:function(a){j(i,a)}}):BJUI.debug("Datagrid Plugin: The datagrid options 'updateRowUrl' is incorrect!")):BJUI.debug("Datagrid Plugin: The datagrid options 'updateRowUrl' is not set!")},b.prototype.doAjaxRow=function(a,b){var e,f,g,h,c=this;if(c.options,a instanceof jQuery)e=a;else{if(isNaN(a))return BJUI.debug("Datagrid Plugin: Func 'doAjaxRow', Parameter 'row' is incorrect!"),void 0;e=c.$tbody.find("> tr:not(."+c.classnames.tr_child+")").eq(parseInt(a,10))}"object"==typeof b&&b.url?("undefined"==typeof b.reload&&(b.reload=!1),b.callback||b.okCallback||(b.okCallback=function(a){c.updateRow(e,"object"==typeof a&&!a[BJUI.keys.statusCode]&&a)}),c.isDom?f=e.data("initData")||c.tools.setDomData(e):(g=c.tools.getNoChildDataIndex(e.index()),f=c.data[g]),h=b.url,h=!f||f.addFlag?h.replace(/{\/?[^}]*}/g,""):c.tools.replacePlh(h,f),h.isFinishedTm()||BJUI.debug("Datagrid Plugin: Func 'doAjaxRow', options 'url' is incorrect: "+h),b.url=h,BJUI.ajax("doajax",b)):BJUI.debug("Datagrid Plugin: Func 'doAjaxRow', options is incorrect or the property 'url' is not set!")},b.prototype.reload=function(b){var c=this.options;b&&"object"==typeof b&&(b.clearOldPostData&&delete c.postData,a.extend(!0,c,b)),!c.dataUrl&&c.data&&(this.allData=c.data),this.refresh()},b.prototype.destroy=function(){var a=this,b=a.$grid.data("bjui.datagrid.table");b&&(a.$element.html(b.html()).insertBefore(a.$grid),a.$grid.remove())},b.prototype.initTop=function(){var f,i,j,k,l,b=this,c=b.options,e=(b.regional,!1),g='<div class="btn-group" role="group"></div>',h='<button type="button" class="btn" data-icon=""></button>';c.showToolbar&&(c.toolbarItem||c.toolbarCustom)&&(c.toolbarItem&&(i=c.toolbarItem.toFunc(),"function"==typeof i&&(c.toolbarItem=i.apply()),e=!0,c.toolbarItem.indexOf("all")>=0&&(c.toolbarItem="add, edit, cancel, save, |, del, |, refresh, |, import, export"),a.each(c.toolbarItem.split(","),function(d,e){return e=e.trim().toLocaleLowerCase(),f&&"|"!==e||(f=a(g).appendTo(b.$toolbar),"|"!==e)?("add"===e?b.$toolbar_add=a(h).attr("data-icon","plus").addClass("btn-blue").text(BJUI.getRegional("datagrid.add")).appendTo(f).on("click",function(){b.add()
}):"edit"===e?b.$toolbar_edit=a(h).attr("data-icon","edit").addClass("btn-green").text(BJUI.getRegional("datagrid.edit")).appendTo(f).on("click",function(){var e=b.$tbody.find("> tr."+b.classnames.tr_selected);return c.editMode?(e.length?c.inlineEditMult?b.doEditRow(e):b.$lastSelect?b.doEditRow(b.$lastSelect):b.doEditRow(e.first()):a(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg")),void 0):!1}):"cancel"===e?b.$toolbar_calcel=a(h).attr("data-icon","undo").addClass("btn-orange").text(BJUI.getRegional("datagrid.cancel")).appendTo(f).on("click",function(){b.doCancelEditRow(b.$tbody.find("> tr."+b.classnames.tr_edit))}):"save"===e?b.$toolbar_save=a(h).attr("data-icon","save").addClass("btn-default").text(BJUI.getRegional("datagrid.save")).appendTo(f).on("click",function(){b.doSaveEditRow()}):"del"===e?b.$toolbar_del=a(h).attr("data-icon","times").addClass("btn-red").text(BJUI.getRegional("datagrid.del")).appendTo(f).on("click",function(){var d=b.$tbody.find("> tr."+b.classnames.tr_selected);d.length?b.delRows(d):a(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"refresh"===e?b.$toolbar_refresh=a(h).attr("data-icon","refresh").addClass("btn-green").text(BJUI.getRegional("datagrid.refresh")).appendTo(f).on("click",function(){b.refresh()}):"import"===e?b.$toolbar_add=a(h).attr("data-icon","sign-in").addClass("btn-blue").text(BJUI.getRegional("datagrid.import")).appendTo(f).on("click",function(){if(c.importOption){var d=c.importOption;"string"==typeof d&&(d=d.toFunc()),d(),d.options&&d.options.url&&("dialog"===d.type?b.$grid.dialog(d.options):"navtab"===d.type?b.$grid.navtab(d.options):b.$grid.bjuiajax("doajax",d.options))}}):"export"===e&&(b.$toolbar_add=a(h).attr("data-icon","sign-out").addClass("btn-green").text(BJUI.getRegional("datagrid.export")).appendTo(f).on("click",function(){if(c.exportOption){var d=c.exportOption;"string"==typeof d&&(d=d.toFunc()),d(),d.options&&d.options.url&&("dialog"===d.type?BJUI.dialog(d.options):"navtab"===d.type?BJUI.navtab(d.options):"file"===d.type?(d.options.target=b.$boxB,BJUI.ajax("ajaxdownload",d.options)):BJUI.ajax("doajax",d.options))}})),void 0):!0})),c.toolbarCustom&&(k=a('<div style="display:inline-block;"></div>'),"string"==typeof c.toolbarCustom?(l=a(c.toolbarCustom),l&&l.length?j=l:(l=l.toFunc(),l&&(j=l.call(b),"string"==typeof j&&(j=a(j))))):"function"==typeof c.toolbarCustom?(j=c.toolbarCustom.call(b),"string"==typeof j&&(j=a(j))):j=c.toolbarCustom,j&&j.length&&"string"!=typeof j&&(e&&k.css("margin-left","5px"),k.appendTo(b.$toolbar),j.appendTo(k))),b.$toolbar.initui())},b.prototype.initThead=function(){var f,h,j,k,l,m,b=this,c=b.options,d=b.tools,e=b.columnModel,g=[],i=a('<div class="bjui-datagrid"></div>');b.$tableH.append(b.$thead),b.init_thead=!0,b.$trsH=b.$thead.find("> tr"),b.table_width=0,b.$colgroupH=b.$tableH.find("> colgroup"),b.fixtedColumnWidthCount=0,a.each(b.columnModel,function(c,d){var e="";(d===b.linenumberColumn||d===b.checkboxColumn||d===b.childColumn||d===b.editBtnsColumn)&&(e=' class="datagrid_col_lockwidth"'),f=d.width,f&&"auto"!==f||(h||(h=b.$element.clone().addClass("table table-bordered").appendTo(i),h.prepend(b.$thead.clone()),i.appendTo(a("body")),h.attr("style","width:auto !important;").initui()),b.fixtedColumnWidthCount++,d.fixedWidth=!0,j=h.find("> tbody > tr:first-child"),j.hasClass("datagrid-nodata")?(k=b.$trsH.length>1?b.$trsH.length-parseInt(d.th.attr("rowspan")||1,10):0,f=h.find("> thead > tr:eq("+k+") > th:eq("+d.th.index()+")").outerWidth()+5):f=h.find("> tbody > tr:first-child > td:eq("+c+")").outerWidth()+5),g.push('<col style="width:'+f+'px;"'+e+">"),d.width=f,b.table_width+=f}),i&&i.remove(),b.$colgroupH.html(g.join("")),setTimeout(function(){b.$thead.find("> tr:not(.datagrid-filter)").each(function(){a(this).find("> th").each(function(){var b=a(this),c=b.outerHeight(),d=b.find("> div");d.height(c)})})},10),l=b.$trsH.find("> th"),l.filter(".datagrid-quicksort-th").on("click.bjui.datagrid.quicksort",function(c){var f=a(c.target);f.closest("."+b.classnames.th_cell).length||b.isResize||d.quickSort(e[a(this).data("index")])}),l.filter(".datagrid-column-menu").on("bjui.datagrid.th.filter",function(c,d){var e=a(this),f=e.find("> div > ."+b.classnames.th_cell+"> ."+b.classnames.btn_menu+"> .btn");d?(e.addClass("filter-active"),f.find("> i").attr("class","fa fa-filter")):(e.removeClass("filter-active"),f.find("> i").attr("class","fa fa-bars"))}),c.contextMenuH&&d.contextmenuH(),b.initTbody(),c.columnResize&&b.colResize(),c.columnMenu&&b.colMenu(),c.paging&&b.initPaging(),c.editMode&&b.edit(),b.$element.hasClass("table-child")||b.resizeGrid(),m=function(){var a,e,f,g,h;if(c.showTfoot&&b.initTfoot(),d.setBoxbH(),b.renderTds&&b.renderTds.length)for(a=b.$tbody.find("> tr:not(."+b.classnames.tr_child+", .datagrid-nodata)"),e=b.renderTds&&b.renderTds.length,f=0;e>f;f++)g=b.renderTds[f],h=g.render.call(b,g.label,g.trData,b.columnModel[g.tdindex].items),a.eq(g.trindex).find("> td:eq("+g.tdindex+")").html("<div>"+h+"</div>");b.initEvents(),b.$tableB.initui(),b.$lockTableB&&b.$lockTableB.initui(),setTimeout(function(){b.fixedWidth("init"),b.initLock(),b.$element.trigger("completed.bjui.datagrid",{datas:b.data}),b.$boxM&&b.$boxM.trigger("bjui.ajaxStop").hide()},50),b.delayFilterTimeout&&clearInterval(b.delayFilterTimeout)},c.filterThead?b.delayRender?b.delayFilterTimeout=setInterval(function(){b.delayRender||(b.filterInThead(),m())},100):(b.filterInThead(),m()):m()},b.prototype.fixedWidth=function(b){var e,j,c=this,d=c.options,h=c.columnModel;h.length,b&&c.initFixedW||(c.initFixedW=!0,j=function(){if(String(c.options.width).endsWith("%")&&c.$grid.css("width",""),c.$boxH.find("> div").css("width",""),c.$boxB.find("> div").css("width",""),c.$boxF&&c.$boxF.find("> div").css("width",""),c.$boxP&&c.$boxP.find("> div.paging-content").css("width",""),e=c.$boxB.find("> div").width(),c.options.hasChild&&(c.$boxB.scrollTop(5),c.$boxB.scrollTop()&&(e-=18)),e&&(c.$boxB.find("> div").width(e),c.$boxH.find("> div").width(e),c.$boxF&&c.$boxF.find("> div").width(e),c.table_width>e||d.fullGrid?c.$boxP&&c.$boxP.find("> div.paging-content").width(e):c.$boxP&&c.$boxP.find("> div.paging-content").width(c.table_width)),d.fullGrid){var f,g,b=c.$tbody.find("> tr:first"),h=c.$colgroupB.find("> col");h.filter(":not(.datagrid_col_lockwidth)").css("width",""),a.each(c.columnModel,function(a,d){return d===c.linenumberColumn||d===c.checkboxColumn||d===c.childColumn||d===c.editBtnsColumn?!0:(b.hasClass("datagrid-nodata")?(g=c.$trsH.length>1?c.$trsH.length-parseInt(d.th.attr("rowspan")||1,10):0,f=c.$trsH.eq(g).find("> th:eq("+d.th.index()+")").width()):f=b.find("> td:eq("+a+")").width(),h.eq(a).css("width",f),void 0)}),c.$colgroupH.html(c.$colgroupB.html())}},j())},b.prototype.fixedHeight=function(a){var b=this,c=b.options;"auto"===c.height?(b.boxH="auto",b.$grid.css("height",""),b.$boxB.css("height",""),b.tools.setBoxbH()):b.tools.setBoxbH(a),b.$boxB.scrollLeft(5),b.$boxB.scrollLeft()&&b.fixedWidth()},b.prototype.initTbody=function(){var a=this,b=a.options,d=(a.tools,a.$tbody.find("> tr")),f=(d.find("> td"),"0");a.init_tbody=!0,a.$colgroupB=a.$colgroupH.clone(),a.$tableB.prepend(a.$colgroupB),b.fullGrid&&(f="100%"),a.$tableH.css("width",f),a.$tableB.css("width",f),a.$tableB.removeAttr("data-toggle width").addClass("table table-bordered").removeClass("table-hover"),a.$boxB.scroll(function(){a.$boxH.find("> div").prop("scrollLeft",this.scrollLeft),a.$boxF&&a.$boxF.find("> div").prop("scrollLeft",this.scrollLeft),a.$lockB&&a.$lockB.prop("scrollTop",this.scrollTop)}),a.isDom&&(b.showLinenumber&&a.showLinenumber(b.showLinenumber),b.showCheckboxcol&&a.showCheckboxcol(b.showCheckboxcol),b.showEditbtnscol&&a.showEditCol(b.showEditbtnscol),a.$grid.data(a.datanames.tbody,a.$tbody.clone()))},b.prototype.initEvents=function(b){var c=this,d=c.options,e=c.$tbody.find("> tr");b||(b=e),b.on("dblclick.bjui.datagrid.tr",function(){var j,k,l,e=a(this);e.index(),c.$lockTbody&&c.$lockTbody.find("> tr"),c.selectedRows(e,!0),j=d.dblOnClick,"string"==typeof j&&(j=j.toFunc(),j()),k=c.$tbody.find("> tr."+c.classnames.tr_selected),l=d.editdblOnclick,l&&(d.inlineEditMult?c.doEditRow(k):c.$lastSelect?c.doEditRow(c.$lastSelect):c.doEditRow(k.first()))}),b.on("click.bjui.datagrid.tr",function(b,e){var h,k,f=a(this),g=f.index(),i=c.$tbody.find("> tr."+c.classnames.tr_selected),j=c.$lastSelect;if(c.$lockTbody&&c.$lockTbody.find("> tr"),e)k=e.is(":checked"),k||(c.$lastSelect=f),c.selectedRows(f,!k);else{if(f.hasClass(c.classnames.tr_edit))return;d.selectMult?c.selectedRows(f):BJUI.KeyPressed.ctrl||BJUI.KeyPressed.shift?(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),BJUI.KeyPressed.ctrl?(f.hasClass(c.classnames.tr_selected)||(c.$lastSelect=f),c.selectedRows(f)):BJUI.KeyPressed.shift&&(j||(j=c.$lastSelect=f),j.length&&(c.selectedRows(null),j.index()!=g?j.index()>g?c.selectedRows(f.nextUntil(j).add(f).add(j),!0):c.selectedRows(f.prevUntil(j).add(f).add(j),!0):c.selectedRows(g)))):i.length>1&&f.hasClass(c.classnames.tr_selected)?(c.selectedRows(i.not(f)),c.$lastSelect=f):(i.length&&i[0]!=this&&c.selectedRows(null),f.hasClass(c.classnames.tr_selected)||(c.$lastSelect=f),c.selectedRows(f))}h=c.isDom?c.tools.setDomData(f):c.data[c.tools.getNoChildDataIndex(g)],c.$element.trigger("clicked.bjui.datagrid.tr",{data:h})}).on("mouseenter.bjui.datagrid",function(){var d=a(this),e=d.index();d.addClass("datagrid-hover"),c.$lockTbody&&c.$lockTbody.find("> tr:eq("+e+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(){var d=a(this),e=d.index();d.removeClass("datagrid-hover"),c.$lockTbody&&c.$lockTbody.find("> tr:eq("+e+")").removeClass("datagrid-hover")}).on("bjui.datagrid.tr.delete",function(b){b.stopPropagation();var h,d=a(this),e=d.index(),f=e,g=c.data,i=c.allData,j=c.$lockTbody&&c.$lockTbody.find("> tr");return d.hasClass("datagrid-nodata")?!1:(c.options.hasChild&&c.options.childOptions&&(f/=2,d.next().remove(),j&&j.eq(e).next().remove()),c.isDom||(h=g[f].gridIndex,c.data=g.remove(f),c.allData=i.remove(h)),-1!=a.inArray(c.linenumberColumn,c.columnModel)&&(d.nextAll(":not(."+c.classnames.tr_child+")").each(function(){var b=a(this).find("> td."+c.classnames.td_linenumber),d=parseInt(b.text(),10);b.text(d-1)}),j&&j.eq(e).trigger("bjui.datagrid.tr.delete",[e])),d.remove(),j&&j.eq(e).remove(),c.tools.createNoDataTr(),void 0)}),c.$grid.off("click.bjui.datagrid.tr.child").on("click.bjui.datagrid.tr.child","td."+c.classnames.td_child,function(b){b.stopPropagation();var d=a(this),e=d.closest("tr"),f=e.next("."+c.classnames.tr_child);f&&f.length&&c.showChild(e,!f.is(":visible"))}).off("ifClicked").on("ifClicked","td."+c.classnames.td_checkbox+" input",function(b){b.stopPropagation();var d=a(this),e=d.closest("tr"),f=e.index();c.$tbody.find("> tr:eq("+f+")").trigger("click.bjui.datagrid.tr",[d])}).off("ifChanged").on("ifChanged","th."+c.classnames.td_checkbox+" input",function(b){b.stopPropagation();var d=a(this).is(":checked"),e=c.$tbody.find('> tr:not(".'+c.classnames.tr_child+'")');c.selectedRows(e,d)}),d.contextMenuB&&b.each(function(){c.tools.contextmenuB(a(this))}),c.$tableB.off("click.bjui.datagrid.refresh").on("click.bjui.datagrid.refresh",'tbody > tr > td [data-toggle="update.datagrid.tr"]',function(b){b.stopPropagation(),c.updateRow(a(this).closest("tr"))}).off("click.bjui.datagrid.edit").on("click.bjui.datagrid.edit",'tbody > tr > td [data-toggle="edit.datagrid.tr"]',function(b){b.stopPropagation();var d=a(this),e=d.data("options"),f=d.closest("tr");e&&"string"==typeof e&&(e=e.toObj()),"object"==typeof e?c.externalEdit(f,e):c.doEditRow(f)}).off("click.bjui.datagrid.ajax").on("click.bjui.datagrid.ajax",'tbody > tr > td [data-toggle="ajax.datagrid.tr"]',function(b){b.stopPropagation();var d=a(this),e=d.data();e.options&&"string"==typeof e.options&&(e.options=e.options.toObj()),a.extend(e,"object"==typeof e.options&&e.options),c.doAjaxRow(d.closest("tr"),e)}).off("click.bjui.datagrid.addchild").on("click.bjui.datagrid.addchild",'tbody > tr > td [data-toggle="addchild.datagrid.tr"]',function(b){b.stopPropagation();var h,j,d=a(this),e=d.closest("tr"),f=e.data("bjui.datagrid.child"),g=e.next("."+c.classnames.tr_child),i=d.data("addData"),k=function(a){return a.replace(/#\/?[^#]*#/g,function(a){var b=a.replace(/[##]+/g,""),c=h[b];return("undefined"==typeof c||"null"===c||null===c)&&(c=""),c})},l=function(a){i&&("string"==typeof i?(i=k(i),i=i.trim().startsWith("{")?i.toObj():i.toFunc()):("function"==typeof i&&(i=i.toFunc()),"object"==typeof i&&(i=JSON.stringify(i)),i=k(i).toObj()),"object"==typeof i&&(j=i)),a.datagrid("add",!1,j)};g&&g.length&&(h=c.isDom?e.data("initData")||tools.setDomData(e):c.data[c.tools.getNoChildDataIndex(e.index())],f&&f.length?l(f):c.showChild(e,!0,l))}).off("click.bjui.datagrid.del").on("click.bjui.datagrid.del",'tbody > tr > td [data-toggle="del.datagrid.tr"]',function(b){b.stopPropagation(),c.delRows(a(this).closest("tr"))})},b.prototype.initTfoot=function(){var b=this,c=b.options,d=b.tools,e=b.columnModel,f=a("<tr></tr>");b.init_tfoot=!0,b.$boxF=a('<div class="datagrid-box-f"></div>'),b.$colgroupF=b.$colgroupH.clone(),b.$tableF=b.$tableH.clone().empty(),b.$tableF.append(b.$colgroupF),b.$boxF.append(a('<div class="datagrid-wrap-h"></div>').append(b.$tableF)),b.$boxF.insertAfter(b.$boxB),b.$tfoot=a("<thead></thead>"),a.each(e,function(b,c){var e,d=a("<th><div></div></th>");c.calc&&(e='<div><div class="datagrid-calcbox">#tit#</div>#number#</div>',"avg"===c.calc?d.html(e.replace("#tit#",c.calcTit||"AVG").replace("#number#",(c.calc_sum/c.calc_count).toFixed(c.calcDecimal||2))):"count"===c.calc?d.html(e.replace("#tit#",c.calcTit||"COUNT").replace("#number#",c.calc_count)):"sum"===c.calc?d.html(e.replace("#tit#",c.calcTit||"SUM").replace("#number#",c.calc_sum)):"max"===c.calc?d.html(e.replace("#tit#",c.calcTit||"MAX").replace("#number#",c.calc_max)):"min"===c.calc&&d.html(e.replace("#tit#",c.calcTit||"MIN").replace("#number#",c.calc_min))),c.hidden&&d.css("display","none"),d.appendTo(f)}),b.$tfoot.append(f).appendTo(b.$tableF),b.$tfoot.on("bjui.datagrid.tfoot.resizeH",function(){d.setBoxbH(c.height)})},b.prototype.selectedRows=function(b,c){var h,i,j,d=this,e=d.$lockTbody&&d.$lockTbody.find("> tr"),f=d.$tbody.find("> tr"),g=function(a){"undefined"==typeof c&&(c=!0),f.eq(a).hasClass(d.classnames.tr_child)||(f.eq(a).toggleClass(d.classnames.tr_selected,c).find("> td."+d.classnames.td_checkbox+" input").iCheck(c?"check":"uncheck"),e&&e.eq(a).toggleClass(d.classnames.tr_selected,c).find("> td."+d.classnames.td_checkbox+" input").iCheck(c?"check":"uncheck"))};null===b?(f.removeClass(d.classnames.tr_selected).find("> td."+d.classnames.td_checkbox+" input").iCheck("uncheck"),e&&e.removeClass(d.classnames.tr_selected).find("> td."+d.classnames.td_checkbox+" input").iCheck("uncheck")):"object"==typeof b?b.each(function(){var b=a(this),f=b.index();return b.hasClass(d.classnames.tr_child)?!0:("undefined"!=typeof c?g(f):(b.toggleClass(d.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+d.classnames.td_checkbox+" input").iCheck(b.hasClass(d.classnames.tr_selected)?"check":"uncheck"),e&&e.eq(f).toggleClass(d.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+d.classnames.td_checkbox+" input").iCheck(b.hasClass(d.classnames.tr_selected)?"check":"uncheck")),void 0)}):isNaN(b)?a.each(b.split(","),function(a,b){g(parseInt(b.trim(),10))}):isNaN(b)||g(parseInt(b,10)),d.$lastSelect&&!d.$lastSelect.hasClass(d.classnames.tr_selected)&&(d.$lastSelect=null),h=d.$tbody.find("> tr."+d.classnames.tr_selected),i=[],h.each(function(){var e,b=a(this),c=b.index();c=d.tools.getNoChildDataIndex(c),e=d.isDom?b.data("initData")||d.tools.setDomData(b):d.data[c],i.push(e)}),d.$element.data("selectedTrs",h).data("selectedDatas",i),j=this.options.clickRow,"function"==typeof j&&j()},b.prototype.initLock=function(){var b=this;b.columnModel,b.col_lock_count=0,a.each(b.columnModel,function(a,c){c.initLock&&b.col_lock_count++}),b.col_lock_count&&b.doLock()},b.prototype.colLock=function(b,c){var e,f,g,d=this;if("number"===a.type(b)){if(f=parseInt(b,10),0>f||f>d.columnModel.length-1)return;g=d.columnModel[f],e=g.th}else e=b,f=e.data("index"),g=d.columnModel[f];g!==d.editBtnsColumn&&g.index!==d.columnModel.length-1&&("undefined"==typeof g.locked&&(g.locked=!1),g.locked!==c&&(g.initLock=c,c?d.col_lock_count++:d.col_lock_count--,d.col_lock_count<0&&(d.col_lock_count=0),d.doLock()))},b.prototype.fixedLockItem=function(b){var g,h,i,j,c=this,d=c.columnModel,e=c.$thead.find("> tr.datagrid-filter > th"),f=c.$lockTbody&&c.$lockTbody.find("> tr");b?(g=function(a,b){a.clone().html("").insertAfter(a),a.show().insertAfter(b),b.remove()},e&&e.length&&c.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var b=a(this),c=b.index(),d=e.eq(c);g(d,b)}),c.$lockThead&&-1!=a.inArray(c.checkboxColumn,d)&&c.checkboxColumn.locked&&(h=c.$lockThead.find("> tr:first > th."+c.classnames.td_checkbox),i=c.checkboxColumn.index,j=c.$thead.find("> tr:first > th:eq("+i+")"),g(j,h)),f&&f.length&&f.each(function(){var f,g,b=a(this),e=b.index(),h=function(a,b,d){f=c.$tbody.find("> tr:eq("+b+")"),g=f.find("> td:eq("+d+")"),g.clone().insertAfter(g),g.show().insertAfter(a),a.remove()};b.hasClass(c.classnames.tr_edit)&&b.find("> td."+c.classnames.td_edit+":visible").each(function(){var b=a(this),c=b.index(),f=d[c];f.locked&&h(b,e,c)}),-1!=a.inArray(c.checkboxColumn,d)&&c.checkboxColumn.locked&&b.find("> td."+c.classnames.td_checkbox).each(function(){var b=a(this),d=c.checkboxColumn.index;h(b,e,d)})})):(g=function(a,b){b.clone().insertAfter(b),b.hide().insertAfter(a),a.remove()},e&&e.length&&c.$lockThead&&c.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var b=a(this),c=b.index(),d=e.eq(c);g(d,b)}),c.$lockThead&&-1!=a.inArray(c.checkboxColumn,d)&&c.checkboxColumn.locked&&(h=c.$lockThead.find("> tr:first > th."+c.classnames.td_checkbox),i=c.checkboxColumn.index,j=c.$thead.find("> tr:first > th:eq("+i+")"),g(j,h)),f&&f.length&&f.each(function(){var f,g,i,j,b=a(this),e=b.index(),h=function(a,b,d){f=c.$tbody.find("> tr:eq("+b+")"),g=f.find("> td:eq("+d+")"),a.clone().insertAfter(a),a.hide().insertAfter(g),g.remove()};b.hasClass(c.classnames.tr_edit)&&(i=b.find("> td:eq("+d.lockIndex+")"),j=i.index(),i.hasClass(c.classnames.td_edit)&&h(i,e,j)),-1!=a.inArray(c.checkboxColumn,d)&&c.checkboxColumn.locked&&b.find("> td."+c.classnames.td_checkbox).each(function(){var b=a(this),d=c.checkboxColumn.index;h(b,e,d)})}))},b.prototype.doLock=function(){var h,i,m,n,o,p,b=this,d=(b.options,b.tools),e=b.columnModel,g=(b.$tableH.width(),0),j=0,k=b.$boxF&&!0,l=0;b.$lockBox&&b.$lockBox.length?(b.fixedLockItem(),b.$lockTableH.empty(),b.$lockTableB.empty(),b.$lockTableF&&b.$lockTableF.empty()):(b.$lockBox=a('<div class="datagrid-box-l"></div>'),b.$lockH=a('<div class="datagrid-box-h"></div>'),b.$lockB=a('<div class="datagrid-box-b"></div>'),b.$lockF=a('<div class="datagrid-box-f"></div>'),b.$lockTableH=a('<table class="table table-bordered"></table>'),b.$lockTableB=a("<table></table>").addClass(b.$tableB.attr("class")),b.$lockTableF=a('<table class="table table-bordered"></table>'),b.$lockH.append(b.$lockTableH),b.$lockB.append(b.$lockTableB),b.$lockF.append(b.$lockTableF),b.$lockBox.append(b.$lockH).append(b.$lockB).prependTo(b.$grid),k&&(b.$lockBox.append(b.$lockF),b.$lockF.css("margin-top",b.$boxB.outerHeight()-b.$boxB[0].clientHeight).height(b.$boxF.outerHeight()))),b.$boxT&&(l+=b.$boxT.outerHeight()),b.$toolbar&&(l+=b.$toolbar.outerHeight()),l&&b.$lockBox.css({top:l}),a.each(e,function(a,b){b.lockShow=!1,b.lockHide=!1,b.initLock?(b.hidden&&d.showhide(b,!0),b.lockHide=!0,b.locked=!0,b.lockIndex=j++,g+=b.width):(b.lockShow=!0,b.hidden?b.lockShow=!1:d.showhide(b,!1),b.locked&&(b.lockShow=!0),b.locked=!1)}),b.$lockThead=b.$thead.clone(!0),b.$lockTbody=b.$tbody.clone(),b.$lockColgroupH=b.$colgroupH.clone(),b.$lockColgroupB=b.$colgroupB.clone(),b.$lockTableH.append(b.$lockColgroupH).append(b.$lockThead).css("width",g),b.$lockTableB.append(b.$lockColgroupB).append(b.$lockTbody).css("width",g),k&&(b.$lockTfoot=b.$tableF.find("> thead").clone(),b.$lockColgroupF=b.$colgroupF.clone(),b.$lockTableF.append(b.$lockColgroupF).append(b.$lockTfoot).css("width",g)),a.each(b.columnModel,function(a,b){b.lockShow&&d.showhide(b,!0),b.lockHide&&d.showhide(b,!1)}),b.$boxH.find("> div").css("width",""),b.$boxB.find("> div").css("width",""),b.$boxF&&b.$boxF.find("> div").css("width",""),setTimeout(function(){var a=b.$boxB.find("> div").width();b.$boxB.find("> div").width(a),b.$boxH.find("> div").width(a),b.$boxF&&b.$boxF.find("> div").width(a)},50),b.col_lock_count?b.$lockBox.show():b.$lockBox.hide(),b.$tbody.find("> ."+b.classnames.tr_child+", .datagrid-nodata").each(function(){a(this).find("> td").attr("colspan",b.columnModel.length-b.col_lock_count)}),g>1&&(g-=1),b.$boxH.css("margin-left",g),b.$boxB.css("margin-left",g),k&&b.$boxF.css("margin-left",g),b.$lockB.height(b.$boxB[0].clientHeight),b.$lockB.prop("scrollTop",b.$boxB[0].scrollTop),m=b.$lockTableH.height(),n=b.$thead.height(),o=b.$lockTableF&&b.$lockTableF.height(),p=b.$tableF&&b.$tableF.height(),m!=n&&(n>m?b.$lockTableH.height(n):b.$tableH.height(m)),o&&p&&o!=p&&(p>o?b.$lockTableF.find("> thead > tr:first-child > th:visible:first").height(p):b.$tableF.find("> thead > tr:first-child > th:visible:first").height(o)),i=b.$lockTbody.find("> tr"),h=b.$tbody.find("> tr"),setTimeout(function(){var c=b.$lockTableB.height(),d=b.$tableB.height();c!=d&&(c>d?i.each(function(b){var c=a(this),d=c.find("> td:visible:first"),e=d.outerHeight();e>30&&(c.height(e),h.eq(b).height(e))}):h.each(function(b){var c=a(this),d=c.find("> td:visible:first"),e=d.outerHeight();e>30&&(c.height(e),i.eq(b).height(e))}))},20),b.fixedLockItem(1),i.find("> td:hidden").remove(),b.initLockEvents(i)},b.prototype.initLockEvents=function(b){if(this.$lockTbody){var c=this,d=c.options;b||(b=c.$lockTbody.find("> tr")),b.on("click.bjui.datagrid.tr",function(b){var d=a(this).index();a(b.target).closest("td"),c.$tbody.find("> tr:eq("+d+")").trigger("click.bjui.datagrid.tr")}).on("bjui.datagrid.tr.delete",function(){var e=a(this);c.linenumberColumn&&c.linenumberColumn.locked&&e.nextAll(":not(."+c.classnames.tr_child+")").each(function(){var b=a(this).find("> td."+c.classnames.td_linenumber),d=parseInt(b.text(),10);b.text(d-1)})}).on("mouseenter.bjui.datagrid",function(){var d=a(this),e=d.index();d.addClass("datagrid-hover"),c.$tbody.find("> tr:eq("+e+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(){var d=a(this),e=d.index();d.removeClass("datagrid-hover"),c.$tbody.find("> tr:eq("+e+")").removeClass("datagrid-hover")}),d.contextMenuB&&b.each(function(){c.tools.contextmenuB(a(this),!0)})}},b.prototype.filterInThead=function(){var b=this,d=(b.options,b.tools),e=b.regional,f=b.columnModel,h=a('<tr class="datagrid-filter"></tr>'),i=function(a,b,c){var d=b.type;"date"===d?a.on("afterchange.bjui.datepicker",function(){j(b,a.val())}).change(function(){j(b,a.val())}):"findgrid"===d?(c.on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(a,c){j(b,c.value)}),a.change(function(){j(b,a.val())})):"lookup"===d?(c.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(c,d){for(var e in d)b.name==e&&(a.val(d[e]),j(b,d[e]))}),a.change(function(){j(b,a.val())})):a.change(function(){j(b,a.val())})},j=function(a,b){d.quickFilter(a,b?{operatorA:"like",valA:b}:null)};b.inputs&&b.inputs.length||d.initEditInputs(),a.each(f,function(c,d){var f=a(b.inputs[c]),g=a("<th></th>"),j="";return d.quickfilter?("findgrid"===d.type?f.data("context",h):"spinner"===d.type?f=a('<input type="text" name="'+d.name+'">'):"boolean"===d.type?f=a(BJUI.doRegional('<select name="'+d.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',e)):"select"===d.type&&(d.attrs&&"object"==typeof d.attrs&&a.each(d.attrs,function(a,b){j+=" "+a+"="+b}),!f.find("> option:first-child").val()||d.attrs&&d.attrs.multiple||(f=a('<select name="'+d.name+'" data-toggle="selectpicker"'+j+"></select>").append(BJUI.doRegional('<option value="">#all#</option>',e)).append(f.html()),f.val(""))),g.append(f),d.hidden&&g.hide(),"boolean"===d.type&&g.attr("align","center"),g.appendTo(h),f.data("clearFilter",!1),i(f,d,g),f.on("bjui.datagrid.thead.clearfilter",function(){f.val(""),("boolean"===d.type||"select"===d.type)&&f.selectpicker("refresh")}),d.$quickfilter=f,void 0):(g.appendTo(h),!0)}),h.appendTo(b.$thead).initui()},b.prototype.showLinenumber=function(b){var f,l,j,k,m,n,c=this,d=c.options,e=c.columnModel,g=-1,i=(c.data,a.inArray(c.linenumberColumn,e));-1!=i&&(f=e[i]),f?"string"!=typeof b||"lock"!==b&&"unlock"!==b?c.showhideColumn(f.th,b?!0:!1):c.colLock(f.th,"lock"===b?!0:!1):b&&(g=a.inArray(c.childColumn,e),g++,f=c.linenumberColumn,f.index=g,e.splice(g,0,f),c.inputs&&c.inputs.length&&(c.inputs=c.inputs.splice(g,0,"")),j=c.$thead.find("> tr"),k='<col style="width:30px;">',m=j.filter(".datagrid-filter"),n=j.length-m.length,l=a('<th align="center"'+(n>1?' rowspan="'+n+' "':"")+'class="'+c.classnames.td_linenumber+(1==n?" single-row":"")+'"><div><div class="datagrid-space"></div><div class="datagrid-label">'+c.linenumberColumn.label+"</div></div></th>"),c.$colgroupH.find("> col:eq("+g+")").before(k),c.$colgroupB.find("> col:eq("+g+")").before(k),c.$colgroupF&&c.$colgroupF.find("> col:eq("+g+")").before(k),m.length&&m.find("> th:eq("+g+")").before("<th></th>"),j.first().find("> th:eq("+g+")").before(l),c.$tableF&&c.$tableF.find("> thead > tr > th:eq("+g+")").before("<th></th>"),f.th=l,f.width=30,c.$tbody.find("> tr").each(function(b){var e=a(this),f=c.columnModel.length,h=b,i=c.paging;e.hasClass(c.classnames.tr_child)||e.hasClass("datagrid-nodata")?e.find("> td").attr("colspan",f):(h=c.tools.getNoChildDataIndex(h),d.linenumberAll&&(h=(i.pageCurrent-1)*i.pageSize+h),e.find("> td:eq("+g+")").before('<td align="center" class="'+c.classnames.td_linenumber+'">'+(h+1)+"</td>"))}),c.$tableF&&c.$tableF.find("> thead > tr > th:eq("+g+")").before("<th></th>"),a.each(e,function(a,b){b.index=a,b.th&&b.th.data("index",a)}),l.find("> div").height(l.outerHeight()),"lock"===b&&c.colLock(l,!0),c.$showhide&&(c.$showhide.remove(),c.colShowhide(d.columnShowhide)))},b.prototype.showCheckboxcol=function(b){var g,l,m,j,k,n,o,c=this,d=c.options,e=c.columnModel,h=(e[0],-1),i=a.inArray(c.checkboxColumn,e);-1!=i&&(g=c.columnModel[i]),g?"string"!=typeof b||"lock"!==b&&"unlock"!==b?c.showhideColumn(g.th,b):c.colLock(g.th,"lock"===b?!0:!1):b&&(h=a.inArray(c.linenumberColumn,e),-1==h&&(h=a.inArray(c.childColumn,e)),h++,g=c.checkboxColumn,g.index=h,e.splice(h,0,g),c.inputs&&c.inputs.length&&(c.inputs=c.inputs.splice(h,0,"")),j=c.$thead.find("> tr"),k='<col style="width:30px;">',n=j.filter(".datagrid-filter"),o=j.length-n.length,l=a('<th align="center"'+(o>1?' rowspan="'+o+' "':"")+'class="'+c.classnames.td_checkbox+(1==o?" single-row":"")+'"><div><div class="datagrid-space"></div><div class="datagrid-label"><input type="checkbox" data-toggle="icheck"></div></th>'),c.$colgroupH.find("> col:eq("+h+")").before(k),c.$colgroupB.find("> col:eq("+h+")").before(k),c.$colgroupF&&c.$colgroupF.find("> col:eq("+h+")").before(k),n.length&&n.find("> th:eq("+h+")").before("<th></th>"),j.first().find("> th:eq("+h+")").before(l),c.$tableF&&c.$tableF.find("> thead > tr > th:eq("+h+")").before("<th></th>"),l.initui(),g.th=l,g.width=30,c.$tbody.find("> tr").each(function(){var d=a(this),e=c.columnModel.length;d.hasClass(c.classnames.tr_child)||d.hasClass("datagrid-nodata")?d.find("> td").attr("colspan",e):(m=a('<td align="center" class="'+c.classnames.td_checkbox+'"><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox"></td>'),d.find("> td:eq("+h+")").before(m),m.initui())}),a.each(e,function(a,b){b.index=a,b.th&&b.th.data("index",a)}),l.find("> div").height(l.outerHeight()),"lock"===b&&c.colLock(l,!0),c.$showhide&&(c.$showhide.remove(),c.colShowhide(d.columnShowhide)))},b.prototype.showEditCol=function(b){var j,k,h,i,l,m,c=this,d=c.options,e=c.columnModel,f=e[e.length-1];c.data,f===c.editBtnsColumn?c.showhideColumn(f.th,b?!0:!1):b&&(h=c.$thead.find("> tr"),i='<col style="width:110px;">',l=h.filter(".datagrid-filter"),m=h.length-l.length,f=c.editBtnsColumn,e.push(f),c.$colgroupH.append(i),c.$colgroupB.append(i),c.$colgroupF&&c.$colgroupF.append(i),j=a('<th align="center" rowspan="'+m+'">'+c.editBtnsColumn.label+"</th>"),h.first().append(j),l.length&&l.append("<th></th>"),j.initui().data("index",e.length-1),f.th=j,f.width=110,f.index=e.length-1,c.$tbody.find("> tr").each(function(){var d=a(this),e=c.columnModel.length;d.hasClass(c.classnames.tr_child)||d.hasClass("datagrid-nodata")?d.find("> td").attr("colspan",e):(k=a('<td align="center" class="'+c.classnames.s_edit+'">'+BJUI.doRegional(FRAG.gridEditBtn,c.regional)+"</td>"),d.append(k),k.initui())}),c.edit(c.$tbody.find("> tr")),c.$tableF&&c.$tableF.find("> thead > tr").append("<th></th>"),c.$showhide&&(c.$showhide.remove(),c.colShowhide(d.columnShowhide)))},b.prototype.colResize=function(){var b=this,c=b.tools,d=b.columnModel,e=b.$thead,f=b.$grid.find("> .resizeProxy");f.length||(f=a('<div class="resizeProxy" style="left:0; display:none;"></div>'),f.appendTo(b.$grid)),e.find("> tr > th").each(function(){var g=a(this),h=g.find("> div > ."+b.classnames.th_cell+"> ."+b.classnames.th_resizemark);h.on("mousedown.bjui.datagrid.resize",function(e){var j,r,s,h=b.$boxH.scrollLeft(),i=parseInt(b.$boxH.css("marginLeft")||0,10),k=g.data("index"),l=d[k],m=l.th.width(),n=b.$tbody.find("> tr"),o=b.$lockTbody&&b.$lockTbody.find("> tr"),p=b.$lockTableB&&b.$lockTableB.height(),q=b.$tableB.height();isNaN(i)&&(i=0),j=c.getRight(g)-h+i,b.isResize=!0,l.locked&&(j=c.getRight4Lock(l.lockIndex),l.lockWidth&&(m=l.lockWidth)),f.show().css({left:j,bottom:b.$boxP?b.$boxP.outerHeight():0,cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:f,move:"horizontal",event:e,stop:function(){var i,c=f.position().left,d=c-j,e=d+m,g=b.$tableH.width()+d,h=b.$lockTableH&&b.$lockTableH.width()+d;5>e&&(e=20),l.minWidth&&e<l.minWidth&&(e=l.minWidth),e!=m+d&&(g=g-d+(e-m),h=h-d+(e-m)),l.width=e,l.locked?h<.75*b.$grid.width()&&(l.lockWidth=e,b.$lockColgroupH.find("> col:eq("+k+")").width(e),b.$lockColgroupB.find("> col:eq("+k+")").width(e),b.$lockColgroupF&&b.$lockColgroupF.find("> col:eq("+k+")").width(e),b.$lockTableH.width(h),b.$lockTableB.width(h),b.$lockTableF&&b.$lockTableF.width(h),i=b.$lockBox.width(),b.$boxH.css("margin-left",i-1),b.$boxB.css("margin-left",i-1),b.$boxH.find("> div").width(b.$boxH.width()),b.$boxB.find("> div").width(b.$boxH.width()),b.$boxF&&b.$boxF.css("margin-left",i-1),b.$colgroupH.find("> col:eq("+k+")").width(e),b.$colgroupB.find("> col:eq("+k+")").width(e),b.$colgroupF&&b.$colgroupF.find("> col:eq("+k+")").width(e)):setTimeout(function(){b.$colgroupH.find("> col:eq("+k+")").width(e),b.$colgroupB.find("> col:eq("+k+")").width(e),b.$colgroupF&&b.$colgroupF.find("> col:eq("+k+")").width(e)},1),setTimeout(function(){n.css("height",""),s=b.$tableB.height(),b.$lockTbody&&(o.css("height",""),r=b.$lockTableB.height(),(r!=p||s!=q)&&(r>s?o.each(function(b){var c=a(this),d=c.find("> td:eq("+l.lockIndex+")"),e=d.outerHeight();e>30&&(c.height(e),n.eq(b).height(e))}):n.each(function(b){var c=a(this),d=c.find("> td:eq("+k+")"),e=d.outerHeight();e>30&&(c.height(e),o.eq(b).height(e))})),b.$lockB.height(b.$boxB[0].clientHeight)),l.calc&&b.$tfoot&&b.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),b.isResize=!1},10),f.hide(),b.resizeFlag=!0}})})})},b.prototype.colMenu=function(){var b=this,c=b.options,d=b.tools,e=b.regional,f=b.$trsH.find("> th."+b.classnames.th_menu),g=b.$grid.find("> ."+b.classnames.s_menu);g.legnth||(g=a(BJUI.doRegional(FRAG.gridMenu,e)),g.hide().appendTo(b.$grid),b.$menu=g),b.colShowhide(c.columnShowhide),f.each(function(){var k,e=a(this),f=e.data("index"),h=b.columnModel[f],i=e.find("> div > ."+b.classnames.th_cell),j=i.find("> ."+b.classnames.btn_menu);
    j.length||(k=a('<button type="button" class="btn btn-default"><i class="fa fa-bars"></button>'),j=a('<div class="'+b.classnames.btn_menu+'"></div>').append(k),j.appendTo(i),k.click(function(){var n,o,q,r,s,t,i=(e.closest("tr"),parseInt(e.attr("rowspan")||1,10)),j=a(this).offset().left-b.$grid.offset().left-1,l=25*(b.$trsH.length-i)+13*i+11,m=g.find("> ul > li.datagrid-li-showhide"),p=g.data("bjui.datagrid.menu.btn");p&&p.length&&p.removeClass("active"),a(this).addClass("active"),m.length&&b.$showhide&&(b.$showhide.appendTo(m),o=b.$showhide.data("width")),g.css({position:"absolute",top:l,left:j}).show().data("bjui.datagrid.menu.btn",k).siblings("."+b.classnames.s_menu).hide(),n=g.outerWidth(),q=function(a){b.$boxH.width()-a<n?g.css({left:a-n+18}).addClass("position-right"):g.css({left:a}).removeClass("position-right")},r=function(a){b.$boxB.scroll(function(){var c=a.offset().left-b.$grid.offset().left-1;q(c)})},q(j),r(k),c.columnFilter?b.colFilter(e):g.find("> ul > li."+b.classnames.li_filter).hide(),d.locking(e),s=g.find("> ul > li."+b.classnames.li_asc),t=s.next(),s.click(function(){h.sortAsc=!1,d.quickSort(h)}),t.click(function(){h.sortAsc=!0,d.quickSort(h)}),g.on("bjui.datagrid.th.sort",function(a,b){s.toggleClass("sort-active",b),t.toggleClass("sort-active",!b)})}))}),b.$grid.on("click.bjui.datagrid.filter",function(c){var d=a(c.target),e=b.$grid.find("."+b.classnames.s_menu+":visible");e.length&&!d.closest("."+b.classnames.btn_menu).length&&(d.closest("."+b.classnames.s_menu).length||e.hide().data("bjui.datagrid.menu.btn").removeClass("active"))})},b.prototype.colShowhide=function(a){var b=this,d=(b.options,b.tools),e=b.$menu,f=e.find("> ul"),g=f.find("> li."+b.classnames.li_showhide);a?b.$showhide||(d.createShowhide(),d.showSubMenu(g,e,b.$showhide)):g.hide()},b.prototype.showhideColumn=function(b,c){var f,g,d=this,e=d.tools;if("number"===a.type(b)){if(f=parseInt(b,10),0>f)return}else f=b.data("index");if(g=d.columnModel[f]){if(g.locked){if(c)return;d.colLock(g.th,c)}e.showhide(g,c)}},b.prototype.colFilter=function(b){var s,t,l,m,n,o,p,q,r,u,v,w,x,y,z,A,B,d=this,f=(d.options,d.tools),g=d.regional,h=b.data("bjui.datagrid.filter"),i=d.$menu,j=i.find("> ul > li."+d.classnames.li_filter),k=d.columnModel[b.data("index")];if(d.inputs&&d.inputs.length||f.initEditInputs(),k.quickfilter){if(j.find("."+d.classnames.s_filter).addClass("hide"),!h||!h.length){for(h=a(BJUI.doRegional(FRAG.gridFilter.replaceAll("#label#",b.text()),g)).hide().appendTo(d.$grid),l=b.data("index"),k=d.columnModel[l],m=k.type||"string",n=k.operator||[],o=h.find("span.filter-a"),p=h.find("span.filter-b"),q=a('<select data-toggle="selectpicker" data-container="true"></select>'),r=a(d.inputs[l]),r.removeAttr("data-rule").attr("size",10).addClass("filter-input"),"string"===m||"lookup"===m||"findgrid"===m?(n.length||(n=["=","!=","like"]),"findgrid"===m&&r.data("context",h)):"number"===m||"int"===m||"spinner"===m?("spinner"===m&&r.removeAttr("data-toggle"),n.length||(n=["=","!=",">","<",">=","<="])):"date"===m?n.length||(n=["=","!="]):"boolean"===m?(n.length||(n=["=","!="]),r=a(BJUI.doRegional('<select name="'+k.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',g))):"select"===m&&(n.length||(n=["=","!="]),r.attr("data-width","80"),r.find("> option:first-child").val()&&(r=a('<select name="'+k.name+'" data-toggle="selectpicker" data-width="80"></select>').append(BJUI.doRegional('<option value="">#all#</option>',g)).append(r.html()))),u=0,v=n.length;v>u;u++)q.append('<option value="'+n[u]+'">'+n[u]+"</option>");s=r,t=s.clone(),o.append(q).append(r),p.append(q.clone()).append(t),b.data("bjui.datagrid.filter",h),h.appendTo(j),h.data("width",h.outerWidth()).hide().initui(),h.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(a,b){for(var c in b)k.name==c&&r.val(b[c])}),w=h.find("button.ok"),x=h.find("button.clear"),y=h.find("select"),z=y.first(),A=y.last(),B=y.eq(1),w.click(function(){var c=z.val(),e=s.val().trim(),g=A.val(),k=t.val().trim(),l=B.val(),m={};e.length&&a.extend(m,{operatorA:c,valA:e}),k.length&&(e.length&&a.extend(m,{andor:l}),a.extend(m,{operatorB:g,valB:k})),a.isEmptyObject(m)||(f.quickFilter(d.columnModel[b.data("index")],m),d.$grid.trigger("click"),j.trigger("bjui.datagrid.th.submenu.hide",[i,h]))}),x.click(function(){var a=d.columnModel[b.data("index")];y.find("> option:first").prop("selected",!0),y.selectpicker("refresh"),s.val(""),t.val(""),a.isFiltered&&(f.quickFilter(a,null),d.$grid.trigger("click"),j.trigger("bjui.datagrid.th.submenu.hide",[i,h]))})}f.showSubMenu(j,i,h.removeClass("hide")),i.find('> ul > li:not(".'+d.classnames.li_filter+'")').on("mouseover",function(){j.hasClass("active")&&j.trigger("bjui.datagrid.th.submenu.hide",[i,h])})}else j.hide()},b.prototype.initPaging=function(){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,b=this,c=b.tools,e=(b.options,b.paging),f=BJUI.regional.pagination,g=FRAG.gridPaging,h=[],i=e.pageCount,k=[],l=BJUI.StrBuilder(),j=c.getPageInterval(i,e.pageCurrent,e.showPagenum);for(m=j.start;m<j.end;m++)h.push(FRAG.gridPageNum.replace("#num#",m).replace("#active#",e.pageCurrent==m?" active":""));g=BJUI.doRegional(g.replaceAll("#pageCurrent#",e.pageCurrent).replaceAll("#count#",e.total+"/"+parseInt(i||0,10)),f),l.add('<div class="paging-content" style="width:'+b.$boxB.width()+'px;">').add('<div class="datagrid-pagesize"><button type="button" class="btn-default btn-refresh" title="'+f.refresh+'" data-icon="refresh"></button>').add('<select data-toggle="selectpicker"></select>').add("</div>").add('<div class="datagrid-paging">').add(g.replace("#pageNumFrag#",h.join(""))).add("</div>").add("</div>"),b.$boxP.html(l.toString()),b.$boxP.initui(),n=b.$boxP.find("div.datagrid-pagesize > select"),o=b.$boxP.find("ul.pagination"),p=o.find("> li.page-total"),q=p.next(),r=q.next(),s=r.next(),t=s.nextAll(".page-next"),u=t.next(),v=function(){r.addClass("disabled"),s.addClass("disabled")},w=function(){r.removeClass("disabled"),s.removeClass("disabled")},x=function(){t.addClass("disabled"),u.addClass("disabled")},y=function(){t.removeClass("disabled"),u.removeClass("disabled")},z=function(){v(),y()},A=function(){w(),x()},B=function(c){n.empty(),c||(c=b.paging.pageSize),k=e.selectPageSize.split(","),k.push(String(c)),a.unique(k).sort(function(a,b){return a-b});var d=[];a.each(k,function(a,b){d.push('<option value="'+b+'"'+(b==e.pageSize&&"selected")+">"+b+"/"+f.page+"</option>")}),n.html(d.join("")).selectpicker("refresh")},1==e.pageCurrent&&z(),e.pageCurrent==e.pageCount&&(A(),1==e.pageCurrent&&v()),e.total||x(),B(),b.$boxP.on("click.datagrid.pagenum","li.page-num",function(c){var d=a(this);d.hasClass("active")||b.jumpPage(d.text()),c.preventDefault()}).on("click.datagrid.refresh","button.btn-refresh",function(){b.refresh()}).on("bjui.datagrid.paging.jump",function(){var h,d=b.paging.pageCurrent,f=c.getPageInterval(b.paging.pageCount,d,e.showPagenum),g=[];for(h=f.start;h<f.end;h++)g.push(FRAG.gridPageNum.replace("#num#",h).replace("#active#",d==h?" active":""));o.find("> li.page-num").remove(),s.after(g.join("")),1==d?(z(),d==b.paging.pageCount&&x(),b.paging.total||x()):d==b.paging.pageCount?A():(w(),y()),q.find("input").val(d),p.find("> span").html(b.paging.total+"/"+b.paging.pageCount)}).on("bjui.datagrid.paging.pageSize",function(a,b){B(b)}).on("change","div.datagrid-pagesize > select",function(){var c=a(this).val();b.jumpPage(null,c)}),q.find("input").on("keyup",function(c){if(c.which===BJUI.keyCode.ENTER){var d=a(this).val();d&&b.jumpPage(d)}}),r.on("click",function(){b.paging.pageCurrent>1&&b.jumpPage(1)}),s.on("click",function(){b.paging.pageCurrent>1&&b.jumpPage(b.paging.pageCurrent-1)}),t.on("click",function(){b.paging.pageCurrent<b.paging.pageCount&&b.jumpPage(b.paging.pageCurrent+1)}),u.on("click",function(){b.paging.pageCurrent<b.paging.pageCount&&b.jumpPage(b.paging.pageCount)})},b.prototype.jumpPage=function(a,b){var c=this,d=c.paging,e=d.pageCount;a&&isNaN(a)||b&&isNaN(b)||a&&(a=parseInt(a,10),1>a&&(a=1),a>e&&(a=e),a==d.pageCurrent)||b&&(b=parseInt(b,10),"remote"!=c.options.local&&d.pageSize>d.total)||c.tools.jumpPage(a,b)},b.prototype.add=function(b,c){var h,m,d,e,g,i,l,n;if(this.tools.beforeEdit()){if(!this.options.editUrl)return BJUI.debug("Datagrid Plugin: Edit url is not set!"),void 0;if(this.options.editMode){if(this.options.inlineEditMult){if("inline"!=this.options.editMode&&this.$tbody.find("> tr."+this.classnames.tr_add).length)return}else this.doCancelEditRow(this.$tbody.find("> tr."+this.classnames.tr_edit));d=this,e=d.options,d.tools,g=d.paging,i={},l=(g.pageCurrent-1)*g.pageSize,n=function(){var e=a("<tr></tr>").addClass(d.classnames.tr_add),f=e.clone();return a.each(d.columnModel,function(b,c){var h=a("<td></td>");c.gridChild?h.addClass(d.classnames.td_child).html("<div>"+BJUI.doRegional(FRAG.gridExpandBtn,d.regional)+"</div>"):c.gridNumber?h.addClass(d.classnames.td_linenumber).text(0):c.gridCheckbox?h.addClass(d.classnames.td_checkbox).html('<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'):c.gridEdit?h.addClass(d.classnames.s_edit).data("isAdd",!0).html(BJUI.doRegional(FRAG.gridEditBtn,d.regional)):h.text(""),c.hidden&&h.css("display","none"),c.align&&h.attr("align",c.align),c.name&&(i[c.name]=""),c.locked?c.gridCheckbox?(h.clone().hide().appendTo(e),h.show().appendTo(f)):(h.clone().show().appendTo(f),h.hide().appendTo(e)):h.appendTo(e)}),c&&"object"==typeof c&&e.data("datagrid.addData",c),i=a.extend({},d.attach,i),d.emptyData||(d.emptyData=i),{tr:e,lockTr:f.find("> td").length?f:null}},b||(b=e.addLocation||"first"),d.$lastSelect||("prev"===b?b="first":"next"===b&&(b="last")),"first"===b?(m=0,h=n(m),h.tr.prependTo(d.$tbody),h.lockTr&&h.lockTr.prependTo(d.$lockTbody)):"last"===b?(m=d.data?d.data.length:0,h=n(m),h.tr.appendTo(d.$tbody),h.lockTr&&h.lockTr.appendTo(d.$lockTbody)):"prev"===b?(m=d.$lastSelect.index(),h=n(m),h.tr.insertBefore(d.$lastSelect),h.lockTr&&h.lockTr.insertBefore(d.$lockTbody.find("> tr:eq("+d.$lastSelect.index()+")"))):"next"===b&&(m=d.$lastSelect.index()+1,h=n(m),h.tr.insertAfter(d.$lastSelect),h.lockTr&&h.lockTr.insertAfter(d.$lockTbody.find("> tr:eq("+d.$lastSelect.index()+")"))),c=a.extend({},d.emptyData,{addFlag:!0}),d.data||(d.data=[]),d.allData||(d.allData=[]),d.allData.length?d.allData.splice(m+l,0,c):d.allData.push(c),d.data.length?d.data.splice(m,0,c):d.data.push(c),a.each(d.data,function(b,c){var d=e.linenumberAll?l+(b+1):b+1;a.extend(c,{gridNumber:d,gridIndex:b})}),h.tr.initui(),h.lockTr&&h.lockTr.initui(),e.showNoDataTip&&d.$tbody.find("> tr.datagrid-nodata").remove(),"auto"===e.height&&d.fixedHeight(),setTimeout(function(){d.initEvents(h.tr)},20),h.lockTr&&d.initLockEvents(h.lockTr),d.edit(h.tr),e.hasChild&&e.childOptions&&h.tr.after('<tr class="'+d.classnames.tr_child+'"></tr>'),"dialog"!=e.editMode?d.doEditRow(h.tr,"inline",!0):d.dialogEdit(h.tr,!0)}}},b.prototype.edit=function(b){var h,i,j,k,l,c=this,d=c.options,e=c.tools,f=d.editMode;if(c.columnModel,c.editInit=!1,f){if("object"==typeof f){i={},j=["dialog","navtab","div"],k=!1,c.editOptions=null;for(l in f)if(-1!=a.inArray(l,j)){i.type=l,i.options=f[l],k=!0;break}if(!k)return BJUI.debug("Dialog Plugn: The options 'editModel' set error!"),void 0;a.isEmptyObject(i)||(c.editOptions=i)}else c.options.editUrl&&(c.options.editUrl=c.options.editUrl.replace(/{\/?[^}]*}/g,"")),"dialog"!=f&&(f="inline");b||(b=c.$tbody.find("> tr")),h=b.find("> td."+c.classnames.s_edit),c.editInit=!0,h.each(function(){var b=a(this),d=b.find("button"),g=d.first(),h=g.next(),i=h.next(),j=i.next(),k=j.next();g.on("click",function(g,h){var i=a(this),l=i.closest("tr"),m=l.index(),n=b.data("isAdd");return m=c.tools.getNoChildDataIndex(m),h||(h=c.isDom?l.data("initData")||e.setDomData(l):c.data[m]),e.beforeEdit(l,h)?c.editOptions?(c.externalEdit(l,null,h),!1):("dialog"!=f?(c.inlineEdit(l,n),d.hide(),k.show(),j.show()):c.dialogEdit(l,n),g.stopPropagation(),void 0):!1}),i.on("click",function(b){var d=a(this),e=d.closest("tr");c.updateEdit(e,d),b.stopPropagation()}).on("bjui.datagrid.update.tr",function(){}),h.on("click",function(b){var d=a(this),e=d.closest("tr");c.updateEdit(e,d),b.stopPropagation()}).on("bjui.datagrid.update.tr",function(){}),j.on("click",function(b){var e=a(this),f=e.closest("tr");c.cancelEdit(f),d.hide(),g.show(),k.show(),b.stopPropagation()}),k.on("click",function(b){var d=a(this),e=d.closest("tr");c.delRows(e),b.stopPropagation()})})}},b.prototype.externalEdit=function(b,c,d){var h,i,j,k,m,n,e=this,f=e.options,g={},l=["dialog","navtab","div"];if(c&&"object"==typeof c){for(m in c)if(-1!=a.inArray(m,l)){g.type=m,g.options=c[m];break}}else g=a.extend({},e.editOptions);if(b instanceof jQuery)h=b;else{if(isNaN(b))return BJUI.debug("Datagrid Plugin: Func 'externalEdit', Parameter 'row' is incorrect!"),void 0;h=e.$tbody.find("> tr:not(."+e.classnames.tr_child+")").eq(parseInt(b,10))}return"undefined"==typeof g?(BJUI.debug("Datagrid Plugin: Func 'externalEdit', Parameter 'editOptions' is incorrect!"),void 0):(g&&(d||(e.isDom?d=h.data("initData")||e.tools.setDomData(h):(i=e.tools.getNoChildDataIndex(h.index()),d=e.data[i])),(!g.options.url||g.options["datagrid.nourl"])&&(g.options["datagrid.nourl"]=!0,g.options.url=f.editUrl),j=g.options.url,j&&!j.isFinishedTm()&&(j=!d||d.addFlag?j.replace(/{\/?[^}]*}/g,""):e.tools.replacePlh(j,d),j.isFinishedTm()?j=j:BJUI.debug("Datagrid Plugin: Func 'externalEdit', the property 'url' of options 'editOptions' is incorrect: "+j)),j&&(g.options.url=j,k=g.type,h.data("datagrid.addData")&&(g.options.data?a.extend(g.options.data,h.data("datagrid.addData")):g.options.data=h.data("datagrid.addData")),g.options.id||(g.options.id="datagrid-external-edit"+(new Date).getTime()),g.options.onClose=function(){h.hasClass(e.classnames.tr_add)&&e.cancelEdit(h)},n=function(b){var f,i,c=!1;"array"===a.type(b)?(c=!0,f=b[0]):"object"==typeof b&&(c=!0,f=b),c&&(a.extend(d,"object"==typeof f&&f),h.hasClass(e.classnames.tr_add)&&h.length===e.$tbody.find("> tr:not(."+e.classnames.tr_child+")").length&&e.fixtedColumnWidthCount&&(e.fixedColumnWidth=!0),d.addFlag&&(d.addFlag=!1),e.dialogEditComplete(h,d),"dialog"===k?BJUI.dialog("close",g.options.id):"navtab"===k&&BJUI.navtab("closeTab",g.options.id),e.tools.afterSave(h,d),d["refresh.datagrid.child"]&&(i=h.data("bjui.datagrid.child"),i&&i.length?i.datagrid("refresh"):e.showChild(h)))},g.options.onLoad=function(b){var c=b.find("form.datagrid-edit-form");c&&c.length&&(c=c.first(),c.removeAttr("okCallback").data("okCallback",a.proxy(n,e)))},"dialog"===k?BJUI.dialog(g.options):"navtab"===k?BJUI.navtab(g.options):"div"===k&&BJUI.ajax("doload",g.options))),void 0)},b.prototype.doEditRow=function(b,c,d){var f,g,e,h,j,i;if(this.editInit&&(e=this,h=[],c=c||e.options.editMode,"object"==typeof b?f=b:isNaN(b)?(i=e.$tbody.find("> tr:not(."+e.classnames.tr_child+")"),b=b.split(","),b=b.unique(),b.sort(function(a,b){return a.trim()-b.trim()}),a.each(b,function(a,b){var d,c=parseInt(b.trim(),10);d=i.eq(c),d&&d.length&&(j=j?j.add(d):d)}),f=j):isNaN(b)||(f=e.$tbody.find("> tr:not(."+e.classnames.tr_child+")").eq(b)),f.length&&(f.each(function(){var d,b=a(this),c=b.index();c=e.tools.getNoChildDataIndex(c),d=e.isDom?b.data("initData")||tools.setDomData(b):e.data[c],h.push(d)}),e.tools.beforeEdit(f,h))))return e.options.editUrl?(e.editOptions?e.externalEdit(f.last(),null,h[f.length-1]):f.each(function(b){var f=a(this);return g=f.find("> td."+e.classnames.s_edit+" button.edit"),"dialog"==c?(e.dialogEdit(f,d,h[b]),!1):(g.length?g.trigger("click",[h[b]]):e.inlineEdit(f,d,h[b]),void 0)}),void 0):(BJUI.debug("Datagrid Plugin: Edit url is not set!"),void 0)},b.prototype.doCancelEditRow=function(b){var d,c=this;d="number"===a.type(b)?this.$tbody.find("> tr").eq(b):b,d.each(function(){var b=a(this),d=b.find("> td."+c.classnames.s_edit+" > button.cancel");d.length?d.trigger("click"):c.cancelEdit(b)})},b.prototype.doSaveEditRow=function(b){var e,c=this,d=c.options;return e="number"===a.type(b)?this.$tbody.find("> tr").eq(b):b?b:c.$tbody.find("> tr."+c.classnames.tr_edit),e.length?(1==e.length?e.hasClass(c.classnames.tr_edit)&&this.updateEdit(e):d.saveAll?c.saveAll(e):e.each(function(){c.updateEdit(a(this))}),void 0):(c.$grid.alertmsg("info",BJUI.getRegional("datagrid.saveMsg")),void 0)},b.prototype.delRows=function(b){var g,i,h,j,k,c=this,d=c.options,e=d.beforeDelete,f=d.delConfirm;(!e||("string"==typeof e&&(e=e.toFunc()),"function"!=typeof e||e.call(this)))&&("object"==typeof b?g=b:isNaN(b)?(h=c.$tbody.find("> tr:not(."+c.classnames.tr_child+")"),b=b.split(","),b=b.unique(),b.sort(function(a,b){return a.trim()-b.trim()}),a.each(b,function(a,b){var c=h.eq(parseInt(b.trim(),10));c&&c.length&&(i=i?i.add(c):c)}),g=i):isNaN(b)||(g=this.$tbody.find("> tr:not(."+c.classnames.tr_child+")").eq(b)),g&&g.length&&(j=function(){g.each(function(){var b=a(this),d=c.options.childUpdate,e=c.$element.data("bjui.datagrid.parent"),f=function(a){a.closest("table").datagrid("updateRow",a)};e&&d&&("string"==typeof d?(-1!==d.indexOf("all")||-1!==d.indexOf("del"))&&f(e):f(e)),console.log("ASDA"),b.trigger("bjui.datagrid.tr.delete")}),c.tools.afterDelete(),"auto"===d.height&&c.fixedHeight()},k=function(){var e,f,h,i,b=g.filter("."+c.classnames.tr_add);(!b.length||(c.cancelEdit(b),g.not(b).length))&&(d.delUrl?(e=[],f=d.delCallback,g.not(b).each(function(){var g,h,b=a(this),f=b.index();g=c.isDom?b.data("initData")||c.tools.setDomData(b):c.data[c.tools.getNoChildDataIndex(f)],d.delPK?e.push(g[d.delPK]):(d.jsonPrefix?(h={},a.each(g,function(a,b){return"gridCheckbox"===a||"gridEdit"===a?!0:(h[d.jsonPrefix+"."+a]=b,void 0)})):(h=a.extend({},g),delete h.gridCheckbox,delete h.gridEdit),e.push(h))}),"string"==typeof f&&(f=f.toFunc()),h=d.delType,i={url:d.delUrl,data:d.delPK?[{name:d.delPK,value:e.join(",")}]:JSON.stringify(e),type:"POST",okCallback:f||function(){j()}},h&&"raw"===h&&!d.delPK?i.contentType="application/json":(!d.delPK&&(i.data={json:i.data}),h&&"raw"!==h&&(i.type=h)),BJUI.ajax("doajax",i)):j())},f?("string"!=typeof f&&(f=1==g.length?BJUI.getRegional("datagrid.delMsg"):BJUI.getRegional("datagrid.delMsgM")),c.$grid.alertmsg("confirm",f,{okCall:function(){k()}})):k()))},b.prototype.inlineEdit=function(b,c,d){if(!this.tools.beforeEdit(b,d))return!1;var e=this,f=[],g=e.options,h=e.tools,i=e.columnModel,j=b.find("> td"),k=j.length,l=b.index(),m=l;return m=h.getNoChildDataIndex(m),d||(d=e.isDom?b.data("initData")||h.setDomData(b):e.data[m]),b.hasClass(e.classnames.tr_edit)?!1:(e.inputs&&e.inputs.length||h.initEditInputs(),b.addClass(e.classnames.tr_edit).data(e.datanames.changeData,{}),b.data("validator")&&b.validator("destroy"),g.inlineEditMult||e.doCancelEditRow(b.siblings("."+e.classnames.tr_edit)),e.$lastEditTr=b,j.each(function(g){var p,r,s,h=a(this),j=i[g],m=j&&j.name&&d[j.name],n=h.html(),o=e.inputs[g],q=function(g,h,i){var k=b.data(e.datanames.changeData),l=j.jsontype,m="undefined"==typeof j.defaultVal?null:j.defaultVal;switch(j.type){case"date":g.on("afterchange.bjui.datepicker",function(){h.addClass(e.classnames.td_changed),g.val()==i&&h.removeClass(e.classnames.td_changed),k[j.name]=g.val()}).change(function(){h.addClass(e.classnames.td_changed),g.val()==i&&h.removeClass(e.classnames.td_changed),k[j.name]=g.val()});break;case"select":g.change(function(){var b=a(this).val();h.addClass(e.classnames.td_changed),b==String(i)&&h.removeClass(e.classnames.td_changed),g.prop("multiple")?a.isArray(b)&&(b=b.join(",")):l&&("boolean"===l?b=Boolean(b):"number"===l&&!isNaN(Number(b))&&(b=Number(b))),k[j.name]=b});break;case"boolean":g.on("ifChanged",function(){h.toggleClass(e.classnames.td_changed);var b=a(this).is(":checked");b==i&&h.removeClass(e.classnames.td_changed),k[j.name]=b});break;case"findgrid":k[j.name]=g.val(),h.on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(a,b){var c=b.value;h.toggleClass(e.classnames.td_changed),c==k[j.name]&&h.removeClass(e.classnames.td_changed),l&&"number"===l&&!isNaN(Number(c))&&(c=Number(c)),k[j.name]=c}),g.change(function(){var b=a(this).val();h.addClass(e.classnames.td_changed),b==i&&h.removeClass(e.classnames.td_changed),l&&"number"===l&&!isNaN(Number(b))&&(b=Number(b)),k[j.name]=b});break;case"lookup":h.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(a,b){var c,i;h.toggleClass(e.classnames.td_changed);for(c in b)for("undefined"!=typeof d[c]&&(k[c]=b[c]),i=1;i<f.length;i++)if(g=f[i],c==g.prop("name")){f[i].val(b[c]),g.val()==b[c]?h.removeClass(e.classnames.td_changed):g.val(b[c]);break}}),g.change(function(){h.addClass(e.classnames.td_changed),g.val()==i&&h.removeClass(e.classnames.td_changed),k[j.name]=g.val()});break;case"spinner":g.on("afterchange.bjui.spinner",function(){h.addClass(e.classnames.td_changed),g.val()==i&&h.removeClass(e.classnames.td_changed),k[j.name]=Number(g.val())}).change(function(){h.addClass(e.classnames.td_changed),g.val()==i&&h.removeClass(e.classnames.td_changed),k[j.name]=Number(g.val())});break;default:g.change(function(){var b=a(this).val();h.addClass(e.classnames.td_changed),b==i&&h.removeClass(e.classnames.td_changed),l&&"number"===l&&!isNaN(Number(b))&&(b=Number(b)),k[j.name]=b})}c?"boolean"===j.type?(m=Boolean(m),k[j.name]=m,g.prop("checked",m)):null!=m?(g.isTag("select")&&g.prop("multiple")?g.val(a.isArray(m)?m:m.split(",")):g.val(String(m)),l&&("number"===l?!isNaN(Number(m))&&(m=Number(m)):"boolean"===l&&(m=Boolean(m))),k[j.name]=m):g.isTag("select")&&!g.prop("multiple")&&(k[j.name]=g.val()):l&&g.trigger("change")};h.data(e.datanames.td_html,n),c?j.add||(o=""):(d.addFlag&&(d.addFlag=!1),j.edit||(o="")),o&&(p=a(o),("undefined"==typeof m||"null"===m||null===m)&&(m=""),"boolean"===j.type?p.prop("checked",m):"findgrid"===j.type?p.data("context",b).val(String(m)):(p.val(String(m)),p.isTag("select")&&p.prop("multiple")&&m&&!a.isArray(m)&&p.val(m.split(","))),c?j.addAttrs&&"object"==typeof j.addAttrs&&a.each(j.addAttrs,function(a,b){p.attr(a,b)}):j.editAttrs&&"object"==typeof j.editAttrs&&a.each(j.editAttrs,function(a,b){p.attr(a,b)}),h.empty().append(p).addClass(e.classnames.td_edit),q(p,h,m),f[g]=p,j.locked&&(r=e.$lockTbody.find("tr:eq("+l+")"),s=r.find("> td:eq("+j.lockIndex+")"),h.clone().html(n).insertAfter(h),h.show().insertAfter(s).initui(),s.remove())),--k||b.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})}),void 0)},b.prototype.saveAll=function(b){var f,g,h,j,k,o,p,q,c=this,d=c.options,e=d.editCallback,i=[],l=[],m=[],n=b&&b.length;return(!b||b.length)&&(b=c.$tbody.find("> tr."+c.classnames.tr_edit),n=b.length),n?(b.each(function(){f=a(this),h=c.tools.getNoChildDataIndex(f.index()),g=c.isDom?f.data("initData"):c.data[h],i.push(g),f.isValid(function(b){return b?(j=f.data(c.datanames.changeData),a.extend(g,j),d.jsonPrefix?(k={},a.each(g,function(a,b){return"gridChild"===a||"gridCheckbox"===a||"gridEdit"===a?!0:(k[d.jsonPrefix+"."+a]=b,void 0)})):(k=a.extend({},g),delete k.gridChild,delete k.gridCheckbox,delete k.gridEdit),n--,l.push(k),void 0):(l=[],!1)})}),n||(e=e?e.toFunc():function(d){"array"===a.type(d)?m=d:"object"==typeof d&&m.push(d),b.filter("."+c.classnames.tr_add).length===c.$tbody.find("> tr:not(."+c.classnames.tr_child+")").length&&c.fixtedColumnWidthCount&&(c.fixedColumnWidth=!0),b.each(function(b){f=a(this),h=f.index(),c.columnModel[0]===c.childColumn&&(h/=2),g=c.isDom?f.data("initData"):c.data[h],a.extend(g,"object"==typeof m[b]&&m[b]),c.allData&&c.allData[g.gridIndex]&&a.extend(c.allData[g.gridIndex],g),c.inlineEditComplete(f,g)}),c.tools.afterSave(b,l)},o=d.issaveallback,"string"==typeof o?(o=o.toFunc(),o(l)):c.tools.beforeSave(b,i)&&(p=d.editType,q={url:d.editUrl,data:JSON.stringify(l),type:"POST",okCallback:e},p&&"raw"===p?q.contentType="application/json":(q.data={json:q.data},p&&(q.type=p)),BJUI.ajax("doajax",q))),void 0):(o=d.issaveallback,"string"==typeof o&&(o=o.toFunc(),o("")),void 0)},b.prototype.updateEdit=function(b,c){var g,i,j,l,d=this,e=d.options,f=e.editCallback,h=[],k=[],m=b.index();m=d.tools.getNoChildDataIndex(m),g=d.isDom?b.data("initData"):d.data[m],b.hasClass(d.classnames.tr_edit)&&b.isValid(function(m){if(m&&(i=b.data(d.datanames.changeData),a.extend(g,i),e.jsonPrefix?(j={},a.each(g,function(a,b){return"gridChild"===a||"gridCheckbox"===a||"gridEdit"===a?!0:(j[e.jsonPrefix+"."+a]=b,void 0)})):(j=a.extend({},g),delete j.gridChild,delete j.gridCheckbox,delete j.gridEdit),f=f?f.toFunc():function(e){"array"===a.type(e)?l=e[0]:"object"==typeof e&&(l=e),a.extend(g,"object"==typeof l&&l),d.allData&&d.allData[g.gridIndex]&&a.extend(d.allData[g.gridIndex],g),b.hasClass(d.classnames.tr_add)&&b.length===d.$tbody.find("> tr:not(."+d.classnames.tr_child+")").length&&d.fixtedColumnWidthCount&&(d.fixedColumnWidth=!0),d.inlineEditComplete(b,g,c),d.tools.afterSave(b,g)},h.push(g),d.tools.beforeSave(b,h))){k.push(j);var n=e.editType,o={url:e.editUrl,data:JSON.stringify(k),type:"POST",okCallback:f};n&&"raw"===n?o.contentType="application/json":(o.data={json:o.data},n&&(o.type=n)),BJUI.ajax("doajax",o)}})},b.prototype.cancelEdit=function(b){var c=this,d=c.columnModel;b.each(function(){var b=a(this),e=b.index(),f=e;b.hasClass(c.classnames.tr_edit)&&b.removeClass(c.classnames.tr_edit).find("> td."+c.classnames.td_edit).each(function(){var i,j,b=a(this),f=b.index(),g=d[f],h=b.data(c.datanames.td_html);b.removeClass(c.classnames.td_edit).removeClass(c.classnames.td_changed).html(h),g.locked&&(i=c.$lockTbody.find("tr:eq("+e+")"),j=i.find("> td:eq("+g.lockIndex+")"),h=j.data(c.datanames.td_html),i.removeClass(c.classnames.tr_edit),j.removeClass(c.classnames.td_edit).removeClass(c.classnames.td_changed).html(h))}),b.hasClass(c.classnames.tr_add)&&(f=c.tools.getNoChildDataIndex(f),c.data=c.data.remove(f),b.next().hasClass(c.classnames.tr_child)&&(b.next().remove(),c.$lockTbody&&c.$lockTbody.find("> tr:eq("+e+")").next().remove()),c.$lockTbody&&c.$lockTbody.find("> tr:eq("+e+")").remove(),b.remove(),c.tools.createNoDataTr(),"auto"===c.options.height&&c.fixedHeight())})},b.prototype.inlineEditComplete=function(c,d,e){var l,f=this,g=f.columnModel,h=c.index(),i=c.find("> td"),j=!1,k=f.$lockTbody&&f.$lockTbody.find("> tr:eq("+h+")");a.each(g,function(a,c){var g,e,h,l;return c.gridNumber&&(j=!0),c.gridChild||c.gridNumber||c.gridCheckbox||c.gridEdit?!0:(e=c.name?d[c.name]:"",h=i.eq(c.index),"undefined"==typeof e&&(e=""),h.text(e).removeClass(f.classnames.td_edit).removeClass(f.classnames.td_changed),c.render&&"function"==typeof c.render?c.items?(g=c.render.call(f,e,d,c.items),h.html(g)):(g=c.render.call(f,e,d),h.html(g)):c.items&&(g=b.renderItem.call(f,e,d,c.items),h.html(g)),c.locked&&k&&(l=k.find("> td:eq("+c.lockIndex+")"),l.removeClass(f.classnames.td_changed).html(h.html())),void 0)}),c.removeClass(f.classnames.tr_edit).initui(),k&&k.removeClass(f.classnames.tr_edit).initui(),e||(e=i.filter("."+f.classnames.s_edit).find("button.update")),e&&e.length&&e.trigger("bjui.datagrid.update.tr"),c.hasClass(f.classnames.tr_add)&&(c.removeClass(f.classnames.tr_add),c.find("> td."+f.classnames.s_edit).removeData("isAdd"),j&&(f.linenumberColumn.locked&&(f.colLock(f.linenumberColumn.th,!1),l=!0),f.$tbody.find("> tr:not(."+f.classnames.tr_child+")").each(function(b){var c=a(this);c.find("> td."+f.classnames.td_linenumber).text(b+1)}),l&&f.colLock(f.linenumberColumn.th,!0)),c.next("."+f.classnames.tr_child).remove(),f.tools.createChildTr(c,d))},b.prototype.dialogEdit=function(b,c,d){var k,l,n,e,f,g,h,i,j,o,p,q,r;return this.tools.beforeEdit(b,d)?(e=this,f=e.options,g=e.tools,h=e.columnModel,i=b.index(),j=i,d||(j=g.getNoChildDataIndex(j),d=e.isDom?b.data("initData")||g.setDomData(b):e.data[j]),e.inputs&&e.inputs.length||g.initEditInputs(),n=f.gridTitle||"datagrid",c?n+=" - "+BJUI.getRegional("datagrid.add"):(d.addFlag&&(d.addFlag=!1),n+=" - "+BJUI.getRegional("datagrid.edit")),k=a('<div><div class="bjui-pageContent"></div><div class="bjui-pageFooter"></div></div>'),l=a('<form class="datagrid-dialog-edit-form"></form>'),o=function(b,f,g,h){var i=b.data(e.datanames.changeData),j=h.jsontype,k="undefined"==typeof h.defaultVal?null:h.defaultVal;switch(h.type){case"date":g.on("afterchange.bjui.datepicker",function(){i[h.name]=a(this).val()}).change(function(){i[h.name]=a(this).val()});break;case"select":g.change(function(){var b=a(this),c=b.val(),d=b.prop("multiple");d&&a.isArray(c)&&(c=c.join(",")),!d&&j&&("boolean"===j?c=Boolean(c):"number"===j&&!isNaN(Number(c))&&(c=Number(c))),i[h.name]=c});break;case"boolean":g.on("ifChanged",function(){i[h.name]=a(this).is(":checked")});break;case"findgrid":f.on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(a,b){var c=b.value;j&&"number"===j&&!isNaN(Number(c))&&(c=Number(c)),i[h.name]=c}),g.change(function(){i[h.name]=a(this).val()});break;case"lookup":f.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(b,c){for(var e in c)"undefined"!=typeof d[e]&&(i[e]=c[e]),h.name==e&&a(this).val(c[e])}),g.change(function(){i[h.name]=a(this).val()});break;case"spinner":g.on("afterchange.bjui.spinner",function(){i[h.name]=Number(a(this).val())}).change(function(){i[h.name]=Number(a(this).val())});break;default:g.change(function(){var b=a(this).val();j&&"number"===j&&!isNaN(Number(b))&&(b=Number(b)),i[h.name]=b})}c?"boolean"===h.type?(k=Boolean(k),i[h.name]=k,g.prop("checked",k)):null!=k?(g.isTag("select")&&g.prop("multiple")?g.val(a.isArray(k)?k:k.split(",")):g.val(String(k)),j&&("number"===j?!isNaN(Number(k))&&(k=Number(k)):"boolean"===j&&(k=Boolean(k))),i[h.name]=k):g.isTag("select")&&!g.prop("multiple")&&(i[h.name]=g.val()):j&&g.trigger("change")},p=function(i){var q,r,j=i.find("form.datagrid-dialog-edit-form"),k=i.find("div.bjui-pageFooter button"),l=k.first(),m=k.eq(1),n=k.eq(2),p=k.last(),s=function(b,d,f){d.empty(),f.data(e.datanames.changeData)||f.data(e.datanames.changeData,{}),d.data("validator")&&d.validator("destroy"),a.each(h,function(g,h){if(!h.name||h===e.childColumn||h===e.linenumberColumn||h===e.checkboxColumn||h===e.editBtnsColumn)return!0;var j,i=e.inputs[g],k=a("<p></p>"),l="datagrid-dialog-edit-column-"+g,m=b[h.name];c?h.add||(i=""):h.edit||(i=""),("undefined"==typeof m||"null"===m||null===m)&&(m=""),i?(j=a(i).attr("id",l),j.isTag("select")?j.attr("data-width","auto"):j.isTag("checkbox")||j.attr("size",30),"boolean"===h.type?j.prop("checked",m):"findgrid"===h.type?j.val(String(m)).data("context",d):j.val(String(m)),j.isTag("select")&&j.prop("multiple")&&m&&!a.isArray(m)&&j.val(m.split(",")),c?h.addAttrs&&"object"==typeof h.addAttrs&&a.each(h.addAttrs,function(a,b){j.attr(a,b)}):h.editAttrs&&"object"==typeof h.editAttrs&&a.each(h.editAttrs,function(a,b){j.attr(a,b)})):c||h.edit||(i=m),k.append('<label class="control-label x120" for="'+l+'">'+h.label+"：</label>").append(a('<span class="datagrid-dialog-column-span"></span>').append(j||i)).appendTo(d),j&&o(f,d,j,h)}),d.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})};j.is(":empty")&&s(d,j,b),q=b.index(),e.columnModel[0]===e.childColumn&&(q=2*q),q||l.addClass("disabled"),q==e.data.length-1&&m.addClass("disabled"),l.click(function(){var c,a=b.prev();e.options.hasChild&&e.options.childOptions&&(a=a.prev()),a.length?(r=e.tools.getNoChildDataIndex(a.index()),c=e.isDom?a.data("initData")||g.setDomData(a):e.data[r],b=a,s(c,j,b),m.removeClass("disabled"),a.prev().length||l.addClass("disabled")):l.addClass("disabled")}),m.click(function(){var c,d,a=b.next();e.options.hasChild&&e.options.childOptions&&(a=a.next()),a.length?(d=a.next(),r=e.tools.getNoChildDataIndex(a.index()),e.options.hasChild&&e.options.childOptions&&(d=d.length&&d.next()),c=e.isDom?a.data("initData")||g.setDomData(a):e.data[r],b=a,s(c,j,b),j.initui(),l.removeClass("disabled"),d&&d.length||m.addClass("disabled")):m.addClass("disabled")}),p.click(function(){var c,d,h,i,g=[],k=f.editCallback;r=e.tools.getNoChildDataIndex(b.index()),d=e.isDom?b.data("initData"):e.data[r],j.isValid(function(j){if(j&&(c=b.data(e.datanames.changeData),a.extend(d,c),f.jsonPrefix?(h={},a.each(d,function(a,b){return"gridChild"===a||"gridCheckbox"===a||"gridEdit"===a?!0:a&&edit&&add?(h[f.jsonPrefix+"."+a]=b,void 0):!0
    })):(h=a.extend({},d),delete h.gridCheckbox,delete h.gridEdit),k=k?k.toFunc():function(c){"array"===a.type(c)?i=c[0]:"object"==typeof c&&(i=c),a.extend(d,"object"==typeof i&&i),b.hasClass(e.classnames.tr_add)&&b.length===e.$tbody.find("> tr:not(."+e.classnames.tr_child+")").length&&e.fixtedColumnWidthCount&&(e.fixedColumnWidth=!0),e.dialogEditComplete(b,d),e.$grid.dialog("close","datagrid-dialog-edit"),e.tools.afterSave(b,d)},g.push(d),e.tools.beforeSave(b,g))){var l=f.editType,m={url:f.editUrl,data:JSON.stringify(h),type:"POST",okCallback:k};l&&"raw"===l?m.contentType="application/json":(m.data={json:m.data},l&&(m.type=l)),BJUI.ajax("doajax",m)}})}),n.click(function(){e.$grid.dialog("close","datagrid-dialog-edit")})},q=function(){var b=!1;e.$tbody.find("> tr."+e.classnames.tr_add).each(function(){var c=a(this),d=c.index(),f=d;f=e.tools.getNoChildDataIndex(f),e.data=e.data.remove(f),c.next().hasClass(e.classnames.tr_child)&&(c.next().remove(),e.$lockTbody&&e.$lockTbody.find("> tr:eq("+d+")").next().remove()),e.$lockTbody&&e.$lockTbody.find("> tr:eq("+d+")").remove(),c.remove(),b=!0}),b&&"auto"===e.options.height&&e.fixedHeight()},k.find("> div:first").append(l).next().append(BJUI.doRegional(FRAG.gridDialogEditBtns,e.regional)),r=a.extend({},{id:"datagrid-dialog-edit",fresh:!0,target:k[0],width:520,height:400,mask:!0,title:n,onLoad:p,onClose:q},"object"==typeof f.editDialogOp&&f.editDialogOp),e.$grid.dialog(r),void 0):!1},b.prototype.dialogEditComplete=function(c,d){var l,e=this,f=e.columnModel,g=c.index(),h=c.find("> td"),i=!1,k=(e.$tbody.find("> tr"),e.$lockTbody&&e.$lockTbody.find("> tr:eq("+g+")"));a.each(f,function(a,c){var g,f,j,l;return c.gridNumber&&(i=!0),c.gridChild||c.gridNumber||c.gridCheckbox||c.gridEdit?!0:(f=c.name?d[c.name]:"",j=h.eq(c.index),("undefined"==typeof f||"null"===f||null===f)&&(f=""),j.text(f).removeClass(e.classnames.td_edit).removeClass(e.classnames.td_changed),c.render&&"function"==typeof c.render?c.items?(g=c.render.call(e,f,d,c.items),j.html(g)):(g=c.render.call(e,f,d),j.html(g)):c.items&&(g=b.renderItem.call(e,f,d,c.items),j.html(g)),c.locked&&k&&(l=k.find("> td:eq("+c.lockIndex+")"),l.removeClass(e.classnames.td_edit).removeClass(e.classnames.td_changed).html(j.html())),void 0)}),c.initui(),k&&k.initui(),c.hasClass(e.classnames.tr_add)&&(c.removeClass(e.classnames.tr_add),i&&(e.linenumberColumn.locked&&(e.colLock(e.linenumberColumn.th,!1),l=!0),e.$tbody.find("> tr:not(."+e.classnames.tr_child+")").each(function(b){var c=a(this);c.find("> td."+e.classnames.td_linenumber).text(b+1)}),l&&e.colLock(e.linenumberColumn.th,!0)),c.next("."+e.classnames.tr_child).remove(),e.tools.createChildTr(c,d))},b.prototype.resizeGrid=function(){var d,f,b=this;b.$grid.getPageTarget(),f=function(){b.initFixedW&&String(b.options.width).endsWith("%")&&(d=b.$grid.parent().width(),b.fixedWidth(),b.options.hasChild&&b.options.childOptions&&b.$tbody.find("> tr."+b.classnames.tr_child+":visible").each(function(){var b=a(this),c=b.prev(),d=c.data("bjui.datagrid.child");d&&d.length&&d.datagrid("fixedWidth")})),String(b.options.height).endsWith("%")&&b.tools.setBoxbH()},a('a[data-toggle="tab"]').on("shown.bs.tab",a.proxy(function(c){if(!b.$element.data("bjui.datagrid.init.tab")){var d=a(c.target),e=d.data("target"),f=d.attr("href");e||(e=a(f)),e&&e.length&&e.find(b.$element).length&&(b.$element.data("bjui.datagrid.init.tab",!0),b.$element.datagrid("fixedHeight"))}},b)),a(window).on(BJUI.eventType.resizeGrid,a.proxy(f,b))},d=a.fn.datagrid,a.fn.datagrid=c,a.datagrid=b,a.fn.datagrid.noConflict=function(){return a.fn.datagrid=d,this},a(document).on(BJUI.eventType.initUI,function(b){a(b.target).find('table[data-toggle="datagrid"]').each(function(){var b=a(this),d=b.data();b.length&&(d.options&&"string"==typeof d.options&&(d.options=d.options.toObj()),a.extend(d,"object"==typeof d.options&&d.options),c.call(b,d))})})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.tablefixed");h||f.data("bjui.tablefixed",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS()};b.SCROLLW=18,b.DEFAULTS={width:"100%"},b.prototype.TOOLS=function(){var c={getLeft:function(b){var c=0;return b.prevAll().each(function(){c+=a(this).outerWidth()}),c},getRight:function(b){var c=0;return b.prevAll().addBack().each(function(){c+=a(this).outerWidth()}),c-1},getCellNum:function(a){return a.prevAll().addBack().size()},getColspan:function(a){return a.attr("colspan")||1},getStart:function(b){var c=1;return b.prevAll().each(function(){c+=parseInt(a(this).attr("colspan")||1)}),c},getPageCoord:function(a){for(var b={x:0,y:0};a;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b},getOffset:function(b,c){var d,e,f,g,h,i;return a.support.leadingWhitespace?(g=c.target,void 0==g.offsetLeft&&(g=g.parentNode),h=this.getPageCoord(g),i={x:window.pageXOffset+c.clientX,y:window.pageYOffset+c.clientY},f={offsetX:i.x-h.x,offsetY:i.y-h.y}):(d=b.offset(),e={offsetX:c.pageX||c.screenX,offsetY:c.pageY||c.screenY},f={offsetX:e.offsetX-d.left,offsetY:e.offsetY-d.top})}};return c},b.prototype.resetWidth=function(){var i,c=this.$element,d=c.width(),e=c.find("table"),f=e&&e.width(),g=e.eq(0)&&e.eq(0).find("tr:first-child > th"),h=e.eq(1)&&e.eq(1).find("tr:first-child > td");e&&d-f<b.SCROLLW&&(i=parseInt((d-f)/g.length),e.width(d-b.SCROLLW),g.each(function(b){var c=parseInt(a(this).css("width"));a(this).width(c+i),h.eq(b)&&h.eq(b).width(c+i)}))},b.prototype.init=function(){var a,b;this.$element.isTag("table")&&(this.$container=this.$element.parent().addClass("bjui-resizeGrid"),this.$fixed=void 0,a=this.$container.width(),b=this.options.height,this.$container.hasClass("tab-pane")&&(a=this.$container.parent().width()-20),this.options.newWidth="string"==typeof this.options.width&&this.options.width.indexOf("%")?a*(this.options.width.replace("%","")/100):parseInt(this.options.width),this.options.styles=[],this.$element.wrap('<div class="bjui-tablefixed clearfix"></div>'),this.$fixed=this.$element.parent(),this.initHead(),this.initBody(),this.resizeCol(),this.resizeGrid(),b&&!this.$fixed.closest(".tab-content").length&&this.$fixed.height(b).addClass("fixedH"))},b.prototype.initHead=function(){var g,h,i,j,k,l,m,n,o,c=this.options.styles=[],d=this.$element.find("thead > tr"),e=d.eq(0).find("> th");this.$element,g=0,h=[],i=[],j=-1,e.each(function(b){var k,c=a(this),d=parseInt(c.attr("colspan")||1),e=c.attr("width"),f=c.attr("align"),g="";for(k=0;d>k;k++)1==d&&e&&(g=' width="'+e+'"'),f&&c.removeAttr("align").addClass(f),h.push("<th"+g+"></th>");c.attr("colsNum",j+=d),i[b]=d}),k=h.length,l=a('<tr class="resize-head">'+h.join("")+"</tr>"),d.length>1&&(j=0,m=d.eq(1).find("> th"),a.each(i,function(a,b){var c,d,f,g,h,i,k;if(b=parseInt(b),b>1)for(c=parseInt(e.eq(a).attr("colsnum")),d=b-1;d>=0;d--)f=m.eq(j++),g=c-d,h=f.attr("width"),i=f.attr("align"),k=l.find("> th").eq(g),f&&f.length&&f.attr("colsnum",g),h&&k.attr("width",h),i&&f.addClass(i).removeAttr("align")})),this.$fixed.html(this.$element.html()),n=this.$fixed.find("thead"),n.prepend(l),l.find("> th").each(function(){var d=a(this),e=[],f=d.innerWidth();e[0]=parseInt(f),g+=e[0],c[c.length]=e}),g=parseInt((this.options.newWidth-b.SCROLLW-g)/k),o=n.find("> tr:eq(0) > th"),this.options.$ths=o,o.each(function(b){var d=a(this),e=c[b],f=d.attr("width");d.removeAttr("align").width(e[0]+g),e[0]=e[0]+g,f&&(e[0]=parseInt(f),d.width(f).removeAttr("width"))}),n.find("> tr:gt(0) > th").each(function(){var b=a(this);b.html('<div class="fixedtableCol">'+b.html()+"</div>")}),n.wrap('<div class="fixedtableHeader" style="width:'+(this.options.newWidth-b.SCROLLW)+'px;overflow:hidden;"><div class="fixedtableThead"><table class="table table-bordered" style="width:'+(this.options.newWidth-b.SCROLLW)+"px; max-width:"+(this.options.newWidth-b.SCROLLW)+'px;"></table></div></div>'),this.$fixed.append('<div class="resizeMarker" style="display:none; height:300px; left:57px;"></div><div class="resizeProxy" style="left:377px; display:none; height:300px;"></div>')},b.prototype.initBody=function(){var f,g,h,c=this,d=this.$fixed.find("> tbody");this.options.styles,this.options.height?g=this.options.height-this.$fixed.find(".fixedtableHeader").height()+"px":(g="100%",h=function(){var a=c.$fixed.parent().height();c.$fixed.parent().css("overflow","hidden"),c.$fixed.height(a).find(".fixedtableScroller").height(a-c.$fixed.find(".fixedtableHeader").height())},a(document).one(BJUI.eventType.afterInitUI,function(){h()})),f='style="height:'+g+'; overflow-y:auto;"',d.wrap('<div class="fixedtableScroller"'+f+' style="width:'+this.options.newWidth+'px;"><div class="fixedtableTbody"><table style="width:'+(this.options.newWidth-b.SCROLLW)+"px; max-width:"+(this.options.newWidth-b.SCROLLW)+'px;"></table></div></div>'),this.$element.attr("class")?d.parent().addClass(this.$element.attr("class")):d.parent().addClass("table table-striped table-bordered table-hover"),"undefined"!=typeof this.$element.attr("data-selected-multi")&&d.parent().attr("data-selected-multi",this.$element.attr("data-selected-multi")),d.before('<thead><tr class="resize-head">'+this.$fixed.find("thead > tr").html()+"</tr></thead>"),this.options.$tds=d.prev().find("> tr:first-child > th"),this.options.nowrap&&d.parent().addClass("nowrap"),d.closest(".fixedtableScroller").scroll(function(){var c=a(this),d=c.scrollLeft(),e=c.prev().find("> .fixedtableThead");return e.css({position:"relative",left:-d}),!1})},b.prototype.resizeCol=function(){var c=this,d=this.$fixed,e=this.options.$ths,f=this.options.$tds,g=this.tools;d.find("thead > tr:gt(0) > th").each(function(){var i=a(this);i.mouseover(function(a){var h=parseInt(d.find(".fixedtableThead").css("left"))||0,j=g.getOffset(i,a).offsetX,k=e.eq(i.attr("colsnum"));return i.outerWidth()-j<5?i.css("cursor","col-resize").off("mousedown.bjui.tablefixed.resize").on("mousedown.bjui.tablefixed.resize",function(a){d.find("> .resizeProxy").show().css({left:g.getRight(k)+h+d.position().left,top:d.position().top,height:d.height(),cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:d.find(".resizeMarker"),move:"horizontal",event:a,stop:function(){var a=d.find(".resizeProxy").position().left,e=d.find(".resizeMarker").position().left,h=a-e-k.outerWidth()-9,i=g.getCellNum(k),l=(k.width(),k.width()+h),m=f.eq(i-1),n=d.find("> .fixedtableHeader .table").width();k.width(l),m.width(l),d.find(".table").width(n+h),d.find(".resizeMarker, .resizeProxy").hide(),n+h+b.SCROLLW<c.options.newWidth?d.find(".fixedtableScroller").width(n+h+b.SCROLLW):(l=d.closest(".bjui-resizeGrid").innerWidth(),n+h+b.SCROLLW<l&&(l=n+h+b.SCROLLW),d.find(".fixedtableHeader").width(l-b.SCROLLW),d.find(".fixedtableScroller").width(l),d.width(l)),d.data("resizeGrid",!0)}}),d.find("> .resizeMarker").show().css({left:g.getLeft(k)+h+d.position().left,top:d.position().top,height:d.height()})}):i.css("cursor","default").off("mousedown.bjui.tablefixed.resize"),!1})})},b.prototype.setOrderBy=function(b){var c=this.$element,d=c.find(".fixedtableCol"),e=a(BJUI.doRegional(FRAG.orderby,BJUI.regional.orderby));b=b||this.options,c.addClass("orderby"),b.orderDirection&&(BJUI.ui.clientPaging||c.addClass(b.orderDirection),c.pagination("setClientOrder",{orderField:b.orderField,orderDirection:b.orderDirection})),d.length||(d=a('<div class="fixedtableCol">'+c.html()+"</div>").appendTo(c.empty())),e.data("orderField",b.orderField).appendTo(d).pagination("orderBy")},b.prototype.resizeGrid=function(){var c=this,d=function(){a("div.bjui-resizeGrid").each(function(){var j,d=a(this),e=d.width(),f=d.height(),g=d.find(".bjui-tablefixed"),h=g.find(".fixedtableThead").height(),i=c.options.newWidth;e&&d.find(".bjui-tablefixed").each(function(){var c=a(this);j=c.data("resizeGrid")?i:e,c.width(j),c.find(".table").width(j-b.SCROLLW),c.find(".fixedtableHeader").width(j-b.SCROLLW),c.find(".fixedtableScroller").width(j)}),d.css("overflow","hidden"),g.height(f).find(".fixedtableScroller").height(f-h)})};a(window).on(BJUI.eventType.resizeGrid,d)},d=a.fn.tablefixed,a.fn.tablefixed=c,a.fn.tablefixed.Constructor=b,a.fn.tablefixed.noConflict=function(){return a.fn.tablefixed=d,this},a(document).on(BJUI.eventType.initUI,function(b){var d=a(b.target).find('table[data-toggle="tablefixed"]');d.length&&c.call(d)}),a(document).on(BJUI.eventType.afterInitUI,function(b){var d=a(b.target).find("th[data-order-field]");d.length&&c.call(d,"setOrderBy")}),a(document).on("click.bjui.tr.data-api","tr[data-id]",function(){var c=a(this),d=c.closest("table"),e=d.data("selectedMulti"),f=c.attr("data-id"),g="selected",h=d.closest(".unitBox").find("#bjui-selected");c.toggleClass(g),e?(f=[],c.siblings("."+g).add(c.hasClass(g)?c:"").each(function(){f.push(a(this).attr("data-id"))}),f=f.join(",")):(c.siblings().removeClass(g),c.hasClass(g)||(f="")),h&&h.length?h.val(f):(h=a('<input type="hidden" id="bjui-selected" value="'+f+'">'),h.appendTo(d.closest(".unitBox")))})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.tabledit");h||f.data("bjui.tabledit",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS(),this.$tbody=this.$element.find("> tbody"),this.$tbody.length||(this.$tbody=a("<tbody></tbody>"),this.$element.append(this.$tbody)),this.$numAdd=this.$btnAdd=null};b.DEFAULTS={singleNoindex:!0},b.EVENTS={afterDelete:"afterdelete.bjui.tabledit"},b.prototype.TOOLS=function(){var c=this,d={initSuffix:function(b){var c=b.find("> tr");c.each(function(b){var c=a(this);c.find(":input, :file, a, label, div").each(function(){var k,c=a(this),d=c.attr("name"),e=c.val(),f=c.attr("for"),g=c.attr("id"),h=c.attr("href"),i=c.attr("data-group"),j=c.attr("data-suffix");d&&c.attr("name",d.replaceSuffix(b)),f&&c.attr("for",f.replaceSuffix(b)),g&&c.attr("id",g.replaceSuffix(b).replaceSuffix2(b)),h&&c.attr("href",h.replaceSuffix(b)),i&&c.attr("data-group",i.replaceSuffix(b)),j&&c.attr("data-suffix",j.replaceSuffix(b)),e&&e.indexOf("#index#")>=0&&c.val(e.replace("#index#",b+1)),c.hasClass("no")&&(k=c.data("prefix")?c.data("prefix"):"",c.val(k+(b+1)))})})},initEnter:function(b){var c=b.find(":text");c.each(function(b){a(this).bind("keydown",function(a){if(a.which==BJUI.keyCode.ENTER){var d=b+1;c.eq(d)&&c.eq(d).focus(),a.preventDefault()}})}),this.initInput(b)},initInput:function(b){b.find("> tr > td").each(function(){var b=a(this).find(".input-hold");b.length||(b=a('<span class="input-hold" style="display:block; padding:0 4px; height:0px; font-size:12px; visibility:hidden;"></span>'),a(this).append(b)),a.support.leadingWhitespace?a(this).on("input",":text",function(){b.text(a(this).val())}):a(this).on("propertychange",":text",function(){b.text(a(this).val())})})},initTbody:function(){function e(b){b.removeClass("readonly").find("> td *").each(function(){var b=a(this),c=b.closest("td"),d=c.data("val"),e=b.attr("data-toggle-old"),f=c.data("readonly");if("undefined"==typeof d&&(d=c.html()),c.data("notread"))return!0;if(b.isTag("select")&&b.val(c.attr("data-val")).selectpicker("refresh").nextAll(".bootstrap-select").removeClass("readonly").find("button").removeClass("disabled"),b.is(":checkbox")&&(b.closest(".icheckbox_minimal-purple").removeClass("disabled"),b.closest(".icheckbox_minimal-purple").find("ins").removeClass("readonly")),b.is(":radio")&&(b.closest(".iradio_minimal-purple").removeClass("disabled"),b.closest(".iradio_minimal-purple").find("ins").removeClass("readonly")),e){if("dosave"==e)return!0;b.removeAttr("data-toggle-old").attr("data-toggle",e),"spinner"==e&&b.spinner("destroy").spinner(),"kindeditor"==e&&c.initui()}(b.is(":text")||b.is("textarea"))&&(b.off("keydown.readonly"),f&&b.prop("readonly",!0)),b.find(".bjui-lookup, .bjui-spinner, .bjui-upload").show()}),b.find('[data-toggle="doedit"]').attr("data-toggle","dosave").text("完成")}function f(b){b.addClass("readonly").find("> td *").each(function(){var b=a(this),c=b.closest("td"),d=b.attr("data-toggle");if(c.data("notread"))return!0;if(b.isTag("select")&&b.nextAll(".bootstrap-select").addClass("readonly").find("button").addClass("disabled"),b.is(":checkbox")&&(b.closest(".icheckbox_minimal-purple").addClass("disabled"),b.closest(".icheckbox_minimal-purple").find("ins").addClass("readonly")),b.is(":radio")&&(b.closest(".iradio_minimal-purple").addClass("disabled"),b.closest(".iradio_minimal-purple").find("ins").addClass("readonly")),d){if("doedit"==d||"dosave"==d)return!0;b.removeAttr("data-toggle").attr("data-toggle-old",d),"kindeditor"==d&&KindEditor.remove(b)}(b.is(":text")||b.is("textarea"))&&b.on("keydown.readonly",function(a){a.preventDefault()}),b.find(".bjui-lookup, .bjui-spinner, .bjui-upload").hide()}),b.find('[data-toggle="dosave"]').attr("data-toggle","doedit").text("编辑")}var b=c.$element,d=c.$tbody;d.find("> tr").each(function(){var g=a(this),h=g.find("> td"),i=b.data("bjui.tabledit.tr").clone().find("> th");g.data("bjui.tabledit.oldTds",g.html()),i.each(function(b){var c=h.eq(b),d=c.data("val"),e=a(this),f=e.children(),g=e.find(".pic-box");"undefined"==typeof d&&(d=c.html()),c.data("noedit")||f.length&&(f.is("input:checkbox")||f.is("input:radio")?f.filter('[value="'+d+'"]').attr("checked","checked"):f.isTag("select")?f.find('option[value="'+c.data("val")+'"]').attr("selected","selected"):g.length?(c.data("val")&&e.find(".pic-name").val(c.data("val")),g.html(c.html())):f.hasClass("wrap_bjui_btn_box")?f.find("input[data-toggle]").attr("value",d+""):f.is("textarea")?(f.html(d),"kindeditor"==f.attr("data-toggle")&&f.attr("data-toggle-old","kindeditor").removeAttr("data-toggle")):f.attr("value",d+""),c.html(e.html()))}),g.on("dblclick",a.proxy(function(){e(g)},c)).initui(),c.tools.initSuffix(d),f(g)}),d.on("click.bjui.tabledit.readonly",'[data-toggle="doedit"]',function(){e(a(this).closest("tr"))}).on("click.bjui.tabledit.readonly",'[data-toggle="dosave"]',function(){var i,j,e=a(this).closest("tr"),g=e.index(),h=c.options.callback;c.options.action?(e.wrap('<form action="" method="POST"></form>'),e.attr("data-id")&&(i=b.find("> thead > tr:eq(0)").data("idname")||"id",e.before('<input type="hidden" name="'+i.replaceSuffix(g)+'" value="'+e.attr("data-id")+'">')),j=e.parent().serializeArray(),c.options.singleNoindex&&a.each(j,function(b,c){a.extend(c,{name:c.name.replaceSuffix(0)})}),e.prev("input").remove(),e.unwrap().isValid(function(a){a&&(h=h?h.toFunc():function(a){a[BJUI.keys.statusCode]==BJUI.statusCode.ok?f(e):e.bjuiajax("ajaxDone",a)},e.bjuiajax("doAjax",{url:c.options.action,data:j,type:c.options.type||"POST",callback:h}))})):f(e)}),c.tools.initEnter(d)},doAdd:function(){var b=c.$element;c.$numAdd&&c.$btnAdd&&b.on("keydown.bjui.tabledit.add","thead .num-add",function(a){a.which==BJUI.keyCode.ENTER&&(c.$btnAdd.trigger("click.bjui.tabledit.add"),a.preventDefault())}).on("click.bjui.tabledit.add","thead .row-add",function(a){var d=1;isNaN(c.$numAdd.val())||(d=parseInt(c.$numAdd.val())),c.add(b,d),a.preventDefault()})},doDel:function(b){var c=this,d="click.bjui.tabledit.del";b.off(d).on(d,".row-del",function(b){var d=a(this);d.data("confirmMsg")?d.alertmsg("confirm",d.data("confirmMsg"),{okCall:function(){c.delData(d)}}):c.delData(d),b.preventDefault()})},delData:function(a){var b=this,d=a.closest("tbody"),e=a.data(),f=function(f){a.closest("tr").remove(),b.initSuffix(d),b.afterDelete(d),e.callback&&e.callback.toFunc().apply(c,[f])};a.is("[href^=javascript:]")||a.is('[href^="#"]')?f():a.bjuiajax("doAjax",{url:a.attr("href"),data:e.data,callback:f})},afterDelete:function(d){var e=a.Event(b.EVENTS.afterDelete,{relatedTarget:d[0]});c.$element.trigger(e),e.isDefaultPrevented()}};return d},b.prototype.init=function(){var b=this,c=this.tools,d=this.$element.addClass("bjui-tabledit"),e=d.find("> thead > tr:first"),f=this.$tbody,g=d.find("> thead > tr:first").html();e.find("> th").each(function(){var f,c=a(this),d=c.attr("title"),e=c.data("addtool");d&&c.html(d),e&&(f=a('<span style="position:relative;"></span>'),c.empty(),b.$numAdd=a('<input type="text" value="1" class="form-control num-add" size="2" title="待添加的行数">'),b.$btnAdd=a('<a href="javascript:;" class="row-add" title="添加行"><i class="fa fa-plus-square"></i></a>'),f.append(b.$numAdd).append(b.$btnAdd).appendTo(c))}),d.data("bjui.tabledit.tr",a("<tr>"+g+"</tr>")),c.initTbody(),c.doAdd(),c.doDel(f)},b.prototype.add=function(b,c){var f,h,i,j,d=this.tools,e=b.find("> tbody"),g=b.data("bjui.tabledit.tr");for(h=0;c>h;h++)g.find("> th").each(function(){a(this).replaceWith("<td>"+a(this).html()+"</td>")}),i=g.clone(),h||(f=i),i.hide().appendTo(e),d.initSuffix(e),d.initEnter(e),i.show().css("display","").initui();f&&f.length&&(j=f.find(":text"),j.each(function(){var b=a(this);return b.prop("readonly")?void 0:(b.focus(),!1)}))},d=a.fn.tabledit,a.fn.tabledit=c,a.fn.tabledit.Constructor=b,a.fn.tabledit.noConflict=function(){return a.fn.tabledit=d,this},a(document).on(BJUI.eventType.initUI,function(b){var d=a(b.target).find('table[data-toggle="tabledit"]');d.length&&c.call(d)}),a(document).on(BJUI.eventType.afterInitUI,function(b){var d=a(b.target).find('table[data-toggle="tabledit"]');d.each(function(){if(a(this).is("[data-initnum]")){var b=a(this).data("initnum");b>0&&c.call(a(this),"add",a(this),b)}})}),a(document).on("click.bjui.tabledit.data-api",'[data-toggle="tableditadd"]',function(b){var d=a(this),e=d.data("num")||1,f=d.data("target");f&&a(f).length&&a(f).isTag("table")&&(c.call(d,"add",a(f),e),b.preventDefault())})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.spinner");h||f.data("bjui.spinner",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS(),this.$spinner=null,this.height=this.$element.addClass("form-control").innerHeight(),this.ivalue=Number(this.$element.val())||0};b.DEFAULTS={min:0,max:100,step:1,decimalPlace:0},b.EVENTS={afterChange:"afterchange.bjui.spinner"},b.prototype.TOOLS=function(){var a=this,c={changeVal:function(c){var d=a.$element,e=Number(d.val())||Number(a.ivalue),f=c.data("add")||-1,g=a.options.min,h=a.options.max,i=a.options.step;1==f?h-i>=e&&(e+=i):-1==f?e>=g+i&&(e-=i):e>h?e=h:g>e&&(e=g),a.options.decimalPlace&&(e=new String(e.toFixed(a.options.decimalPlace))),a.ivalue=e,d.val(e).trigger(b.EVENTS.afterChange,{value:e})}};return c},b.prototype.init=function(){return this.$element,this.options,isNaN(this.options.min)||isNaN(this.options.max)||isNaN(this.options.step)?(BJUI.debug("Spinner Plugin: Parameter is non-numeric type!"),void 0):(this.addBtn(),void 0)},b.prototype.addBtn=function(){var d,e,b=this,c=b.$element;this.$lookBtn||c.parent().hasClass("wrap_bjui_btn_box")||(this.$spinner=a(FRAG.spinnerBtn),c.css({paddingRight:"13px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),d=c.parent(),d.css("position","relative"),this.$spinner.css({height:this.height}).appendTo(d),this.$spinner.on("selectstart",function(){return!1}),e=null,b.$spinner.find("li").on("click",function(){b.tools.changeVal(a(this))}).on("mousedown",function(){var c=a(this);e=setInterval(function(){b.tools.changeVal(c)},150)}).on("mouseup",function(){clearTimeout(e)}))},b.prototype.destroy=function(){this.$element.parent().hasClass("wrap_bjui_btn_box")&&(this.$element.parent().find(".bjui-spinner").remove(),this.$element.unwrap())},d=a.fn.spinner,a.fn.spinner=c,a.fn.spinner.Constructor=b,a.fn.spinner.noConflict=function(){return a.fn.spinner=d,this},a(document).on(BJUI.eventType.initUI,function(b){var d=a(b.target).find('input[data-toggle="spinner"]');d.length&&c.call(d)})}(jQuery),+function(a){"use strict";function f(b){var c=arguments,d=b;return this.each(function(){var f=a(this),g=a.extend({},e.DEFAULTS,f.data(),"object"==typeof b&&b),h=f.data("bjui.lookup");h?f.data("newurl")&&(h.options.url=f.data("newurl"),f.data("bjui.dialog",null)):f.data("bjui.lookup",h=new e(this,g)),"string"==typeof d&&a.isFunction(h[d])?([].shift.apply(c),c?h[d].apply(h,c):h[d]()):h.init()})}var b,c,d,g,e=function(b,c){this.$element=a(b),this.options=c,this.$lookBtn=null};e.DEFAULTS={url:null,id:null,mask:!0,width:600,height:400,title:"Lookup",maxable:!0,resizable:!0},e.EVENTS={afterChange:"afterchange.bjui.lookup"},e.prototype.init=function(){var a=this,e=this.options;return this.tools,e.url?(e.url=decodeURI(e.url).replacePlh(a.$element.closest(".unitBox")),e.url.isFinishedTm()?(e.url=encodeURI(e.url),b=this.options.group||null,c=this.options.suffix||null,d=this.$element,c&&(c=c.trim()),this.open(a.$element),void 0):(a.$element.alertmsg("error",e.warn||BJUI.regional.plhmsg),BJUI.debug("Lookup Plugin: The lookup's url is incorrect, url:"+e.url),!1)):(BJUI.debug("Lookup Plugin: Error trying open a lookup dialog, url is undefined!"),!1)},e.prototype.addBtn=function(){var d,e,b=this,c=b.$element;this.$lookBtn||c.parent().hasClass("wrap_bjui_btn_box")||(this.$lookBtn=a(FRAG.lookupBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),d=this.$element.parent(),e=this.$element.addClass("form-control").innerHeight(),d.css({position:"relative",display:"inline-block"}),a.each(b.options,function(a,c){"toggle"!=a&&b.$lookBtn.data(a,c)}),this.$lookBtn.css({height:e,lineHeight:e+"px"}).appendTo(d),this.$lookBtn.on("selectstart",function(){return!1}))},e.prototype.open=function(a){var c=this.options;a.dialog({id:c.id||"lookup_dialog",url:c.url,title:c.title,width:c.width,height:c.height,mask:c.mask,maxable:c.maxable,resizable:c.resizable})},e.prototype.getField=function(a){return(b?b+".":"")+a+(c?c:"")},e.prototype.setSingle=function(a,b){"string"==typeof a&&(a=new Function("return "+a)()),this.setVal(a,b)},e.prototype.setMult=function(b,c){var d={},e=this.$element.closest(".unitBox");return e.find('[name="'+b+'"]').filter(":checked").each(function(){var c,e,b=new Function("return "+a(this).val())();for(c in b)e=d[c]?d[c]+",":"",d[c]=e+b[c]}),a.isEmptyObject(d)?(this.$element.alertmsg("error",this.$element.data("warn")||BJUI.regional.selectmsg),void 0):(this.setVal(d,c),void 0)},e.prototype.setVal=function(b,c){var h,f=this,g=d.closest(".unitBox");d.data("customEvent")?d.trigger("customEvent.bjui.lookup",[b]):g.find(":input").each(function(){var i,j,d=a(this),g=d.attr("name");for(i in b)if(j=f.getField(i),j==g){h=1==c?d.val()?d.val()+","+b[i]:b[i]:b[i],d.val(h).trigger(e.EVENTS.afterChange,{value:b[i]});break}}),this.$element.dialog("closeCurrent")},g=a.fn.lookup,a.fn.lookup=f,a.fn.lookup.Constructor=e,a.fn.lookup.noConflict=function(){return a.fn.lookup=g,this},a(document).on(BJUI.eventType.initUI,function(b){var c=a(b.target).find('[data-toggle="lookup"]');c.length&&f.call(c,"addBtn")}),a(document).on("click.bjui.lookup.data-api",'[data-toggle="lookupbtn"]',function(b){var c=a(this);c.attr("href")&&!c.data("url")&&c.attr("data-url",c.attr("href")),c.data("title")||c.attr("data-title",c.text()),f.call(c),b.preventDefault()}),a(document).on("click.bjui.lookupback.data-api",'[data-toggle="lookupback"]',function(b){var c=a(this),d=c.data("args"),e=c.data("lookupid"),g=a('input[name="lookupType"]:checked').val();d?f.call(c,"setSingle",d,g):e&&f.call(c,"setMult",e,g),b.preventDefault()})}(jQuery),+function(a){"use strict";function m(b){var c=arguments,d=b;return this.each(function(){var g,f=(a(this),{});a.extend(!0,f,l.DEFAULTS,"object"==typeof b&&b),g=new l(this,f),"string"==typeof d&&a.isFunction(g[d])?([].shift.apply(c),c?g[d].apply(g,c):g[d]()):g.init()})}var b,c,d,e,f,g,h,i,j,k,n,l=function(b,c){this.$element=a(b),this.options=c,this.$findBtn=null};l.DEFAULTS={pk:null,oldData:null,group:null,suffix:null,include:null,exclude:null,multiple:!1,append:!1,empty:!0,dialogOptions:{id:null,mask:!0,width:600,height:400,title:"FindGrid",maxable:!0,resizable:!0},gridOptions:{width:"100%",height:"100%",columnMenu:!1,sortAll:!0,filterAll:!0,fullGrid:!0},context:null,onSelect:null},l.EVENTS={afterChange:"afterchange.bjui.findgrid"},l.getField=function(a){return(b?b+".":"")+a+(c?c:"")},l.empty=function(){var a,b,c,d,f,h,i,g;if(!e)return BJUI.debug("FindGrid Plugin: No set options 'include' !"),void 0;for(a=this,b=e.split(","),c=j.find(":text, :input:hidden, textarea, select"),d={},f=0;f<b.length;f++)g=b[f].split(":"),2==g.length?(i=g[0].trim(),h=g[1].trim()):(i=b[f].trim(),h=i),d[a.getField(i)]=!0;for(h in d)c.filter('[name="'+h+'"]').val("").trigger(l.EVENTS.afterChange,{value:"",data:""})},l.setSingle=function(b){var c=this,d=function(a,d,e){var f=c.getField(d);f==a.attr("name")&&(a.val(e).trigger(l.EVENTS.afterChange,{value:e,data:b}),a.isTag("select")&&a.data("toggle")&&"selectpicker"===a.data("toggle")&&a.selectpicker("refresh"))};j.find("input:text, input:hidden, textarea, select").each(function(){var g,i,j,l,k,c=a(this),h=[];if(e)for(i=e.split(","),j=0;j<i.length;j++)k=i[j].split(":"),2==k.length?(g=k[0].trim(),l=k[1].trim()):(g=i[j].trim(),l=g),"undefined"!=typeof b[l]&&d(c,g,b[l]);else for(l in b)f&&(a.each(f.split(","),function(a,b){h.push(b.trim())}),-1!=a.inArray(l,h))||d(c,l,b[l])})},l.setMult=function(b){var n,p,c,m,q,s,w,r,t,u,v,x,y,A,z,C;if("function"==typeof i)return i.call(c,n.data),void 0;if(c=this,m=a("#"+b).data("selectedDatas"),q=function(a){a.isTag("select")&&a.data("toggle")&&"selectpicker"===a.data("toggle")&&a.selectpicker("refresh")},m&&m.length){if(r=j.find("input:text, input:hidden, textarea, select"),t={},u={},v=[],!g&&h&&(h=[]),e)for(x=e.split(","),y=0;y<x.length;y++)z=x[y].split(":"),2==z.length?(s=z[0].trim(),A=z[1].trim()):(s=x[y].trim(),A=s),t[c.getField(s)]=A;else for(A in m[0])f?(a.each(f.split(","),function(a,b){v.push(b.trim())}),-1===a.inArray(A,v)&&(t[c.getField(A)]=A)):t[c.getField(A)]=A;for(r=a(a.map(r,function(b){var c=a(b),d=c.attr("name");return d?t[d]?(u[d]=t[d],b):null:null})),C=0;C<m.length;C++)n=m[C],h&&-1!=a.inArray(n[d],h)||r.each(function(b){var c=a(this),e=c.attr("name"),f=c.val();p||(p=new Array),p[b]||(p[b]=[]),g?f&&(p[b].push(f),c.isTag("select")&&c.prop("multiple")&&(p[b]="array"===a.type(f)?f:[])):(c.val(""),q(c)),p[b].push(n[u[e]]),h&&-1===a.inArray(n[d],h)&&h.push(n[d])});p&&r.each(function(b){var c=a(this);w=p[b].join(","),c.isTag("select")&&c.prop("multiple")&&(w=p[b]),c.val(w).trigger(l.EVENTS.afterChange,{value:w,data:m}),k.data("oldData",h),q(c)}),BJUI.dialog("closeCurrent")}},l.prototype.init=function(){var g=this,i=this.options;i.gridOptions,this.tools,b=i.group||null,c=i.suffix||null,k=g.$element,h=i.oldData,d=i.pk||null,e=i.include||null,f=i.exclude||null,i.context&&(j=i.context instanceof jQuery?i.context:a(i.context)),j&&j.length||(j=g.$element.closest(".unitBox")),c&&(c=c.trim()),d?k.data("oldData")?h=k.data("oldData"):"undefined"!=typeof h?"string"==typeof h?h=h.split(","):a.isArray(h)||(h=[]):h=[]:h=null,this.open(g.$element)},l.prototype.addBtn=function(){var e,f,b=this,c=b.$element,d=c.data("bjui.findgrid.options");this.$findBtn||c.parent().hasClass("wrap_bjui_btn_box")||(this.$findBtn=a(FRAG.findgridBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),e=this.$element.parent(),f=this.$element.addClass("form-control").innerHeight(),e.css({position:"relative",display:"inline-block"}),delete d.toggle,b.$findBtn.data("bjui.findgrid.options",d),this.$findBtn.css({height:f,lineHeight:f+"px"}).appendTo(e),this.$findBtn.on("selectstart",function(){return!1}))},l.prototype.open=function(){var c=this,e=this.options,f=e.dialogOptions,j=e.gridOptions,k=(new Date).getTime();f.id||(f.id="dialog_findgrid_"+k),e.gridId||(e.gridId="datagrid_findgrid_"+k),j.showToolbar=!0,e.empty&&(j.toolbarCustom||(j.toolbarCustom="")),e.multiple&&("undefined"==typeof j.showCheckboxcol&&(j.showCheckboxcol=!0),j.toolbarCustom||(j.toolbarCustom=""),j.selectMult=!0,j.toolbarCustom+='　<button type="button" class="btn-blue" onclick="$.fn.findgrid.Constructor.setMult(\''+e.gridId+"')\">"+BJUI.getRegional("findgrid.choose")+"</button>",j.toolbarCustom+='　<label class="ilabel"><input type="checkbox" data-toggle="icheck" id="checkbox_findgrid_'+k+'" '+(e.append?"checked":"")+">&nbsp;"+BJUI.getRegional("findgrid.append")+"</label>",e.append&&(g=!0)),e.empty&&(j.toolbarCustom+='　<button type="button" class="btn-orange" onclick="$.fn.findgrid.Constructor.empty(\''+e.gridId+"')\">"+BJUI.getRegional("findgrid.empty")+"</button>"),delete f.url,delete f.target,e.onSelect?(i=e.onSelect,"string"==typeof i&&(i=i.toFunc())):i=null,f.html='<div class="bjui-pageContent tableContent"><table id="'+e.gridId+'"></table></div>',f.onLoad=function(){var f="#"+e.gridId,m=a(f);
    m.datagrid(j),a.isArray(h)&&h.length&&d&&a(document).on("afterLoad.bjui.datagrid",f,function(b,c){c.datas&&a.each(c.datas,function(b,c){c[d]&&"-1"!=a.inArray(c[d],h)&&m.datagrid("selectedRows",b,!0)})}),e.multiple||a(document).on("clicked.bjui.datagrid.tr",f,function(a,b){"function"==typeof i?i.call(c,b.data):(l.setSingle(b.data),BJUI.dialog("closeCurrent"))}),a(document).on("ifChanged","#checkbox_findgrid_"+k,function(){g=a(this).is(":checked")})},BJUI.dialog(f)},n=a.fn.findgrid,a.fn.findgrid=m,a.fn.findgrid.Constructor=l,a.fn.findgrid.noConflict=function(){return a.fn.findgrid=n,this},a(document).on(BJUI.eventType.initUI,function(b){a(b.target).find('input[data-toggle="findgrid"]').each(function(){var b=a(this),c=b.data(),d=c.options;d&&("string"==typeof d&&(d=d.trim().startsWith("{")?d.toObj():d.toFunc()),"function"==typeof d&&(d=d.apply()),"object"==typeof d&&(delete c.options,a.extend(c,d))),b.data("bjui.findgrid.options",c),m.call(b,"addBtn")})}),a(document).on("click.bjui.findgrid.data-api",'[data-toggle="findgridbtn"]',function(b){var e,f,c=a(this),d=c.data("bjui.findgrid.options");d||(e=c.data(),f=e.options,f&&("string"==typeof f&&(f=f.trim().startsWith("{")?f.toObj():f.toFunc()),"function"==typeof f&&(f=f.apply()),"object"==typeof f&&(delete e.options,a.extend(e,f))),d=e),delete d["bjui.findgrid.options"],m.call(c,d),b.preventDefault()})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.tags");h||f.data("bjui.tags",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,b=function(b,c){this.$element=a(b).addClass("tag-input"),this.options=c,this.tools=this.TOOLS(),this.$box=a(this.$element.wrap('<div class="bjui-tags"></div>')).parent(),this.timeout=null,this.$tagsArr={},this.tags=[]};b.DEFAULTS={width:300,url:"",global:!1,type:"GET",tagname:"tag",max:0,clear:!1,lightCls:"tags-highlight"},b.EVENTS={afterCreated:"aftercreated.bjui.tags"},b.prototype.TOOLS=function(){var c=this,d=this.options,e={keyDown:function(a){return 13==a.which?!1:void 0},keyUp:function(b){var e,f,g,h,i,j,k,l,m,n;switch(b.which){case BJUI.keyCode.BACKSPACE:if(!a.trim(c.$element.val()).length)return c.tools.removeMenu(),!1;break;case BJUI.keyCode.ESC:c.tools.removeMenu();break;case BJUI.keyCode.DOWN:if(!c.$menu||!c.$menu.length)return;return e=c.$menu.find("> ."+d.lightCls),f=c.$menu.find("> li:first-child"),e.length?(g=e.removeClass(d.lightCls).next(),g.length?g.addClass(d.lightCls):f.addClass(d.lightCls)):f.addClass(d.lightCls),!1;case BJUI.keyCode.UP:if(!c.$menu||!c.$menu.length)return;return e=c.$menu.find("> ."+d.lightCls),h=c.$menu.find("> li:last-child"),e.length?(i=e.removeClass(d.lightCls).prev(),i.length?i.addClass(d.lightCls):h.addClass(d.lightCls)):h.addClass(d.lightCls),!1;case BJUI.keyCode.ENTER:if(d.max>0&&c.$tagsArr.length>=d.max)return!1;if(j=!1,k=!1,l=null,m=c.$menu&&c.$menu.find("> ."+d.lightCls),m&&m.length)j=m.text(),l=m.data("item"),k=l.value;else{if(j=a.trim(c.$element.val()),!j.length)return!1;if(d.clear&&-1==a.inArray(j,c.tags))return c.$element.val(""),!1;k=j}if(!j)return;return n=!1,c.$tagsArr.length&&c.$tagsArr.each(function(){return a(this).val()==k?(n=!0,void 0):void 0}),n?(c.$element.val(""),!1):(c.tools.createTag(j,k),c.tools.removeMenu(),c.$element.val(""),a.proxy(c.tools.onAfterCreated(l,k),c),!1)}},query:function(){c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout(c.tools.doQuery,300)},doQuery:function(){var b,e,f,g,h;d.max>0&&c.$tagsArr.length>=d.max||(b=c.$element.val(),e=c.$box.find("> .tags-menu"),f=[],g=null,h=c.$element.closest(".navtab-panel").length?a.CurrentNavtab:a.CurrentDialog,c.$element.closest(".bjui-layout").length&&(h=c.$element.closest(".bjui-layout")),b.length&&(c.$element.one("ajaxStart",function(){h.trigger("bjui.ajaxStart")}).one("ajaxStop",function(){h.trigger("bjui.ajaxStop")}),a.ajax({url:d.url,global:d.global,type:d.type,data:{term:b},dataType:"json",success:function(b){if(0!=b.length){e.length||(e=a('<ul class="tags-menu"></ul>')),e.empty().hide().appendTo(c.$box);for(var h=0;h<b.length;h++)g=a('<li class="tags-item">'+b[h].label+"</li>").data("item",b[h]),g.appendTo(e),f.push(b[h].label);c.tags=f,e.css({top:c.$element.position().top+c.$element.outerHeight(),left:c.$element.position().left}).fadeIn().find("> li").hover(function(){a(this).addClass(d.lightCls).siblings().removeClass(d.lightCls)},function(){a(this).removeClass(d.lightCls)}).click(function(){var b=a(this).text(),d=a(this).data("item"),f=d.value,g=!1;return c.$box.find("input:hidden").each(function(){return a(this).val()==f?(g=!0,void 0):void 0}),g?(c.$element.val(""),e.remove(),void 0):(a.proxy(c.tools.createTag(b,f),c),e.remove(),c.$element.val(""),a.proxy(c.tools.onAfterCreated(d,f),c),void 0)}),c.$menu=e}}})))},createTag:function(b,d){var f,e=a('<span class="label label-tag" data-value="'+d+'" style="margin-left: 1px; margin-top: 1px;"><i class="fa fa-tag"></i> '+b+'&nbsp;&nbsp;<a href="#" class="close">&times;</a></span>');e.insertBefore(c.$element).find("a.close").click(function(){var b=e.data("value");c.$box.find("input:hidden").each(function(){a(this).val()==b&&a(this).remove()}),e.remove(),c.$tagsArr=c.$box.find('input[name="'+c.options.tagname+'"]')}),f=a('<input type="hidden" name="'+c.options.tagname+'">').val(d),f.appendTo(c.$box),c.$tagsArr=c.$box.find('input[name="'+c.options.tagname+'"]')},removeMenu:function(){c.$menu&&c.$menu.remove()},onAfterCreated:function(d,e){var f=[];c.$tagsArr.length&&c.$tagsArr.each(function(){f.push(a(this).val())}),c.$element.trigger(b.EVENTS.afterCreated,{item:d,value:e,tags:f.join(",")})}};return e},b.prototype.init=function(){var b=this,c=this.$element,d=this.options;return d.url?(d.url=decodeURI(d.url).replacePlh(c.closest(".unitBox")),d.url.isFinishedTm()?(d.url=encodeURI(d.url),isNaN(this.options.max)?(BJUI.debug("Tags Plugin: Parameter 'max' is non-numeric type!"),void 0):(b.$box.width(d.width).on("click",function(){c.focus()}),c.on("keydown",a.proxy(this.tools.keyDown,this)).on("keyup",a.proxy(this.tools.keyUp,this)),a.support.leadingWhitespace?c.on("input",a.proxy(this.tools.query,this)):c.on("propertychange",a.proxy(this.tools.query,this)),a(document).on("click.bjui.tags",a.proxy(function(b){a(b.target).closest(this.$box).length||this.tools.removeMenu()},this)),void 0)):(c.alertmsg("error",d.warn||BJUI.regional.plhmsg),BJUI.debug("Tags Plugin: The query tags url is incorrect, url: "+d.url),void 0)):(BJUI.debug("Tags Plugin: Do query tags, url is undefined!"),void 0)},b.prototype.destroy=function(){this.$tags&&(this.$element.upwrap(),$tags.remove())},d=a.fn.tags,a.fn.tags=c,a.fn.tags.Constructor=b,a.fn.tags.noConflict=function(){return a.fn.tags=d,this},a(document).on(BJUI.eventType.initUI,function(b){var d=a(b.target).find('input[data-toggle="tags"]');d.length&&c.call(d)})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return window.FileReader?this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.upload");h||f.data("bjui.upload",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()}):(this.each(function(){var b,c,d,e,f;if(a.fn.uploadify){if(b={swf:BJUI.PLUGINPATH+"uploadify/scripts/uploadify.swf",fileTypeExts:"*.jpg;*.png",id:"fileInput",fileObjName:"file",fileSizeLimit:204800,buttonText:"选择上传文件",auto:!1,multi:!1,height:24},c=a(this),d=c.data(),d.id||(d.id=c.attr("id")),a.extend(b,d),!b.uploader)return BJUI.debug("Upload Plugin: The options uploader is undefined!"),void 0;if(b.uploader=decodeURI(b.uploader).replacePlh(c.closest(".unitBox")),!b.uploader.isFinishedTm())return c.alertmsg("error",b.warn||BJUI.regional.plhmsg),BJUI.debug("Upload Plugin: The options uploader is incorrect: "+b.uploader),void 0;b.uploader=encodeURI(b.uploader),"fileInput"==b.id&&(b.id=b.id+(new Date).getTime()),e=a('<input type="file" name="'+b.name+'" id="'+b.id+'">'),b.onInit&&"string"==typeof b.onInit&&(b.onInit=b.onInit.toFunc()),b.onCancel&&"string"==typeof b.onCancel&&(b.onCancel=b.onCancel.toFunc()),b.onSelect&&"string"==typeof b.onSelect&&(b.onSelect=b.onSelect.toFunc()),b.onUploadSuccess&&"string"==typeof b.onUploadSuccess&&(b.onUploadSuccess=b.onUploadSuccess.toFunc()),b.onUploadComplete&&"string"==typeof b.onUploadComplete&&(b.onUploadComplete=b.onUploadComplete.toFunc()),b.onUploadError&&"string"==typeof b.onUploadError&&(b.onUploadError=b.onUploadError.toFunc()),e.appendTo(c),b.auto||(f=a('<button class="btn btn-orange" data-icon="cloud-upload">开始上传</button>'),f.hide().insertAfter(c).click(function(){e.uploadify("upload","*"),a(this).hide()}),b.onSelect=function(){f.show()}),e.uploadify(b)}}),void 0)}var d,b=function(b,c){this.$element=a(b),this.options=c,this.tools=this.TOOLS()};b.DEFAULTS={fileTypeExts:"*.jpg;*.png",uploader:"",auto:!1,method:"POST",multi:!1,formData:{},fileObjName:"file",fileSizeLimit:204800,previewImg:!0,previewLoadimg:null,dragDrop:!1,showUploadedPercent:!0,showUploadedSize:!0,buttonText:"选择上传文件",removeTimeout:1e3,itemTemplate:FRAG.uploadTemp,breakPoints:!1,fileSplitSize:1048576,onUploadStart:null,onUploadSuccess:null,onUploadComplete:null,onUploadError:null,onInit:null,onCancel:null,onSelect:null},b.MIMETYPES={zip:["application/x-zip-compressed"],jpg:["image/jpeg"],png:["image/png"],gif:["image/gif"],swf:["application/x-shockwave-flash"],doc:["application/msword"],xls:["application/vnd.ms-excel"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["application/vnd.ms-powerpoint"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.presentation"],mp3:["audio/mpeg"],mp4:["video/mp4"],pdf:["application/pdf"],txt:["text/plain"],xml:["text/xml"]},b.prototype.TOOLS=function(){var c=this,d=this.options,e={formatFileSize:function(a,b){return a=a>1048576&&!b?(Math.round(100*a/1048576)/100).toString()+"MB":(Math.round(100*a/1024)/100).toString()+"KB"},getFile:function(a,b){for(var c=0;c<b.length;c++)if(b[c].index==a)return b[c];return!1},getFileTypes:function(a){var d,b=[],c=a.split(";");for(d=0;d<c.length;d++)b.push(c[d].split(".").pop());return b},getMimetype:function(a){return b.MIMETYPES[a]},getAcceptString:function(a){var d,e,b=this.getFileTypes(a),c=[];for(d=0;d<b.length;d++)e=this.getMimetype(b[d]),e?c.push(e):c.push("."+b[d]);return c.join(",")},filter:function(b){var g,h,e=[],f=this.getFileTypes(d.fileTypeExts);if(f.length>0)for(g=0;g<b.length;g++)h=b[g],parseInt(this.formatFileSize(h.size,!0))>d.fileSizeLimit?c.$element.alertmsg("error",'文件"'+h.name+'"大小超出限制！'):a.inArray(h.name.split(".").pop().toLowerCase(),f)>=0?e.push(h):c.$element.alertmsg("error",'文件"'+h.name+'"类型不允许！');return e},getFiles:function(a){var d,b=a.target.files||a.dataTransfer.files;for(b=this.filter(b),d=0;d<b.length;d++)b[d].id=b[d].lastModifiedDate.getTime()+"_"+b[d].size+"_"+(b[d].type||"").replace(/\W/g,""),this.renderQueueItem(b[d]),c.queueData.files++;return b},renderQueueItem:function(b){var g,h,e=0,f=a(d.itemTemplate.replace("{fileId}",b.id).replace("{fileName}",b.name).replace("#upConfirm#",BJUI.regional.upload.upConfirm).replace("#upPause#",BJUI.regional.upload.upPause).replace("#upCancel#",BJUI.regional.upload.upCancel).replace("{percent}","0.00%").replace("{uploadedSize}","0KB").replace("{fileSize}",this.formatFileSize(b.size)));d.auto&&f.find("> .info > .up_confirm").remove(),f.data("upfile",b),c.$uploadFileList.append(f),d.breakPoints&&(e=this.getUploadedSize(b.id),e>b.size&&(e=b.size)),this.showProgress(b.id,e,b.size),d.previewImg&&-1!=b.type.indexOf("image")?(g=f.find("> .preview > .img"),d.previewLoadimg&&g.html('<img src="'+d.previewLoadimg+'" height="114">'),this.previewImg(b,g)):f.find("> .preview").remove(),d.showUploadedSize?(h=f.find("> .filesize"),h.find("> .uploadedsize").html(this.formatFileSize(e)),h.find("> .filesize").html(this.formatFileSize(b.size))):f.find("> .filesize").remove(),d.showUploadedPercent?f.find("> .percent").html((100*(e/b.size)).toFixed(2)+"%"):f.find("> .percent").remove(),d.onSelect&&d.onSelect(files),d.auto&&c.fileUpload(b,e),f.on("click.bjui.upload.confirm",".up_confirm",function(){var d=a(this),f=d.closest(".item");d.hide().next().show(),c.fileUpload(f.data("upfile"),e)}),f.on("click.bjui.upload.cancel",".up_cancel",this.removeQueueItem)},successQueueItem:function(b,f){e.showProgress(b.id,b.size,b.size),d.onUploadSuccess&&d.onUploadSuccess.toFunc().call(c,b,f.responseText,c.$element),setTimeout(function(){c.$element.find("#"+b.id).fadeOut("normal",function(){a(this).remove();var b=c.$element.find("> .queue > .item:visible").length;b||(c.$element.find("> .queue").hide(),c.$file.val(""))})},d.removeTimeout)},removeQueueItem:function(b,d){d&&d.abort(),a(this).closest(".item").fadeOut("normal",function(){a(this).remove();var b=c.$element.find("> .queue > .item:visible").length;b||c.$element.find("> .queue").hide()}),b.preventDefault()},previewImg:function(a,b){if(a&&b.length){var c=new FileReader;c.onload=function(a){b.html('<img src="'+a.target.result+'">')},c.readAsDataURL(a)}},showProgress:function(a,b,d){var e=100*(b/d)+"%";c.tools.formatFileSize(b),(100*(b/d)).toFixed(2)+"%",c.$element.find("#"+a+" > .progress > .bar").css("width",e)},getUploadedSize:function(a){return 1*localStorage.getItem(a)},saveUploadedSize:function(a,b){localStorage.setItem(a,b)},sendBlob:function(a,b,c,e){var g,f=new FormData;if(b.open(d.method,a,!0),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.append(d.fileObjName,c),e)for(g in e)f.append(g,e[g]);b.send(f)}};return e},b.prototype.init=function(){var e,b=this,c=this.$element,d=this.options;return d.uploader?(d.uploader=decodeURI(d.uploader).replacePlh(c.closest(".unitBox")),d.uploader.isFinishedTm()?(d.uploader=encodeURI(d.uploader),c.hasClass("bjui-upload")||(d.formData&&"string"==typeof d.formData&&(d.formData=d.formData.toObj()),e=a(FRAG.uploadFrag.replaceAll("#multi#",d.multi?"multiple":"").replaceAll("#accept#",b.tools.getAcceptString(d.fileTypeExts)).replaceAll("#btnTxt#",(d.icon?'<i class="fa fa-'+d.icon+'">&nbsp;&nbsp;':"")+d.buttonText)),c.addClass("bjui-upload").append(e),this.$file=c.find("> .bjui-upload-select-file"),this.$uploadFileList=c.find("> .queue"),this.queueData={files:0,success:0,error:0},c.on("change.bjui.upload",".bjui-upload-select-file",function(a){b.fileSelect(a)}).on("click.bjui.upload",".bjui-upload-select",function(){b.$file.trigger("click")}),d.onInit&&d.onInit(),d.dragDrop&&(c[0].ondragover=function(a){return a.preventDefault(),!0},c[0].ondrop=function(a){b.fileSelect(a),a.stopPropagation(),a.preventDefault()})),void 0):(c.alertmsg("error",d.warn||BJUI.regional.plhmsg),BJUI.debug("Upload Plugin: The options uploader is incorrect: "+d.uploader),void 0)):(BJUI.debug("Upload Plugin: The options uploader is undefined!"),void 0)},b.prototype.fileSelect=function(a){this.$uploadFileList.show(),this.tools.getFiles(a)},b.prototype.fileUpload=function(b,c){var d=this,e=d.$element,f=d.options,g=d.tools,h=!1,i=b;h=new XMLHttpRequest,f.breakPoints&&(b=i.slice(c,c+f.fileSplitSize)),h.upload&&(h.upload.onprogress=function(a){d.onProgress(b,a.loaded,i.size)},h.onreadystatechange=function(){if(4==h.readyState&&200==h.status){var j=(JSON.parse(h.responseText),!1);f.breakPoints?(c+=f.fileSplitSize,g.saveUploadedSize(i.id,c),c<i.size?(b=i.slice(c,c+f.fileSplitSize),g.sendBlob(f.uploader,h,b,f.formData)):j=!0):j=!0,j&&(d.queueData.success++,g.successQueueItem(i,h),f.onUploadComplete&&f.onUploadComplete(i,h.responseText))}else d.queueData.error++,f.onUploadError&&f.onUploadError(i,h.responseText);f.onQueueComplete&&(d.queueData.files=d.queueData.success+d.queueData.error)&&option.onQueueComplete(d.queueData)},f.onUploadStart&&f.onUploadStart(),f.formData.fileName=i.name,f.formData.lastModifiedDate=i.lastModifiedDate.getTime(),g.sendBlob(f.uploader,h,b,f.formData)),e.find("#"+i.id+" > .info > .up_pause").on("click.bjui.upload.pause",function(){h.abort(),a(this).hide().prev().show()}),e.find("#"+i.id+" > .info > .up_cancel").off("click.bjui.upload.cancel").on("click.bjui.upload.cancel",a.proxy(function(a){this.tools.removeQueueItem(a,h)},this))},b.prototype.onProgress=function(a,b,c){var i,j,k,l,d=this,e=d.options,f=d.$element.find("#"+a.id+" .progress"),g=b,h=f.attr("lastLoaded")||0;b-=parseInt(h),b>a.size&&(b=a.size),d.$progressBar=f.children(".bar"),i=e.breakPoints?parseFloat(d.$progressBar.get(0).style.width||0):0,j=(100*(b/c)+i).toFixed(2),k=j>100?"100%":j+"%",e.showUploadedSize&&(l=f.nextAll(".filesize"),l.find("> .uploadedsize").text(d.tools.formatFileSize(b))),e.showUploadedPercent&&f.nextAll(".up_percent").text(k),d.$progressBar.css("width",k),g<e.fileSplitSize?f.attr("lastLoaded",g):f.removeAttr("lastLoaded")},b.prototype.destroy=function(){},d=a.fn.upload,a.fn.upload=c,a.fn.upload.Constructor=b,a.fn.upload.noConflict=function(){return a.fn.upload=d,this},a(document).on(BJUI.eventType.initUI,function(b){var d=a(b.target).find('[data-toggle="upload"]');d.length&&c.call(d)})}(jQuery),+function(a){"use strict";function e(b){var c=arguments,e=b;return this.each(function(){var f=a(this),g=a.extend({},d.DEFAULTS,f.data(),"object"==typeof b&&b),h=f.data("bjui.theme");h||f.data("bjui.theme",h=new d(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(c),c?h[e].apply(h,c):h[e]()):h.init()})}var b,c,d,f;a(function(){var d=function(){var d,e;b=a("#bjui-link-theme"),c=a("#bjui-themes"),a.cookie&&(d=a.cookie("bjui_theme")||"blue",e=c.find("a.theme_"+d),e.theme({}))};d()}),d=function(b,c){this.$element=a(b),this.options=c},d.DEFAULTS={theme:"purple"},d.prototype.init=function(){var a,d,e;b.length&&(a=b.attr("href"),a=a.substring(0,a.lastIndexOf("/")),a=a.substring(0,a.lastIndexOf("/")),a+="/"+this.options.theme+"/core.css",b.attr("href",a),d=this.$element.closest("ul").prev(),e=d.attr("class"),e=e.replace(/(theme[\s][a-z]*)/g,""),d.removeClass().addClass(e).addClass("theme").addClass(this.options.theme),c.find("li").removeClass("active"),this.$element.parent().addClass("active"),this.cookie())},d.prototype.setTheme=function(a){c.find("a.theme_"+a).trigger("click")},d.prototype.cookie=function(){var b=this.options.theme;a.cookie&&a.cookie("bjui_theme",b,{path:"/",expires:30})},f=a.fn.theme,a.fn.theme=e,a.fn.theme.Constructor=d,a.fn.theme.noConflict=function(){return a.fn.theme=f,this},a(document).on("click.bjui.theme.data-api",'[data-toggle="theme"]',function(b){e.call(a(this)),b.preventDefault()})}(jQuery),+function(a){"use strict";function c(c){var d=arguments,e=c;return this.each(function(){var f=a(this),g=a.extend({},b.DEFAULTS,f.data(),"object"==typeof c&&c),h=f.data("bjui.initui");h||f.data("bjui.initui",h=new b(this,g)),"string"==typeof e&&a.isFunction(h[e])?([].shift.apply(d),d?h[e].apply(h,d):h[e]()):h.init()})}var d,e,f,b=function(b,c){this.$element=a(b),this.options=c};b.DEFAULTS={},b.prototype.init=function(){var b=this,c=b.$element;a.when(b.initUI()).done(function(){c.trigger(BJUI.eventType.afterInitUI)})},b.prototype.initUI=function(){var b=this.$element;a.when(b.trigger(BJUI.eventType.beforeInitUI)).done(function(){b.trigger(BJUI.eventType.initUI)})},d=a.fn.initui,a.fn.initui=c,a.fn.initui.Constructor=b,a.fn.initui.noConflict=function(){return a.fn.initui=d,this},a(document).on("click.bjui.initui.data-api",'[data-toggle="initui"]',function(a){c.call($this,$this.data()),a.preventDefault()}),a(document).on(BJUI.eventType.beforeInitUI,function(b){var c=a(b.target),d=[],e=c.find("[data-noinit]");c.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"85%"},"fast"),e.each(function(){var c=a(this),e={};e.$target=c,e.$next=c.next(),e.$prev=c.prev(),e.$parent=c.parent(),e.visible=c.is(":visible")?!0:!1,d.push(e),c.remove()}),c.data("bjui.noinit",d)}),a(document).on(BJUI.eventType.initUI,function(b){var c=a(b.target);c.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"95%"},"fast")}),a(document).on(BJUI.eventType.afterInitUI,function(b){var c=a(b.target),d=c.data("bjui.noinit"),e=c.find("> .bjui-pageContent").find("form");d&&a.each(d,function(a,b){b.$next.length?b.$next.before(b.$target):b.$prev.length?b.$prev.after(b.$target):b.$parent.length&&b.$parent.append(b.$target),b.visible&&b.$target.show(),c.removeData("bjui.noinit")}),c.resizePageH(),e.length&&c.find("> .bjui-pageFooter").find(":submit").on("click.bjui.submit",function(a){a.preventDefault(),e.submit()}),c.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){c.find("> .bjui-ajax-mask").fadeOut("normal",function(){a(this).remove()})})}),a(document).one(BJUI.eventType.afterInitUI,function(){var c=a("#bjui-hnav-navbar"),d=c.find("> li.active");d.length&&d.find("> .items").length&&d.find("> a").trigger("click")}),e=function(b){var f,g,h,c=b,d=c,e=c.css("position");return"static"==e&&(d=c.offsetParent()),f=parseInt(d.css("zIndex"))||0,g=c.find("> .bjui-maskBackground"),h=c.find("> .bjui-maskProgress"),g.length||(g=a(FRAG.maskBackground),h=a(BJUI.doRegional(FRAG.maskProgress,BJUI.regional)),c.prepend(g).prepend(h)),parseInt(g.css("zIndex"))||0,parseInt(h.css("zIndex"))||0,g.css("zIndex",f+1),h.css("zIndex",f+2),{$bg:g,$pr:h}},a(document).on("bjui.ajaxStart",function(b,c,d){var f=e(a(b.target));f.$bg.fadeIn(),f.$pr.fadeIn(),f.$pr.find(".progress").animate({width:"80%"},c||500),d&&setTimeout(function(){d.toFunc().call(this)},25)}).on("bjui.ajaxStop",function(b){var c=e(a(b.target));c.$pr.find(".progress").animate({width:"100%"},"fast",function(){c.$bg.remove(),c.$pr.remove()})}).on("bjui.ajaxError",function(b){var c=e(a(b.target));c.$bg.remove(),c.$pr.remove()}),a(document).on(BJUI.eventType.ajaxStatus,function(b){var c=a(b.target),d=e(c);c.one("ajaxStart",function(){d.$bg.fadeIn(),d.$pr.fadeIn(),d.$pr.find(".progress").animate({width:"10%"},"fast")}).one("ajaxStop",function(){}).one("ajaxError",function(){d.$bg.remove(),d.$pr.remove()})}),f=function(a){a.find('select[data-toggle="selectpicker"]').selectpicker("destroyMenu"),a.find('[data-toggle="selectztree"]').trigger("destroy.bjui.selectztree")},a(document).on(BJUI.eventType.beforeLoadDialog,function(){}).on(BJUI.eventType.beforeAjaxLoad,function(b){f(a(b.target))}).on(BJUI.eventType.beforeCloseNavtab,function(b){f(a(b.target))}).on(BJUI.eventType.beforeCloseDialog,function(b){f(a(b.target))}),a(function(){a(document).on("keydown keyup",function(a){a.which===BJUI.keyCode.CTRL&&(BJUI.KeyPressed.ctrl="keydown"==a.type?!0:!1),a.which===BJUI.keyCode.SHIFT&&(BJUI.KeyPressed.shift="keydown"==a.type?!0:!1)})})}(jQuery),+function(a){"use strict";a(document).on(BJUI.eventType.initUI,function(b){var d,e,f,g,h,i,c=a(b.target);a.fn.iCheck&&(d=c.find('input[data-toggle="icheck"]'),d.each(function(){var c=a(this),d=c.attr("id"),e=c.attr("name"),f=c.data("label");f&&c.after('<label for="'+d+'" class="ilabel">'+f+"</label>"),c.on("ifCreated",function(){var c=a(this).closest("div"),f=c.next('[for="'+d+'"]');c.attr("data-icheck",e),f.attr("data-icheck",e)}).iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChanged",function(){a.fn.validator&&a(this).trigger("validate")}),c.prop("disabled")&&c.iCheck("disable")}),d.filter(".checkboxCtrl").on("ifChanged",function(b){var d=1==b.target.checked?"check":"uncheck",e=a(this).data("group");c.find(':checkbox[name="'+e+'"]').iCheck(d)})),c.find("button").each(function(){var b=a(this),c=b.data("icon");b.addClass("btn"),c&&!b.find("> i").length&&(c="fa-"+c.replace("fa-",""),b.data("bjui.icon")||b.html('<i class="fa '+c+'"></i> '+b.html()).data("bjui.icon",!0))}),c.find("input:text, input:password").each(function(){var b=a(this).addClass("form-control"),c=b.attr("size")||0,d=10*c;d&&b.css("width",d)}),c.find("textarea").each(function(){var b=a(this).addClass("form-control"),c=b.attr("cols")||0,d=10*c,e=b.attr("data-toggle");d&&b.css("width",d),e&&"autoheight"==e&&a.fn.autosize&&b.addClass("autosize").autosize()}),c.find("a.btn").each(function(){var b=a(this),c=b.data("icon");c&&!b.find("> i").length&&(c="fa-"+c.replace("fa-",""),b.data("bjui.icon")||b.html('<i class="fa '+c+'"></i> '+b.html()).data("bjui.icon",!0))}),a.fn.validator&&c.find('form[data-toggle="validate"]').each(function(){var b=a(this),c="undefined"==typeof b.data("alertmsg")?!0:b.data("alertmsg");a(this).validator({valid:function(b){a(b).bjuiajax("ajaxForm",a(b).data())},validClass:"ok",theme:"red_right_effect"}).on("invalid.form",function(b,d,e){c&&a(d).alertmsg("error",BJUI.regional.validatemsg.replaceMsg(e.length))})}),c.find('[data-toggle="moresearch"]').each(function(){var b=a(this),c=b.closest(".bjui-pageHeader"),d=c&&c.find(".bjui-moreSearch"),e=b.data("name");b.attr("title")||b.attr("title","更多查询条件"),b.click(function(f){return d.length?(d.css("top",c.outerHeight()-1),d.is(":visible")?(b.html('<i class="fa fa-angle-double-down"></i>'),e&&a("body").data("moresearch."+e,!1)):(b.html('<i class="fa fa-angle-double-up"></i>'),e&&a("body").data("moresearch."+e,!0)),d.fadeToggle("slow","linear"),f.preventDefault(),void 0):(BJUI.debug("Not created 'moresearch' box[class=\"bjui-moreSearch\"]!"),void 0)}),e&&a("body").data("moresearch."+e)&&(d.css("top",c.outerHeight()-1).fadeIn(),b.html('<i class="fa fa-angle-double-up"></i>'))}),a.fn.selectpicker&&(e=c.find('select[data-toggle="selectpicker"]'),f=function(b,c){var d,e,f,g;c&&c.length&&(d=b.data("refurl"),e=function(b){var d,c=a(b.data("nextselect"));c&&c.length&&(d=c.data("emptytxt")||"&nbsp;",c.html("<option>"+d+"</option>").selectpicker("refresh"),e(c))},c&&c.length&&d&&(f=b.data("val"),g=c.data("val"),"undefined"==typeof f&&(f=b.val()),a.ajax({type:"POST",dataType:"json",url:d.replace("{value}",encodeURIComponent(f)),cache:!1,data:{},success:function(d){if(d){var f="",h="";a.each(d,function(a){var b,c;d[a]&&d[a].length?(b=d[a][0],c=d[a][1]):(b=d[a].value,c=d[a].label),"undefined"!=typeof g&&(h=b==g?" selected":""),f+='<option value="'+b+'"'+h+">"+c+"</option>"}),b.removeAttr("data-val").removeData("val"),c.removeAttr("data-val").removeData("val"),f||(f=c.data("emptytxt")||"&nbsp;",f="<option>"+f+"</option>"),c.html(f).selectpicker("refresh"),e(c)}},error:BJUI.ajaxError})))},e.each(function(){var b=a(this),c=b.data(),d=a(c.nextselect);b.addClass("show-tick"),c.style||b.data("style","btn-default"),c.width||b.data("width","auto"),c.container?1==c.container&&b.attr("data-container","false").data("container",!1):b.data("container","body"),b.selectpicker(),d&&d.length&&"undefined"!=typeof d.data("val")&&f(b,d)}),e.change(function(){var b=a(this),c=a(b.data("nextselect"));f(b,c),b.attr("aria-required")&&a.fn.validator&&b.trigger("validate")})),a.fn.zTree&&(c.find('[data-toggle="ztree"]').each(function(){function i(b,d,e){if(e.faicon){var f=a("#"+e.tId+"_a");f.data("faicon")||f.data("faicon",!0).addClass("faicon").find("> span.button").append('<i class="fa fa-'+e.faicon+'"></i>')}c.onNodeCreated&&c.onNodeCreated.toFunc().call(this,b,d,e)}function j(b,d,e){e.faiconClose&&a("#"+e.tId+"_ico").find("> i").attr("class","fa fa-"+e.faiconClose),c.onCollapse&&c.onCollapse.toFunc().call(this,b,d,e)}function k(b,d,e){e.faicon&&e.faiconClose&&a("#"+e.tId+"_ico").find("> i").attr("class","fa fa-"+e.faicon),c.onExpand&&c.onExpand.toFunc().call(this,b,d,e)}function l(b,d){var e=d.level,f=a("#"+d.tId+g),i=a("#diyBtn_add_"+d.id),j=a("#diyBtn_del_"+d.id);i.length||e<c.maxAddLevel&&(i=a('<span class="tree_add" id="diyBtn_add_'+d.id+'" title="添加"></span>'),i.appendTo(f),i.on("click",function(){h.addNodes(d,{name:"新增Item"})})),j.length||(j=a('<span class="tree_del hide" id="diyBtn_del_'+d.id+'" title="删除"></span>'),j.appendTo(f).on("click",function(a){var f,g,e=function(){j.alertmsg("confirm","确认要删除 "+d.name+" 吗？",{okCall:function(){if(h.removeNode(d),c.onRemove){var e=c.onRemove.toFunc();e&&e.call(this,a,b,d)}},cancelCall:function(){}})};c.beforeRemove?(f=c.beforeRemove.toFunc(),f&&(g=f.call(f,b,d),g&&1==g&&e())):e()}))}function m(b,c){var d=a("#diyBtn_add_"+c.id),e=a("#diyBtn_del_"+c.id);d&&d.length&&d.off("click").remove(),e&&e.length&&e.off("click").remove()}function n(a,b){for(var c=0;c<b.length;c++)if(b[c].drag===!1)return!1;return!0}function o(a,b,c){return c?c.drop!==!1:!0}var e,f,g,h,b=a(this),c=b.data(),d=c.options;d&&"string"==typeof d&&(d=d.toObj()),d&&a.extend(c,"object"==typeof d&&d),e=c.setting,c.nodes?("string"==typeof c.nodes&&(c.nodes=c.nodes.trim().startsWith("[")||c.nodes.trim().startsWith("{")?c.nodes.toObj():c.nodes.toFunc()),"function"==typeof c.nodes&&(c.nodes=c.nodes.call(this)),b.removeAttr("data-nodes")):(c.nodes=[],b.find("> li").each(function(){var b=a(this),d=b.data();d.pid&&(d.pId=d.pid),d.name=b.html(),c.nodes.push(d)}),b.empty()),c.showRemoveBtn||(c.showRemoveBtn=!1),c.showRenameBtn||(c.showRenameBtn=!1),c.addHoverDom&&"function"!=typeof c.addHoverDom&&(c.addHoverDom="edit"===c.addHoverDom?l:c.addHoverDom.toFunc()),c.removeHoverDom&&"function"!=typeof c.removeHoverDom&&(c.removeHoverDom="edit"===c.removeHoverDom?m:c.removeHoverDom.toFunc()),c.maxAddLevel||(c.maxAddLevel=2),f={view:{addHoverDom:c.addHoverDom||null,removeHoverDom:c.removeHoverDom||null,addDiyDom:c.addDiyDom?c.addDiyDom.toFunc():null},edit:{enable:c.editEnable,showRemoveBtn:c.showRemoveBtn,showRenameBtn:c.showRenameBtn},check:{enable:c.checkEnable,chkStyle:c.chkStyle,radioType:c.radioType},callback:{onClick:c.onClick?c.onClick.toFunc():null,beforeDrag:c.beforeDrag?c.beforeDrag.toFunc():n,beforeDrop:c.beforeDrop?c.beforeDrop.toFunc():o,onDrop:c.onDrop?c.onDrop.toFunc():null,onCheck:c.onCheck?c.onCheck.toFunc():null,beforeRemove:c.beforeRemove?c.beforeRemove.toFunc():null,onRemove:c.onRemove?c.onRemove.toFunc():null,onNodeCreated:i,onCollapse:j,onExpand:k},data:{simpleData:{enable:c.simpleData||!0},key:{title:c.title||""}}},e&&"string"==typeof e&&(e=e.toObj()),e&&a.extend(!0,f,"object"==typeof e&&e),a.fn.zTree.init(b,f,c.nodes),g="_a",h=a.fn.zTree.getZTreeObj(b.attr("id")),c.expandAll&&h.expandAll(!0)}),g=c.find('[data-toggle="selectztree"]'),g.each(function(){var g,h,i,j,b=a(this),c=b.data(),d=a(c.tree),f=(parseFloat(b.css("width")),b.outerHeight());c.width=c.width||b.outerWidth(),c.height=c.height||"auto",d&&d.length&&(g=d.attr("id"),h=a("#"+g+"_select_box"),i=function(e){var k,l,g=b.offset().top,h=b.offset().left,i=d.clone().appendTo(a("body")),j=i.outerHeight();i.remove(),k=a(window).height()-j-g-f,l=a(window).height()-g-f,"auto"==c.height&&0>k&&(l+=k),e.css({top:g+f,left:h,"max-height":l})},b.click(function(){var e,f;return h&&h.length?(i(h),h.show(),void 0):(e=2,f=a.CurrentDialog,f&&f.length&&(e=f.css("zIndex")+1),h=a('<div id="'+g+'_select_box" class="tree-box"></div>').css({position:"absolute",zIndex:e,"min-width":c.width,height:c.height,overflow:"auto",background:"#FAFAFA",border:"1px #EEE solid"}).hide().appendTo(a("body")),d.appendTo(h).css("width","100%").data("fromObj",b).removeClass("hide").show(),i(h),h.show(),void 0)}),a("body").on("mousedown",function(c){var d=a(c.target);b[0]==c.target||h&&h.length>0&&d.closest(".tree-box").length>0||h.hide()}),j=b.closest(".bjui-pageContent"),j&&j.length&&j.scroll(function(){h&&h.length&&i(h)}),b.on("destroy.bjui.selectztree",function(){h.remove()}))})),c.find('[data-toggle="accordion"]').each(function(){var b=a(this),c=b.data("heightbox"),d=b.data("height"),e=function(c,d){var e=b.data("offsety")||0,d=d||a(c).outerHeight()-1*e,f=b.find(".panel-heading"),g=f.outerHeight();g=(g+1)*f.length,b.css("height",d),d-=g,b.find(".panel-collapse").find(".panel-body").css("height",d)};b.find("> .panel").length&&(c||d)&&(e(c,d),a(window).resize(function(){e(c,d)}),b.on("hidden.bs.collapse",function(){var c=a(this).find("> .panel:last"),d=c.find("> .panel-heading > h4 > a");d.hasClass("collapsed")&&c.css("border-bottom","1px #ddd solid")}))}),KindEditor&&c.find('[data-toggle="kindeditor"]').each(function(){var d,b=a(this),c=b.data();
    c.items&&"string"==typeof c.items&&(c.items=c.items.replaceAll("'","").replaceAll(" ","").split(",")),c.afterUpload&&(c.afterUpload=c.afterUpload.toFunc()),c.afterSelectFile&&(c.afterSelectFile=c.afterSelectFile.toFunc()),c.confirmSelect&&(c.confirmSelect=c.confirmSelect.toFunc()),d={font:[],span:[".color",".background-color",".font-size",".font-family"],div:[".margin",".padding",".text-align"],table:["align","width"],"td,th":["align","valign","width","height","colspan","rowspan"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["class","align",".text-align",".color",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["class"],hr:["class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":[]},KindEditor.create(b,{pasteType:c.pasteType,minHeight:c.minHeight||260,autoHeightMode:c.autoHeight||!1,items:c.items||KindEditor.options.items,uploadJson:c.uploadJson,fileManagerJson:c.fileManagerJson,allowFileManager:c.allowFileManager||!0,fillDescAfterUploadImage:c.fillDescAfterUploadImage||!0,afterUpload:c.afterUpload,afterSelectFile:c.afterSelectFile,X_afterSelect:c.confirmSelect,htmlTags:d,cssPath:[BJUI.PLUGINPATH+"kindeditor_4.1.10/editor-content.css",BJUI.PLUGINPATH+"kindeditor_4.1.10/plugins/code/prettify.css"],afterBlur:function(){this.sync()}})}),a.fn.colorpicker&&(c.find('[data-toggle="colorpicker"]').each(function(){var b=a(this),c=b.data("bgcolor");b.colorpicker(),c&&b.on("changeColor",function(a){b.css("background-color",a.color.toHex())})}),c.find('[data-toggle="clearcolor"]').each(function(){var b=a(this),c=b.data("target")?a(b.data("target")):null;c&&c.length&&b.click(function(){c.val(""),c.data("bgcolor")&&c.css("background-color","")})})),c.find('[data-toggle="tooltip"]').each(function(){a(this).tooltip()}),c.find('[data-toggle="dropdown"]').parent().on("show.bs.dropdown",function(){var c=a(this),d=c.outerWidth(),e=c.find("> .dropdown-menu"),f=e.outerWidth();d>f&&e.css("min-width",d)}),a.fn.validator&&c.find('form[data-toggle="ajaxform"]').each(function(){a(this).validator({ignore:":input"}),a(this).validator("destroy")}),h=c.find('[data-toggle="highcharts"]'),h.each(function(){var b=a(this),c=b.data();a.get(c.url,function(a){b.highcharts(a)},"json")}),i=c.find('[data-toggle="echarts"]'),i.each(function(){var b=a(this),c=b.data(),d=c.theme?c.theme:"default",e=c.type.split(",");require.config({paths:{echarts:BJUI.PLUGINPATH+"echarts"}}),require(["echarts","echarts/theme/"+d,"echarts/chart/"+e[0],e[1]?"echarts/chart/"+e[1]:"echarts"],function(d,e){var f=d.init(b[0],e);a.get(c.url,function(a){f.setOption(a)},"json")})})})}(jQuery);