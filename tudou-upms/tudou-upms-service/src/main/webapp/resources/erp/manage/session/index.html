<script type="text/javascript">

	$('#manage_session_table').datagrid({
		local: 'remote',
		dataUrl: '/manage/session/list',
		dataType: 'json',
		sortAll: false,
		loadType: 'get',
		filterThead: false,
		height:'95%',
		columns: [{name:'id', width:'150', label:'编号'},
			{name:'startTimestamp', width:'150', label:'创建时间'},
			{name:'lastAccessTime', width:'150', label:'最后访问时间'},
			{name:'expired', width:'150', label:'是否过期'},
			{name:'host', width:'150', label:'访问者IP'},
			{name:'userAgent', width:'150', label:'用户标识'},
			{name:'status', width:'150', label:'状态',type: 'select', items: [{'on_line': '在线'},{'off_line':'离线'},{'force_logout':'踢离'}]},
		],
		paging: {pageSize:50, selectPageSize:'50,100,200', pageCurrent:1},
		fullGrid: true,

	});
	var selected;
	function seesion_logout() {
		selected = $("#manage_session_table").data('selectedDatas');
		console.log(selected);
		if (null == selected || selected.length == 0) {
			return;
		}
		$(this).alertmsg('confirm', '是否确定吗?', {okCall: 'ajax_seesion_logout'});
	}

	function ajax_seesion_logout() {
		var ids = new Array();
		for (var i = 0 ; i < selected.length ; i ++) {
			ids.push(selected[i].id);
		}
		$.ajax({
			url: '/manage/session/forceout/'+ids.join(','),
			dataType: 'json',
			type: 'get',
			success: function(d){
				if (d.code == 1){
					$('#manage_session_table').datagrid('refresh');
				}else{
					$(this).alertmsg('warn',d.data);
				}
			},
			error:function(e){
				$(this).alertmsg('warn',"踢出失败!");
			}
		});
	}

</script>

<div class="bjui-pageContent" >
	<button type="button" class="btn btn-green" data-icon="edit" onclick="seesion_logout()" style="margin-bottom: 5px;"><i class="fa fa-edit"></i>强制退出 </button>
	<table id="manage_session_table" class="table table-hover" data-width="100%"> </table>
</div>